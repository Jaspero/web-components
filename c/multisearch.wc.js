var Ne=Object.defineProperty,ze=(s,e,t)=>e in s?Ne(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Ke=(s,e,t)=>ze(s,typeof e!="symbol"?e+"":e,t);import{c as Ue,S as Ye,i as Pe,o as w,s as Re,l as N,e as S,z as X,T as Je,d as m,A as P,f as H,p as g,Y as te,U as Qe,m as z,N as ie,B as Z,t as We,j as Xe,k as B,V as Ze,r as ce,x as Fe,C as he,q as _e,$ as et,a0 as tt,v as re,n as pe,y as lt,K as at,w as st,O as nt}from"./svelte.js";import"./index.js";import{clickOutside as it}from"./click-outside.js";import{A as ct,c as rt}from"./checkmark.js";function $e(s,e,t){const l=s.slice();return l[56]=e[t],l[57]=e,l[58]=t,l}function fe(s){let e;return{c(){e=S("div"),m(e,"class","jp-multisearch-label")},m(t,l){H(t,e,l),e.innerHTML=s[7]},p(t,l){l[0]&128&&(e.innerHTML=t[7])},d(t){t&&B(e)}}}function ut(s){let e;return{c(){e=S("span"),m(e,"class","jp-multisearch-select-label"),P(e,"jp-multisearch-select-label-move",s[0]||s[13])},m(t,l){H(t,e,l),e.innerHTML=s[7]},p(t,l){l[0]&128&&(e.innerHTML=t[7]),l[0]&8193&&P(e,"jp-multisearch-select-label-move",t[0]||t[13])},d(t){t&&B(e)}}}function dt(s){let e,t=s[1].LOADING+"",l;return{c(){e=S("span"),l=X(t),m(e,"class","jp-multisearch-select-label")},m(n,i){H(n,e,i),g(e,l)},p(n,i){i[0]&2&&t!==(t=n[1].LOADING+"")&&Z(l,t)},d(n){n&&B(e)}}}function ge(s){let e;return{c(){e=S("span"),m(e,"class","jp-multisearch-select-hint")},m(t,l){H(t,e,l),e.innerHTML=s[4]},p(t,l){l[0]&16&&(e.innerHTML=t[4])},d(t){t&&B(e)}}}function be(s){let e,t,l,n,i=[],$=new Map,h,M,x,T,o=s[9].search&&ve(s),q=he(s[12]);const L=u=>u[56];for(let u=0;u<q.length;u+=1){let f=$e(s,q,u),A=L(f);$.set(A,i[u]=ye(A,f))}let v=s[17]&&we(),p=s[9].loadMore&&!s[17]&&Se(s);return{c(){e=S("div"),t=S("div"),o&&o.c(),l=N(),n=S("div");for(let u=0;u<i.length;u+=1)i[u].c();h=N(),v&&v.c(),M=N(),p&&p.c(),m(n,"class","jp-multisearch-menu-buttons"),m(t,"class","jp-multisearch-menu"),m(t,"style",s[19]),m(t,"role","dialog"),m(e,"class","jp-multisearch-overlay")},m(u,f){H(u,e,f),g(e,t),o&&o.m(t,null),g(t,l),g(t,n);for(let A=0;A<i.length;A+=1)i[A]&&i[A].m(n,null);g(n,h),v&&v.m(n,null),g(t,M),p&&p.m(t,null),x||(T=[_e(it.call(null,t)),z(t,"click_outside",s[48]),z(t,"keydown",s[26])],x=!0)},p(u,f){u[9].search?o?o.p(u,f):(o=ve(u),o.c(),o.m(t,l)):o&&(o.d(1),o=null),f[0]&1061888&&(q=he(u[12]),i=et(i,f,L,1,u,q,$,n,tt,ye,h,$e)),u[17]?v||(v=we(),v.c(),v.m(n,null)):v&&(v.d(1),v=null),u[9].loadMore&&!u[17]?p?p.p(u,f):(p=Se(u),p.c(),p.m(t,null)):p&&(p.d(1),p=null),f[0]&524288&&m(t,"style",u[19])},d(u){u&&B(e),o&&o.d();for(let f=0;f<i.length;f+=1)i[f].d();v&&v.d(),p&&p.d(),x=!1,ce(T)}}}function ve(s){let e,t,l,n,i,$;return{c(){e=S("div"),t=S("span"),t.textContent="Search",l=N(),n=S("input"),m(t,"class","jp-multisearch-search-label"),P(t,"jp-multisearch-search-label-move",s[22]||s[18]),m(n,"name","search"),m(n,"type","text"),m(n,"class","jp-multisearch-search-input"),m(e,"class","jp-multisearch-search-field")},m(h,M){H(h,e,M),g(e,t),g(e,l),g(e,n),te(n,s[18]),i||($=[z(n,"input",s[41]),z(n,"input",s[42]),z(n,"focus",s[43]),z(n,"blur",s[44])],i=!0)},p(h,M){M[0]&4456448&&P(t,"jp-multisearch-search-label-move",h[22]||h[18]),M[0]&262144&&n.value!==h[18]&&te(n,h[18])},d(h){h&&B(e),i=!1,ce($)}}}function xe(s){let e,t;return{c(){e=new nt(!1),t=lt(),e.a=t},m(l,n){e.m(rt,l,n),H(l,t,n)},d(l){l&&(B(t),e.d())}}}function ye(s,e){let t,l,n=(e[56].label||e[56].value)+"",i,$,h,M=e[58],x,T,o=e[56].selected&&xe();const q=()=>e[45](t,M),L=()=>e[45](null,M);function v(){return e[46](e[56],e[57],e[58])}return{key:s,first:null,c(){t=S("button"),l=S("span"),i=X(n),$=N(),o&&o.c(),m(t,"type","button"),m(t,"class","jp-multisearch-menu-button"),t.disabled=h=e[56].disabled,P(t,"jp-multisearch-menu-button-selected",e[56].selected),this.first=t},m(p,u){H(p,t,u),g(t,l),g(l,i),g(t,$),o&&o.m(t,null),q(),x||(T=z(t,"click",ie(v)),x=!0)},p(p,u){e=p,u[0]&4096&&n!==(n=(e[56].label||e[56].value)+"")&&Z(i,n),e[56].selected?o||(o=xe(),o.c(),o.m(t,null)):o&&(o.d(1),o=null),u[0]&4096&&h!==(h=e[56].disabled)&&(t.disabled=h),M!==e[58]&&(L(),M=e[58],q()),u[0]&4096&&P(t,"jp-multisearch-menu-button-selected",e[56].selected)},d(p){p&&B(t),o&&o.d(),L(),x=!1,T()}}}function we(s){let e;return{c(){e=S("span"),e.textContent="Loading...",re(e,"display","block"),re(e,"padding","0.75rem"),re(e,"text-align","center")},m(t,l){H(t,e,l)},d(t){t&&B(e)}}}function Se(s){let e;function t(i,$){return i[16]?ot:mt}let l=t(s),n=l(s);return{c(){e=S("div"),n.c(),m(e,"class","jp-multisearch-loadmore")},m(i,$){H(i,e,$),n.m(e,null)},p(i,$){l===(l=t(i))&&n?n.p(i,$):(n.d(1),n=l(i),n&&(n.c(),n.m(e,null)))},d(i){i&&B(e),n.d()}}}function ot(s){let e,t=s[1].LOADING+"",l;return{c(){e=S("button"),l=X(t),m(e,"type","button"),e.disabled=!0},m(n,i){H(n,e,i),g(e,l)},p(n,i){i[0]&2&&t!==(t=n[1].LOADING+"")&&Z(l,t)},d(n){n&&B(e)}}}function mt(s){let e,t,l;return{c(){e=S("button"),e.textContent="Load more",m(e,"type","button")},m(n,i){H(n,e,i),t||(l=z(e,"click",at(ie(s[47]))),t=!0)},p:st,d(n){n&&B(e),t=!1,l()}}}function ht(s){let e,t,l,n,i,$,h,M=(s[21]||"")+"",x,T,o,q,L=(s[21]||"")+"",v,p,u,f,A,W,Q,I,C,R,j=s[7]&&s[8]=="outside"&&fe(s);function J(r,b){if(r[15])return dt;if(r[7]&&r[8]=="inside")return ut}let K=J(s),y=K&&K(s);f=new ct({props:{open:s[13]}});let V=s[4]&&ge(s),k=s[13]&&be(s);return{c(){j&&j.c(),e=N(),t=S("div"),l=S("input"),n=N(),i=S("button"),y&&y.c(),$=N(),h=S("span"),x=X(M),o=N(),q=S("span"),v=X(L),u=N(),Je(f.$$.fragment),W=N(),V&&V.c(),Q=N(),k&&k.c(),m(l,"class","jp-multisearch-hidden-input"),m(l,"tabindex","-1"),m(l,"id",s[5]),m(l,"name",s[6]),l.required=s[3],m(h,"class",T=`jp-multisearch-select-option ${s[8]=="outside"||!s[7]?"":"jp-multisearch-select-option-padding"}`),m(q,"class",p=`jp-multisearch-select-option ${s[8]=="outside"||!s[7]?"":"jp-multisearch-select-option-padding"}`),m(i,"type","button"),m(i,"class","jp-multisearch-select"),i.disabled=A=s[2]||s[15],P(i,"jp-multisearch-select-toggled",s[13]),m(t,"class","jp-multisearch-wrapper"),P(t,"jp-multisearch-has-hint",s[4])},m(r,b){j&&j.m(r,b),H(r,e,b),H(r,t,b),g(t,l),te(l,s[0]),g(t,n),g(t,i),y&&y.m(i,null),g(i,$),g(i,h),g(h,x),g(i,o),g(i,q),g(q,v),g(i,u),Qe(f,i,null),s[39](i),g(t,W),V&&V.m(t,null),g(t,Q),k&&k.m(t,null),I=!0,C||(R=[z(l,"input",s[38]),z(i,"click",ie(s[25])),z(i,"click",s[40]),z(i,"keydown",s[26])],C=!0)},p(r,b){r[7]&&r[8]=="outside"?j?j.p(r,b):(j=fe(r),j.c(),j.m(e.parentNode,e)):j&&(j.d(1),j=null),(!I||b[0]&32)&&m(l,"id",r[5]),(!I||b[0]&64)&&m(l,"name",r[6]),(!I||b[0]&8)&&(l.required=r[3]),b[0]&1&&l.value!==r[0]&&te(l,r[0]),K===(K=J(r))&&y?y.p(r,b):(y&&y.d(1),y=K&&K(r),y&&(y.c(),y.m(i,$))),(!I||b[0]&2097152)&&M!==(M=(r[21]||"")+"")&&Z(x,M),(!I||b[0]&384&&T!==(T=`jp-multisearch-select-option ${r[8]=="outside"||!r[7]?"":"jp-multisearch-select-option-padding"}`))&&m(h,"class",T),(!I||b[0]&2097152)&&L!==(L=(r[21]||"")+"")&&Z(v,L),(!I||b[0]&384&&p!==(p=`jp-multisearch-select-option ${r[8]=="outside"||!r[7]?"":"jp-multisearch-select-option-padding"}`))&&m(q,"class",p);const U={};b[0]&8192&&(U.open=r[13]),f.$set(U),(!I||b[0]&32772&&A!==(A=r[2]||r[15]))&&(i.disabled=A),(!I||b[0]&8192)&&P(i,"jp-multisearch-select-toggled",r[13]),r[4]?V?V.p(r,b):(V=ge(r),V.c(),V.m(t,Q)):V&&(V.d(1),V=null),r[13]?k?k.p(r,b):(k=be(r),k.c(),k.m(t,null)):k&&(k.d(1),k=null),(!I||b[0]&16)&&P(t,"jp-multisearch-has-hint",r[4])},i(r){I||(We(f.$$.fragment,r),I=!0)},o(r){Xe(f.$$.fragment,r),I=!1},d(r){r&&(B(e),B(t)),j&&j.d(r),y&&y.d(),Ze(f),s[39](null),V&&V.d(),k&&k.d(),C=!1,ce(R)}}}function pt(s,e,t){let l=[],n=!1,i=!1,$=!1,h="",{wording:M={LOADING:"Loading..."}}=e,{attachedInternals:x}=e,{minSelects:T=0}=e,{maxSelects:o=null}=e,{disabled:q=!1}=e,{required:L=!1}=e,{hint:v=""}=e,{value:p=""}=e,{internalValue:u=""}=e,{id:f=""}=e,{name:A=""}=e,{label:W=""}=e,{labelType:Q="inside"}=e;const I=()=>{var a;return y?(a=l.find(d=>d.selected))==null?void 0:a.value:l.filter(d=>d.selected).map(d=>d.value)};let{service:C}=e,{validationMessages:R={}}=e,{requiredValidationMessage:j}=e,{minselectsValidationMessage:J}=e,{maxselectsValidationMessage:K}=e,{singleSelect:y=!1}=e,{defaultSearch:V=!1}=e,{defaultShow:k=5}=e,r=0,b=!1,U=!1,D,ue,Y=[],le="",de,oe,F=!1;const Ve=Fe(),je=()=>{x.reportValidity()};async function me(){t(12,l=l.filter(d=>d.selected)),t(17,$=!0);const a=await C.search(h);t(12,l=[...l,...a.map(d=>(d.selected=!1,d))]),t(17,$=!1)}async function ae(){t(12,l=l.filter(d=>d.selected)),r=l.length,t(17,$=!0);const a=await C.search("");t(12,l=[...l,...a.map(d=>(d.selected=!1,d))]),t(12,l=l.slice(0,r+Math.max(0,k-r))),t(17,$=!1)}function _(a){var d;if((d=a?.target)!=null&&d.closest(".menu"))return;const c=D.getBoundingClientRect(),E=window.innerHeight-c.bottom,se=300;let G="";E<se?G=`
        width: ${c.width}px;
        bottom: ${window.innerHeight-c.top}px;
        left: ${c.left}px;
      `:G=`
        width: ${c.width}px;
        top: ${c.bottom}px;
        left: ${c.left}px;
      `,t(19,ue=G),t(13,U=!U),setTimeout(U?()=>{const O=l.findIndex(ne=>!ne.disabled);O!==-1&&Y[O].focus()}:()=>{b&&D.nextElementSibling instanceof HTMLButtonElement?D.nextElementSibling.focus():D.focus()},10)}function ee(a,d){if(d==="next"){for(let c=a+1;c<l.length;c++)if(!l[c].disabled)return c}else if(d==="previous"){for(let c=a-1;c>=0;c--)if(!l[c].disabled)return c}return a}function ke(a){if(F)return;const d=Y.findIndex(E=>E===document.activeElement);let c;if(U){if(a.key==="Escape"){_(),D.focus();return}const E=a.key==="Home"||a.key==="ArrowUp"&&a.metaKey,se=a.key==="End"||a.key==="ArrowDown"&&a.metaKey;if(E){a.preventDefault();const G=l.findIndex(O=>!O.disabled);G!==-1&&Y[G].focus();return}if(se){a.preventDefault();const G=l.slice().reverse().findIndex(ne=>!ne.disabled),O=G!==-1?l.length-1-G:-1;O!==-1&&Y[O].focus();return}if(["ArrowDown","ArrowUp"].includes(a.key)&&(a.preventDefault(),a.key==="ArrowUp"?c=ee(d,"previous"):c=ee(d,"next"),Y[c].focus()),a.key==="Tab"){if(a.preventDefault(),b=!0,a.shiftKey){if(c=ee(d,"previous"),d===c){_(),D.focus();return}}else if(c=ee(d,"next"),d===c){_(),D.focus();return}Y[c].focus()}if(/^[a-z\d]$/i.test(a.key)){clearTimeout(de),le+=a.key;const G=l.map(O=>O.label?O.label:O.value).findIndex(O=>O.toLowerCase().includes(le.toLowerCase()));G!==-1&&Y[G].focus(),de=setTimeout(()=>{le=""},500)}}}async function qe(a){t(15,n=!0);const d=Array.isArray(a)?a:a.split(",");await Promise.all(d.map(async c=>{let E;C.getSingle?await C.getSingle(c)?(E=await C.getSingle(c),E.selected=!0):E={value:c,selected:!0}:E={value:c,selected:!0},t(12,l=[...l,E])})),t(15,n=!1)}function Ie(){u=this.value,t(0,u),t(12,l),t(3,L),t(27,x),t(33,j),t(32,R),t(14,D),t(28,T),t(34,J),t(29,o),t(35,K),t(10,y),t(30,p)}function Te(a){pe[a?"unshift":"push"](()=>{D=a,t(14,D)})}const Le=()=>{V&&!$&&ae()};function Ae(){h=this.value,t(18,h)}const Ee=()=>{!$&&(h!=""||!V)&&me(),!$&&h==""&&V&&ae()},De=()=>t(22,F=!0),He=()=>t(22,F=!1);function Be(a,d){pe[a?"unshift":"push"](()=>{Y[d]=a,t(20,Y)})}const Oe=(a,d,c)=>{y?(t(12,l=l.map(E=>(E.selected=E===a,E))),t(13,U=!1)):t(12,d[c].selected=!a.selected,l)},Ce=async()=>{t(16,i=!0),t(12,l=l.concat(await C.loadMore(h))),t(16,i=!1)},Ge=()=>t(13,U=!1);return s.$$set=a=>{"wording"in a&&t(1,M=a.wording),"attachedInternals"in a&&t(27,x=a.attachedInternals),"minSelects"in a&&t(28,T=a.minSelects),"maxSelects"in a&&t(29,o=a.maxSelects),"disabled"in a&&t(2,q=a.disabled),"required"in a&&t(3,L=a.required),"hint"in a&&t(4,v=a.hint),"value"in a&&t(30,p=a.value),"internalValue"in a&&t(0,u=a.internalValue),"id"in a&&t(5,f=a.id),"name"in a&&t(6,A=a.name),"label"in a&&t(7,W=a.label),"labelType"in a&&t(8,Q=a.labelType),"service"in a&&t(9,C=a.service),"validationMessages"in a&&t(32,R=a.validationMessages),"requiredValidationMessage"in a&&t(33,j=a.requiredValidationMessage),"minselectsValidationMessage"in a&&t(34,J=a.minselectsValidationMessage),"maxselectsValidationMessage"in a&&t(35,K=a.maxselectsValidationMessage),"singleSelect"in a&&t(10,y=a.singleSelect),"defaultSearch"in a&&t(11,V=a.defaultSearch),"defaultShow"in a&&t(36,k=a.defaultShow)},s.$$.update=()=>{var a;if(s.$$.dirty[0]&8192&&(U?document.documentElement.style.overflowY="hidden":document.documentElement.style.overflowY=""),s.$$.dirty[0]&939545608|s.$$.dirty[1]&30){t(12,l=l.filter(c=>c.selected).concat(l.filter(c=>!c.selected)));const d=l.filter(c=>c.selected).length;d==0&&L?x.setValidity({customError:!0},j||R.required||"At least one item needs to be checked.",D):d<T?x.setValidity({customError:!0},J||R.minselects||"Below limit checks.",D):o!==null&&d>o?x.setValidity({customError:!0},K||R.maxselects||"Above limit checks.",D):x.setValidity({}),x.checkValidity(),t(0,u=l.filter(c=>c.selected).map(c=>c.value).join(",")),t(21,oe=l.filter(c=>c.selected).map(c=>c.label?c.label:c.value)),Ve("value",y?(a=l.find(c=>c.selected))==null?void 0:a.value:l.filter(c=>c.selected).map(c=>c.value))}s.$$.dirty[0]&1073741824&&(p?qe(p):t(12,l=[]))},[u,M,q,L,v,f,A,W,Q,C,y,V,l,U,D,n,i,$,h,ue,Y,oe,F,me,ae,_,ke,x,T,o,p,I,R,j,J,K,k,je,Ie,Te,Le,Ae,Ee,De,He,Be,Oe,Ce,Ge]}class Me extends Ye{constructor(e){super(),Pe(this,e,pt,ht,Re,{wording:1,attachedInternals:27,minSelects:28,maxSelects:29,disabled:2,required:3,hint:4,value:30,internalValue:0,id:5,name:6,label:7,labelType:8,getValue:31,service:9,validationMessages:32,requiredValidationMessage:33,minselectsValidationMessage:34,maxselectsValidationMessage:35,singleSelect:10,defaultSearch:11,defaultShow:36,reportValidity:37},null,[-1,-1])}get wording(){return this.$$.ctx[1]}set wording(e){this.$$set({wording:e}),w()}get attachedInternals(){return this.$$.ctx[27]}set attachedInternals(e){this.$$set({attachedInternals:e}),w()}get minSelects(){return this.$$.ctx[28]}set minSelects(e){this.$$set({minSelects:e}),w()}get maxSelects(){return this.$$.ctx[29]}set maxSelects(e){this.$$set({maxSelects:e}),w()}get disabled(){return this.$$.ctx[2]}set disabled(e){this.$$set({disabled:e}),w()}get required(){return this.$$.ctx[3]}set required(e){this.$$set({required:e}),w()}get hint(){return this.$$.ctx[4]}set hint(e){this.$$set({hint:e}),w()}get value(){return this.$$.ctx[30]}set value(e){this.$$set({value:e}),w()}get internalValue(){return this.$$.ctx[0]}set internalValue(e){this.$$set({internalValue:e}),w()}get id(){return this.$$.ctx[5]}set id(e){this.$$set({id:e}),w()}get name(){return this.$$.ctx[6]}set name(e){this.$$set({name:e}),w()}get label(){return this.$$.ctx[7]}set label(e){this.$$set({label:e}),w()}get labelType(){return this.$$.ctx[8]}set labelType(e){this.$$set({labelType:e}),w()}get getValue(){return this.$$.ctx[31]}get service(){return this.$$.ctx[9]}set service(e){this.$$set({service:e}),w()}get validationMessages(){return this.$$.ctx[32]}set validationMessages(e){this.$$set({validationMessages:e}),w()}get requiredValidationMessage(){return this.$$.ctx[33]}set requiredValidationMessage(e){this.$$set({requiredValidationMessage:e}),w()}get minselectsValidationMessage(){return this.$$.ctx[34]}set minselectsValidationMessage(e){this.$$set({minselectsValidationMessage:e}),w()}get maxselectsValidationMessage(){return this.$$.ctx[35]}set maxselectsValidationMessage(e){this.$$set({maxselectsValidationMessage:e}),w()}get singleSelect(){return this.$$.ctx[10]}set singleSelect(e){this.$$set({singleSelect:e}),w()}get defaultSearch(){return this.$$.ctx[11]}set defaultSearch(e){this.$$set({defaultSearch:e}),w()}get defaultShow(){return this.$$.ctx[36]}set defaultShow(e){this.$$set({defaultShow:e}),w()}get reportValidity(){return this.$$.ctx[37]}}try{customElements.define("jp-multisearch",Ue(Me,{wording:{},attachedInternals:{},minSelects:{},maxSelects:{},disabled:{type:"Boolean"},required:{type:"Boolean"},hint:{},value:{},internalValue:{},id:{},name:{},label:{},labelType:{},service:{},validationMessages:{},requiredValidationMessage:{},minselectsValidationMessage:{},maxselectsValidationMessage:{},singleSelect:{type:"Boolean"},defaultSearch:{type:"Boolean"},defaultShow:{}},[],["getValue","reportValidity"],!1,s=>{var e;return e=class extends s{constructor(){super(),this.attachedInternals=this.attachInternals()}},Ke(e,"formAssociated",!0),e}));}catch{};export{Me as default};
//# sourceMappingURL=multisearch.wc.js.map
