var Ce=Object.defineProperty,Ke=(n,e,t)=>e in n?Ce(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ue=(n,e,t)=>Ke(n,typeof e!="symbol"?e+"":e,t);import{c as ze,S as Pe,i as Re,o as S,s as Xe,l as O,e as V,z as Z,R as Ye,d as h,A as K,f as E,p as v,X as J,T as _e,m as N,N as se,B as Q,t as Fe,j as Ze,k as B,U as Je,r as ie,x as Qe,C as he,q as We,$ as et,a0 as tt,v as re,n as pe,y as lt,K as at,w as nt,Z as st}from"./svelte.js";import"./index.js";import{clickOutside as it}from"./click-outside.js";import{A as rt,c as ct}from"./checkmark.js";function fe(n,e,t){const l=n.slice();return l[56]=e[t],l[57]=e,l[58]=t,l}function $e(n){let e;return{c(){e=V("div"),h(e,"class","jp-multisearch-label")},m(t,l){E(t,e,l),e.innerHTML=n[7]},p(t,l){l[0]&128&&(e.innerHTML=t[7])},d(t){t&&B(e)}}}function dt(n){let e;return{c(){e=V("span"),h(e,"class","jp-multisearch-select-label"),K(e,"jp-multisearch-select-label-move",n[0]||n[13])},m(t,l){E(t,e,l),e.innerHTML=n[7]},p(t,l){l[0]&128&&(e.innerHTML=t[7]),l[0]&8193&&K(e,"jp-multisearch-select-label-move",t[0]||t[13])},d(t){t&&B(e)}}}function ut(n){let e,t=n[1].LOADING+"",l;return{c(){e=V("span"),l=Z(t),h(e,"class","jp-multisearch-select-label")},m(s,i){E(s,e,i),v(e,l)},p(s,i){i[0]&2&&t!==(t=s[1].LOADING+"")&&Q(l,t)},d(s){s&&B(e)}}}function ge(n){let e;return{c(){e=V("span"),h(e,"class","jp-multisearch-select-hint")},m(t,l){E(t,e,l),e.innerHTML=n[4]},p(t,l){l[0]&16&&(e.innerHTML=t[4])},d(t){t&&B(e)}}}function ve(n){let e,t,l,s,i=[],f=new Map,m,M,x,q,o=n[9].search&&xe(n),k=he(n[12]);const I=c=>c[56];for(let c=0;c<k.length;c+=1){let b=fe(n,k,c),D=I(b);f.set(D,i[c]=be(D,b))}let y=n[17]&&we(),p=n[9].loadMore&&!n[17]&&Se(n);return{c(){e=V("div"),t=V("div"),o&&o.c(),l=O(),s=V("div");for(let c=0;c<i.length;c+=1)i[c].c();m=O(),y&&y.c(),M=O(),p&&p.c(),h(s,"class","jp-multisearch-menu-buttons"),h(t,"class","jp-multisearch-menu"),h(t,"style",n[19]),h(t,"role","dialog"),h(e,"class","jp-multisearch-overlay")},m(c,b){E(c,e,b),v(e,t),o&&o.m(t,null),v(t,l),v(t,s);for(let D=0;D<i.length;D+=1)i[D]&&i[D].m(s,null);v(s,m),y&&y.m(s,null),v(t,M),p&&p.m(t,null),x||(q=[We(it.call(null,t)),N(t,"click_outside",n[48]),N(t,"keydown",n[26])],x=!0)},p(c,b){c[9].search?o?o.p(c,b):(o=xe(c),o.c(),o.m(t,l)):o&&(o.d(1),o=null),b[0]&1061888&&(k=he(c[12]),i=et(i,b,I,1,c,k,f,s,tt,be,m,fe)),c[17]?y||(y=we(),y.c(),y.m(s,null)):y&&(y.d(1),y=null),c[9].loadMore&&!c[17]?p?p.p(c,b):(p=Se(c),p.c(),p.m(t,null)):p&&(p.d(1),p=null),b[0]&524288&&h(t,"style",c[19])},d(c){c&&B(e),o&&o.d();for(let b=0;b<i.length;b+=1)i[b].d();y&&y.d(),p&&p.d(),x=!1,ie(q)}}}function xe(n){let e,t,l,s,i,f;return{c(){e=V("div"),t=V("span"),t.textContent="Search",l=O(),s=V("input"),h(t,"class","jp-multisearch-search-label"),K(t,"jp-multisearch-search-label-move",n[22]||n[18]),h(s,"name","search"),h(s,"type","text"),h(s,"class","jp-multisearch-search-input"),h(e,"class","jp-multisearch-search-field")},m(m,M){E(m,e,M),v(e,t),v(e,l),v(e,s),J(s,n[18]),i||(f=[N(s,"input",n[41]),N(s,"input",n[42]),N(s,"focus",n[43]),N(s,"blur",n[44])],i=!0)},p(m,M){M[0]&4456448&&K(t,"jp-multisearch-search-label-move",m[22]||m[18]),M[0]&262144&&s.value!==m[18]&&J(s,m[18])},d(m){m&&B(e),i=!1,ie(f)}}}function ye(n){let e,t;return{c(){e=new st(!1),t=lt(),e.a=t},m(l,s){e.m(ct,l,s),E(l,t,s)},d(l){l&&(B(t),e.d())}}}function be(n,e){let t,l,s=(e[56].label||e[56].value)+"",i,f,m,M=e[58],x,q,o=e[56].selected&&ye();const k=()=>e[45](t,M),I=()=>e[45](null,M);function y(){return e[46](e[56],e[57],e[58])}return{key:n,first:null,c(){t=V("button"),l=V("span"),i=Z(s),f=O(),o&&o.c(),h(t,"type","button"),h(t,"class","jp-multisearch-menu-button"),t.disabled=m=e[56].disabled,K(t,"jp-multisearch-menu-button-selected",e[56].selected),this.first=t},m(p,c){E(p,t,c),v(t,l),v(l,i),v(t,f),o&&o.m(t,null),k(),x||(q=N(t,"click",se(y)),x=!0)},p(p,c){e=p,c[0]&4096&&s!==(s=(e[56].label||e[56].value)+"")&&Q(i,s),e[56].selected?o||(o=ye(),o.c(),o.m(t,null)):o&&(o.d(1),o=null),c[0]&4096&&m!==(m=e[56].disabled)&&(t.disabled=m),M!==e[58]&&(I(),M=e[58],k()),c[0]&4096&&K(t,"jp-multisearch-menu-button-selected",e[56].selected)},d(p){p&&B(t),o&&o.d(),I(),x=!1,q()}}}function we(n){let e;return{c(){e=V("span"),e.textContent="Loading...",re(e,"display","block"),re(e,"padding","0.75rem"),re(e,"text-align","center")},m(t,l){E(t,e,l)},d(t){t&&B(e)}}}function Se(n){let e;function t(i,f){return i[16]?ot:mt}let l=t(n),s=l(n);return{c(){e=V("div"),s.c(),h(e,"class","jp-multisearch-loadmore")},m(i,f){E(i,e,f),s.m(e,null)},p(i,f){l===(l=t(i))&&s?s.p(i,f):(s.d(1),s=l(i),s&&(s.c(),s.m(e,null)))},d(i){i&&B(e),s.d()}}}function ot(n){let e,t=n[1].LOADING+"",l;return{c(){e=V("button"),l=Z(t),h(e,"type","button"),e.disabled=!0},m(s,i){E(s,e,i),v(e,l)},p(s,i){i[0]&2&&t!==(t=s[1].LOADING+"")&&Q(l,t)},d(s){s&&B(e)}}}function mt(n){let e,t,l;return{c(){e=V("button"),e.textContent="Load more",h(e,"type","button")},m(s,i){E(s,e,i),t||(l=N(e,"click",at(se(n[47]))),t=!0)},p:nt,d(s){s&&B(e),t=!1,l()}}}function ht(n){let e,t,l,s,i,f,m,M=(n[21]||"")+"",x,q,o,k,I,y,p,c,b,D,T=n[7]&&n[8]=="outside"&&$e(n);function R(d,$){if(d[15])return ut;if(d[7]&&d[8]=="inside")return dt}let z=R(n),g=z&&z(n);k=new rt({props:{open:n[13]}});let w=n[4]&&ge(n),j=n[13]&&ve(n);return{c(){T&&T.c(),e=O(),t=V("div"),l=V("input"),s=O(),i=V("button"),g&&g.c(),f=O(),m=V("span"),x=Z(M),o=O(),Ye(k.$$.fragment),y=O(),w&&w.c(),p=O(),j&&j.c(),h(l,"class","jp-multisearch-hidden-input"),h(l,"tabindex","-1"),h(l,"id",n[5]),h(l,"name",n[6]),l.required=n[3],h(m,"class",q=`jp-multisearch-select-option ${n[8]=="outside"||!n[7]?"":"jp-multisearch-select-option-padding"}`),h(i,"type","button"),h(i,"class","jp-multisearch-select"),i.disabled=I=n[2]||n[15],K(i,"jp-multisearch-select-toggled",n[13]),h(t,"class","jp-multisearch-wrapper"),K(t,"jp-multisearch-has-hint",n[4])},m(d,$){T&&T.m(d,$),E(d,e,$),E(d,t,$),v(t,l),J(l,n[0]),v(t,s),v(t,i),g&&g.m(i,null),v(i,f),v(i,m),v(m,x),v(i,o),_e(k,i,null),n[39](i),v(t,y),w&&w.m(t,null),v(t,p),j&&j.m(t,null),c=!0,b||(D=[N(l,"input",n[38]),N(i,"click",se(n[25])),N(i,"click",n[40]),N(i,"keydown",n[26])],b=!0)},p(d,$){d[7]&&d[8]=="outside"?T?T.p(d,$):(T=$e(d),T.c(),T.m(e.parentNode,e)):T&&(T.d(1),T=null),(!c||$[0]&32)&&h(l,"id",d[5]),(!c||$[0]&64)&&h(l,"name",d[6]),(!c||$[0]&8)&&(l.required=d[3]),$[0]&1&&l.value!==d[0]&&J(l,d[0]),z===(z=R(d))&&g?g.p(d,$):(g&&g.d(1),g=z&&z(d),g&&(g.c(),g.m(i,f))),(!c||$[0]&2097152)&&M!==(M=(d[21]||"")+"")&&Q(x,M),(!c||$[0]&384&&q!==(q=`jp-multisearch-select-option ${d[8]=="outside"||!d[7]?"":"jp-multisearch-select-option-padding"}`))&&h(m,"class",q);const U={};$[0]&8192&&(U.open=d[13]),k.$set(U),(!c||$[0]&32772&&I!==(I=d[2]||d[15]))&&(i.disabled=I),(!c||$[0]&8192)&&K(i,"jp-multisearch-select-toggled",d[13]),d[4]?w?w.p(d,$):(w=ge(d),w.c(),w.m(t,p)):w&&(w.d(1),w=null),d[13]?j?j.p(d,$):(j=ve(d),j.c(),j.m(t,null)):j&&(j.d(1),j=null),(!c||$[0]&16)&&K(t,"jp-multisearch-has-hint",d[4])},i(d){c||(Fe(k.$$.fragment,d),c=!0)},o(d){Ze(k.$$.fragment,d),c=!1},d(d){d&&(B(e),B(t)),T&&T.d(d),g&&g.d(),Je(k),n[39](null),w&&w.d(),j&&j.d(),b=!1,ie(D)}}}function pt(n,e,t){let l=[],s=!1,i=!1,f=!1,m="",{wording:M={LOADING:"Loading..."}}=e,{attachedInternals:x}=e,{minSelects:q=0}=e,{maxSelects:o=null}=e,{disabled:k=!1}=e,{required:I=!1}=e,{hint:y=""}=e,{value:p=""}=e,{internalValue:c=""}=e,{id:b=""}=e,{name:D=""}=e,{label:T=""}=e,{labelType:R="inside"}=e;const z=()=>{var a;return U?(a=l.find(u=>u.selected))==null?void 0:a.value:l.filter(u=>u.selected).map(u=>u.value)};let{service:g}=e,{validationMessages:w={}}=e,{requiredValidationMessage:j}=e,{minselectsValidationMessage:d}=e,{maxselectsValidationMessage:$}=e,{singleSelect:U=!1}=e,{defaultSearch:X=!1}=e,{defaultShow:W=5}=e,ee=0,ce=!1,P=!1,L,de,C=[],te="",ue,oe,Y=!1;const Ve=Qe(),je=()=>{x.reportValidity()};async function me(){t(12,l=l.filter(u=>u.selected)),t(17,f=!0);const a=await g.search(m);t(12,l=[...l,...a.map(u=>(u.selected=!1,u))]),t(17,f=!1)}async function le(){t(12,l=l.filter(u=>u.selected)),ee=l.length,t(17,f=!0);const a=await g.search("");t(12,l=[...l,...a.map(u=>(u.selected=!1,u))]),t(12,l=l.slice(0,ee+Math.max(0,W-ee))),t(17,f=!1)}function _(a){var u;if((u=a?.target)!=null&&u.closest(".menu"))return;const r=L.getBoundingClientRect(),A=window.innerHeight-r.bottom,ae=300;let G="";A<ae?G=`
        width: ${r.width}px;
        bottom: ${window.innerHeight-r.top}px;
        left: ${r.left}px;
      `:G=`
        width: ${r.width}px;
        top: ${r.bottom}px;
        left: ${r.left}px;
      `,t(19,de=G),t(13,P=!P),setTimeout(P?()=>{const H=l.findIndex(ne=>!ne.disabled);H!==-1&&C[H].focus()}:()=>{ce&&L.nextElementSibling instanceof HTMLButtonElement?L.nextElementSibling.focus():L.focus()},10)}function F(a,u){if(u==="next"){for(let r=a+1;r<l.length;r++)if(!l[r].disabled)return r}else if(u==="previous"){for(let r=a-1;r>=0;r--)if(!l[r].disabled)return r}return a}function ke(a){if(Y)return;const u=C.findIndex(A=>A===document.activeElement);let r;if(P){if(a.key==="Escape"){_(),L.focus();return}const A=a.key==="Home"||a.key==="ArrowUp"&&a.metaKey,ae=a.key==="End"||a.key==="ArrowDown"&&a.metaKey;if(A){a.preventDefault();const G=l.findIndex(H=>!H.disabled);G!==-1&&C[G].focus();return}if(ae){a.preventDefault();const G=l.slice().reverse().findIndex(ne=>!ne.disabled),H=G!==-1?l.length-1-G:-1;H!==-1&&C[H].focus();return}if(["ArrowDown","ArrowUp"].includes(a.key)&&(a.preventDefault(),a.key==="ArrowUp"?r=F(u,"previous"):r=F(u,"next"),C[r].focus()),a.key==="Tab"){if(a.preventDefault(),ce=!0,a.shiftKey){if(r=F(u,"previous"),u===r){_(),L.focus();return}}else if(r=F(u,"next"),u===r){_(),L.focus();return}C[r].focus()}if(/^[a-z\d]$/i.test(a.key)){clearTimeout(ue),te+=a.key;const G=l.map(H=>H.label?H.label:H.value).findIndex(H=>H.toLowerCase().includes(te.toLowerCase()));G!==-1&&C[G].focus(),ue=setTimeout(()=>{te=""},500)}}}async function Te(a){t(15,s=!0);const u=Array.isArray(a)?a:a.split(",");await Promise.all(u.map(async r=>{let A;g.getSingle?await g.getSingle(r)?(A=await g.getSingle(r),A.selected=!0):A={value:r,selected:!0}:A={value:r,selected:!0},t(12,l=[...l,A])})),t(15,s=!1)}function qe(){c=this.value,t(0,c),t(12,l),t(3,I),t(27,x),t(33,j),t(32,w),t(14,L),t(28,q),t(34,d),t(29,o),t(35,$),t(10,U),t(30,p)}function Ie(a){pe[a?"unshift":"push"](()=>{L=a,t(14,L)})}const Ae=()=>{X&&!f&&le()};function Le(){m=this.value,t(18,m)}const Ee=()=>{!f&&(m!=""||!X)&&me(),!f&&m==""&&X&&le()},Be=()=>t(22,Y=!0),De=()=>t(22,Y=!1);function He(a,u){pe[a?"unshift":"push"](()=>{C[u]=a,t(20,C)})}const Ge=(a,u,r)=>{U?(t(12,l=l.map(A=>(A.selected=A===a,A))),t(13,P=!1)):t(12,u[r].selected=!a.selected,l)},Ne=async()=>{t(16,i=!0),t(12,l=l.concat(await g.loadMore(m))),t(16,i=!1)},Oe=()=>t(13,P=!1);return n.$$set=a=>{"wording"in a&&t(1,M=a.wording),"attachedInternals"in a&&t(27,x=a.attachedInternals),"minSelects"in a&&t(28,q=a.minSelects),"maxSelects"in a&&t(29,o=a.maxSelects),"disabled"in a&&t(2,k=a.disabled),"required"in a&&t(3,I=a.required),"hint"in a&&t(4,y=a.hint),"value"in a&&t(30,p=a.value),"internalValue"in a&&t(0,c=a.internalValue),"id"in a&&t(5,b=a.id),"name"in a&&t(6,D=a.name),"label"in a&&t(7,T=a.label),"labelType"in a&&t(8,R=a.labelType),"service"in a&&t(9,g=a.service),"validationMessages"in a&&t(32,w=a.validationMessages),"requiredValidationMessage"in a&&t(33,j=a.requiredValidationMessage),"minselectsValidationMessage"in a&&t(34,d=a.minselectsValidationMessage),"maxselectsValidationMessage"in a&&t(35,$=a.maxselectsValidationMessage),"singleSelect"in a&&t(10,U=a.singleSelect),"defaultSearch"in a&&t(11,X=a.defaultSearch),"defaultShow"in a&&t(36,W=a.defaultShow)},n.$$.update=()=>{var a;if(n.$$.dirty[0]&8192&&(P?document.documentElement.style.overflowY="hidden":document.documentElement.style.overflowY=""),n.$$.dirty[0]&939545608|n.$$.dirty[1]&30){t(12,l=l.filter(r=>r.selected).concat(l.filter(r=>!r.selected)));const u=l.filter(r=>r.selected).length;u==0&&I?x.setValidity({customError:!0},j||w.required||"At least one item needs to be checked.",L):u<q?x.setValidity({customError:!0},d||w.minselects||"Below limit checks.",L):o!==null&&u>o?x.setValidity({customError:!0},$||w.maxselects||"Above limit checks.",L):x.setValidity({}),x.checkValidity(),t(0,c=l.filter(r=>r.selected).map(r=>r.value).join(",")),t(21,oe=l.filter(r=>r.selected).map(r=>r.label?r.label:r.value)),Ve("value",U?(a=l.find(r=>r.selected))==null?void 0:a.value:l.filter(r=>r.selected).map(r=>r.value))}n.$$.dirty[0]&1073741824&&(p?Te(p):t(12,l=[]))},[c,M,k,I,y,b,D,T,R,g,U,X,l,P,L,s,i,f,m,de,C,oe,Y,me,le,_,ke,x,q,o,p,z,w,j,d,$,W,je,qe,Ie,Ae,Le,Ee,Be,De,He,Ge,Ne,Oe]}class Me extends Pe{constructor(e){super(),Re(this,e,pt,ht,Xe,{wording:1,attachedInternals:27,minSelects:28,maxSelects:29,disabled:2,required:3,hint:4,value:30,internalValue:0,id:5,name:6,label:7,labelType:8,getValue:31,service:9,validationMessages:32,requiredValidationMessage:33,minselectsValidationMessage:34,maxselectsValidationMessage:35,singleSelect:10,defaultSearch:11,defaultShow:36,reportValidity:37},null,[-1,-1])}get wording(){return this.$$.ctx[1]}set wording(e){this.$$set({wording:e}),S()}get attachedInternals(){return this.$$.ctx[27]}set attachedInternals(e){this.$$set({attachedInternals:e}),S()}get minSelects(){return this.$$.ctx[28]}set minSelects(e){this.$$set({minSelects:e}),S()}get maxSelects(){return this.$$.ctx[29]}set maxSelects(e){this.$$set({maxSelects:e}),S()}get disabled(){return this.$$.ctx[2]}set disabled(e){this.$$set({disabled:e}),S()}get required(){return this.$$.ctx[3]}set required(e){this.$$set({required:e}),S()}get hint(){return this.$$.ctx[4]}set hint(e){this.$$set({hint:e}),S()}get value(){return this.$$.ctx[30]}set value(e){this.$$set({value:e}),S()}get internalValue(){return this.$$.ctx[0]}set internalValue(e){this.$$set({internalValue:e}),S()}get id(){return this.$$.ctx[5]}set id(e){this.$$set({id:e}),S()}get name(){return this.$$.ctx[6]}set name(e){this.$$set({name:e}),S()}get label(){return this.$$.ctx[7]}set label(e){this.$$set({label:e}),S()}get labelType(){return this.$$.ctx[8]}set labelType(e){this.$$set({labelType:e}),S()}get getValue(){return this.$$.ctx[31]}get service(){return this.$$.ctx[9]}set service(e){this.$$set({service:e}),S()}get validationMessages(){return this.$$.ctx[32]}set validationMessages(e){this.$$set({validationMessages:e}),S()}get requiredValidationMessage(){return this.$$.ctx[33]}set requiredValidationMessage(e){this.$$set({requiredValidationMessage:e}),S()}get minselectsValidationMessage(){return this.$$.ctx[34]}set minselectsValidationMessage(e){this.$$set({minselectsValidationMessage:e}),S()}get maxselectsValidationMessage(){return this.$$.ctx[35]}set maxselectsValidationMessage(e){this.$$set({maxselectsValidationMessage:e}),S()}get singleSelect(){return this.$$.ctx[10]}set singleSelect(e){this.$$set({singleSelect:e}),S()}get defaultSearch(){return this.$$.ctx[11]}set defaultSearch(e){this.$$set({defaultSearch:e}),S()}get defaultShow(){return this.$$.ctx[36]}set defaultShow(e){this.$$set({defaultShow:e}),S()}get reportValidity(){return this.$$.ctx[37]}}try{customElements.define("jp-multisearch",ze(Me,{wording:{},attachedInternals:{},minSelects:{},maxSelects:{},disabled:{type:"Boolean"},required:{type:"Boolean"},hint:{},value:{},internalValue:{},id:{},name:{},label:{},labelType:{},service:{},validationMessages:{},requiredValidationMessage:{},minselectsValidationMessage:{},maxselectsValidationMessage:{},singleSelect:{type:"Boolean"},defaultSearch:{type:"Boolean"},defaultShow:{}},[],["getValue","reportValidity"],!1,n=>{var e;return e=class extends n{constructor(){super(),this.attachedInternals=this.attachInternals()}},Ue(e,"formAssociated",!0),e}));}catch{};export{Me as default};
//# sourceMappingURL=multisearch.wc.js.map
