var ye=Object.defineProperty,ge=(a,t,e)=>t in a?ye(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,be=(a,t,e)=>ge(a,typeof t!="symbol"?t+"":t,e);import{c as we,S as Fe,i as xe,f as H,s as je,b as q,e as b,H as Te,g as n,h as x,j,l as F,p as k,J as B,o as T,D as Me,O as P,z as ze,r as A,y as E,d as J,t as S,V as U}from"./svelte.js";import"./index.js";import{clickOutside as He}from"./click-outside.js";import{formatDisplayFileName as W}from"./fileNameFormatter.js";function G(a){let t;return{c(){t=b("div"),n(t,"class","label")},m(e,i){x(e,t,i),t.innerHTML=a[15]},p(e,i){i[0]&32768&&(t.innerHTML=e[15])},d(e){e&&T(t)}}}function Ie(a){let t,e,i,c,u,v,h,f,I,w,$,p,d,m,r,z,M,V,g=a[0]&&a[1]=="inside"&&K(a),y=a[5]&&Q(a);return{c(){g&&g.c(),t=q(),e=b("div"),i=b("label"),c=b("input"),v=q(),h=J("svg"),f=J("path"),I=q(),w=b("div"),$=b("button"),$.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="1rem" viewBox="0 0 576 512"><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"></path></svg>',p=q(),y&&y.c(),d=q(),m=b("span"),r=b("input"),n(c,"type","file"),n(c,"id",a[3]),n(c,"class","jp-file-upload-field-upload"),n(c,"accept",u=a[4]&&a[4].acceptedFiles),n(f,"d","M64 480H448c35.3 0 64-28.7 64-64V160c0-35.3-28.7-64-64-64H288c-10.1 0-19.6-4.7-25.6-12.8L243.2 57.6C231.1 41.5 212.1 32 192 32H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64z"),n(h,"xmlns","http://www.w3.org/2000/svg"),n(h,"height","1rem"),n(h,"viewBox","0 0 512 512"),n(i,"for",a[3]),n(i,"class","jp-file-upload-field-icon jp-file-upload-field-icon-upload"),n($,"type","button"),n(w,"class","jp-file-upload-field-icon jp-file-upload-field-icon-preview-button"),S(w,"jp-file-upload-field-icon-hidden",!a[10]),n(e,"class","jp-file-upload-field-icons"),n(r,"class",z=`jp-file-upload-field-input ${a[1]=="outside"||!a[0]?"":"jp-file-upload-field-input-padding"}`),n(r,"type","text"),n(r,"name",a[3]),n(r,"id",a[2]),r.disabled=a[9],n(m,"class","jp-file-upload-field-upload-container")},m(s,o){g&&g.m(s,o),x(s,t,o),x(s,e,o),j(e,i),j(i,c),a[30](c),j(i,v),j(i,h),j(h,f),j(e,I),j(e,w),j(w,$),j(e,p),y&&y.m(e,null),x(s,d,o),x(s,m,o),j(m,r),U(r,a[14]),M||(V=[F(c,"change",a[17]),F(c,"focus",a[31]),F(c,"blur",a[32]),F($,"click",k(a[33])),F(r,"focus",a[35]),F(r,"blur",a[36]),F(r,"change",a[37]),F(r,"input",a[38])],M=!0)},p(s,o){s[0]&&s[1]=="inside"?g?g.p(s,o):(g=K(s),g.c(),g.m(t.parentNode,t)):g&&(g.d(1),g=null),o[0]&8&&n(c,"id",s[3]),o[0]&16&&u!==(u=s[4]&&s[4].acceptedFiles)&&n(c,"accept",u),o[0]&8&&n(i,"for",s[3]),o[0]&1024&&S(w,"jp-file-upload-field-icon-hidden",!s[10]),s[5]?y?y.p(s,o):(y=Q(s),y.c(),y.m(e,null)):y&&(y.d(1),y=null),o[0]&3&&z!==(z=`jp-file-upload-field-input ${s[1]=="outside"||!s[0]?"":"jp-file-upload-field-input-padding"}`)&&n(r,"class",z),o[0]&8&&n(r,"name",s[3]),o[0]&4&&n(r,"id",s[2]),o[0]&512&&(r.disabled=s[9]),o[0]&16384&&r.value!==s[14]&&U(r,s[14])},d(s){s&&(T(t),T(e),T(d),T(m)),g&&g.d(s),a[30](null),y&&y.d(),M=!1,A(V)}}}function Ve(a){let t,e,i;return{c(){t=b("div"),n(t,"class","jp-file-upload-drop")},m(c,u){x(c,t,u),e||(i=[F(t,"dragleave",a[27]),F(t,"dragend",a[28]),F(t,"drop",k(a[29]))],e=!0)},p:B,d(c){c&&T(t),e=!1,A(i)}}}function K(a){let t;return{c(){t=b("span"),n(t,"class","jp-file-upload-label"),S(t,"jp-file-upload-label-move",a[8]||a[14])},m(e,i){x(e,t,i),t.innerHTML=a[15]},p(e,i){i[0]&32768&&(t.innerHTML=e[15]),i[0]&16640&&S(t,"jp-file-upload-label-move",e[8]||e[14])},d(e){e&&T(t)}}}function Q(a){let t,e,i,c;return{c(){t=b("div"),e=b("button"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="1rem" viewBox="0 0 512 512"><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z"></path></svg>',n(e,"type","button"),n(t,"class","jp-file-upload-field-icon")},m(u,v){x(u,t,v),j(t,e),i||(c=F(e,"click",k(a[34])),i=!0)},p:B,d(u){u&&T(t),i=!1,c()}}}function X(a){let t,e,i,c,u;return{c(){t=b("div"),e=b("img"),n(e,"class","jp-file-upload-preview"),n(e,"style",a[6]),P(e.src,i=a[10])||n(e,"src",i),n(e,"alt","preview"),n(t,"class","jp-file-upload-overlay")},m(v,h){x(v,t,h),j(t,e),c||(u=[ze(He.call(null,e)),F(e,"click_outside",a[41])],c=!0)},p(v,h){h[0]&64&&n(e,"style",v[6]),h[0]&1024&&!P(e.src,i=v[10])&&n(e,"src",i)},d(v){v&&T(t),c=!1,A(u)}}}function qe(a){let t,e,i,c,u,v,h,f=a[0]&&a[1]=="outside"&&G(a);function I(d,m){return d[12]?Ve:Ie}let w=I(a),$=w(a),p=a[11]&&X(a);return{c(){f&&f.c(),t=q(),e=b("div"),i=b("div"),$.c(),c=q(),p&&p.c(),u=Te(),n(i,"class","jp-file-upload-field")},m(d,m){f&&f.m(d,m),x(d,t,m),x(d,e,m),j(e,i),$.m(i,null),a[39](i),x(d,c,m),p&&p.m(d,m),x(d,u,m),v||(h=F(i,"dragover",k(a[40])),v=!0)},p(d,m){d[0]&&d[1]=="outside"?f?f.p(d,m):(f=G(d),f.c(),f.m(t.parentNode,t)):f&&(f.d(1),f=null),w===(w=I(d))&&$?$.p(d,m):($.d(1),$=w(d),$&&($.c(),$.m(i,null))),d[11]?p?p.p(d,m):(p=X(d),p.c(),p.m(u.parentNode,u)):p&&(p.d(1),p=null)},i:B,o:B,d(d){d&&(T(t),T(e),T(c),T(u)),f&&f.d(d),$.d(),a[39](null),p&&p.d(d),v=!1,h()}}}function Le(a){return new Promise((t,e)=>{const i=new FileReader;i.readAsDataURL(a),i.onload=()=>t(i.result),i.onerror=c=>e(c)})}function Ce(a,t,e){let i,{label:c=""}=t,{labelType:u="inside"}=t,{attachedInternals:v}=t,{value:h=""}=t,{id:f=""}=t,{name:I=""}=t,{required:w=!1}=t,{displayFormat:$="snake"}=t,{displayFormatFunction:p}=t,d,m,r=!1,z=!1,M="",V=null,g=!1,y=!1,s,o,C=h&&W(h,$,p)||"";const D=Me();let{service:L}=t;const ee=()=>s;async function te(l){if(z)try{e(5,s=await L.uploadFile(V,l))}catch(_){console.error(_)}return s}async function O(l){if(L&&L.maxSize&&l.size>L.maxSize){D("rejected",{file:l.name,code:"maxSize"});return}if(e(9,z=!0),V=l,e(5,s=l.name),e(14,C=W(s,$,p)),V.type.split("/")[0]==="image"){const _=await Le(V);e(10,M=_)}else e(10,M="")}async function R(l){l.dataTransfer.files.length&&O(l.dataTransfer.files[0]),e(12,y=!1)}async function ae(l){O(l.target.files[0])}async function N(){z||((await(await fetch(s)).blob()).type.startsWith("image/")?e(10,M=s):e(10,M=""))}function Y(){const l=m.getBoundingClientRect();window.innerHeight-l.bottom<300?e(6,d=`
        width: ${l.width}px;
        top: ${window.scrollY+l.top}px;
        transform: translateY(-100%);
      `):e(6,d=`
        width: ${l.width}px;
        top: ${window.scrollY+l.bottom}px;
      `),e(11,g=!g)}const le=()=>e(12,y=!1),ie=()=>e(12,y=!1),se=l=>R(l);function ne(l){E[l?"unshift":"push"](()=>{o=l,e(13,o)})}const ce=()=>e(8,r=!0),de=()=>e(8,r=!1),re=()=>Y(),oe=()=>{e(9,z=!1),e(10,M=""),e(5,s=""),e(13,o.value="",o),e(14,C="")},ue=()=>e(8,r=!0),pe=()=>e(8,r=!1),me=()=>N();function he(){C=this.value,e(14,C)}function fe(l){E[l?"unshift":"push"](()=>{m=l,e(7,m)})}const $e=()=>e(12,y=!0),ve=()=>e(11,g=!1);return a.$$set=l=>{"label"in l&&e(0,c=l.label),"labelType"in l&&e(1,u=l.labelType),"attachedInternals"in l&&e(20,v=l.attachedInternals),"value"in l&&e(21,h=l.value),"id"in l&&e(2,f=l.id),"name"in l&&e(3,I=l.name),"required"in l&&e(22,w=l.required),"displayFormat"in l&&e(23,$=l.displayFormat),"displayFormatFunction"in l&&e(24,p=l.displayFormatFunction),"service"in l&&e(4,L=l.service)},a.$$.update=()=>{a.$$.dirty[0]&2097152&&(e(5,s=h),h?N():e(10,M="")),a.$$.dirty[0]&1048608&&(v.checkValidity(),v.setFormValue(s),D("value",{internalValue:s})),a.$$.dirty[0]&4194305&&e(15,i=w?`${c} *`:c)},[c,u,f,I,L,s,d,m,r,z,M,g,y,o,C,i,R,ae,N,Y,v,h,w,$,p,ee,te,le,ie,se,ne,ce,de,re,oe,ue,pe,me,he,fe,$e,ve]}class Z extends Fe{constructor(t){super(),xe(this,t,Ce,qe,je,{label:0,labelType:1,attachedInternals:20,value:21,id:2,name:3,required:22,displayFormat:23,displayFormatFunction:24,service:4,getValue:25,save:26},null,[-1,-1])}get label(){return this.$$.ctx[0]}set label(t){this.$$set({label:t}),H()}get labelType(){return this.$$.ctx[1]}set labelType(t){this.$$set({labelType:t}),H()}get attachedInternals(){return this.$$.ctx[20]}set attachedInternals(t){this.$$set({attachedInternals:t}),H()}get value(){return this.$$.ctx[21]}set value(t){this.$$set({value:t}),H()}get id(){return this.$$.ctx[2]}set id(t){this.$$set({id:t}),H()}get name(){return this.$$.ctx[3]}set name(t){this.$$set({name:t}),H()}get required(){return this.$$.ctx[22]}set required(t){this.$$set({required:t}),H()}get displayFormat(){return this.$$.ctx[23]}set displayFormat(t){this.$$set({displayFormat:t}),H()}get displayFormatFunction(){return this.$$.ctx[24]}set displayFormatFunction(t){this.$$set({displayFormatFunction:t}),H()}get service(){return this.$$.ctx[4]}set service(t){this.$$set({service:t}),H()}get getValue(){return this.$$.ctx[25]}get save(){return this.$$.ctx[26]}}try{customElements.define("jp-file-upload",we(Z,{label:{},labelType:{},attachedInternals:{},value:{},id:{},name:{},required:{type:"Boolean"},displayFormat:{},displayFormatFunction:{},service:{}},[],["getValue","save"],!1,a=>{var t;return t=class extends a{constructor(){super(),this.attachedInternals=this.attachInternals()}},be(t,"formAssociated",!0),t}));}catch{};export{Z as default};
//# sourceMappingURL=file-upload.wc.js.map
