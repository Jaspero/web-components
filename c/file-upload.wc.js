var xe=Object.defineProperty,we=(s,t,e)=>t in s?xe(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,ge=(s,t,e)=>(we(s,typeof t!="symbol"?t+"":t,e),e);import{c as ye,S as $e,i as ke,f as H,s as ze,a as Fe,m as q,e as g,C as Te,d as o,g as k,r as z,v as $,y as V,z as j,l as F,w as Ie,I as _,W as He,E as N,x as D,n as O,p as B,a0 as U,L as G}from"./svelte.js";import"./index2.js";import{c as Me}from"./clickOutside.js";import{f as Ye}from"./fileNameFormatter.js";function qe(s){Fe(s,"svelte-htbhvm",`.field.svelte-htbhvm.svelte-htbhvm{position:relative;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-webkit-flex-direction:row-reverse;-moz-box-orient:horizontal;-moz-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;text-align:left;width:100%;height:3rem;padding-right:0.75rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;gap:0.75rem;background-color:transparent;border:1px solid var(--border-primary);-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem}.drop.svelte-htbhvm.svelte-htbhvm{position:absolute;left:0;right:0;top:0;bottom:0;border:2px dashed var(--primary-color)}.field.svelte-htbhvm.svelte-htbhvm:focus-within{border-color:var(--primary-color);-webkit-box-shadow:inset 0 0 0 1px var(--primary-color);-moz-box-shadow:inset 0 0 0 1px var(--primary-color);box-shadow:inset 0 0 0 1px var(--primary-color)}.field-label.svelte-htbhvm.svelte-htbhvm{position:absolute;top:50%;left:0.75rem;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);-o-transform:translateY(-50%);transform:translateY(-50%);font-size:1rem;-webkit-transition:transform 0.3s,
      top 0.3s,
      font-size 0.3s;-o-transition:transform 0.3s,
      top 0.3s,
      font-size 0.3s;-moz-transition:transform 0.3s,
      top 0.3s,
      font-size 0.3s;-webkit-transition:top 0.3s,
      font-size 0.3s,
      -webkit-transform 0.3s;transition:top 0.3s,
      font-size 0.3s,
      -webkit-transform 0.3s;-o-transition:top 0.3s,
      font-size 0.3s,
      -o-transform 0.3s;-moz-transition:transform 0.3s,
      top 0.3s,
      font-size 0.3s,
      -moz-transform 0.3s;transition:transform 0.3s,
      top 0.3s,
      font-size 0.3s;transition:transform 0.3s,
      top 0.3s,
      font-size 0.3s,
      -webkit-transform 0.3s,
      -moz-transform 0.3s,
      -o-transform 0.3s}.field-label.move.svelte-htbhvm.svelte-htbhvm{top:0.25rem;-webkit-transform:translateY(0);-moz-transform:translateY(0);-ms-transform:translateY(0);-o-transform:translateY(0);transform:translateY(0);font-size:0.75rem}.field-input.svelte-htbhvm.svelte-htbhvm{-webkit-box-flex:1;-webkit-flex:auto;-moz-box-flex:1;-ms-flex:auto;flex:auto;width:10rem;height:100%;font-size:1rem;white-space:nowrap;background:transparent;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;border:none;outline:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.field-input-padding.svelte-htbhvm.svelte-htbhvm{padding:1rem 0 0 0}.field-upload.svelte-htbhvm.svelte-htbhvm{z-index:1;position:absolute;top:0;left:0;width:100%;height:100%;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;opacity:0;cursor:pointer}.field-upload-container.svelte-htbhvm.svelte-htbhvm{position:relative;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;padding:0 0.75rem;height:100%;overflow:hidden;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1}.field-icons.svelte-htbhvm.svelte-htbhvm{z-index:1;position:relative;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:0.375rem}.field-icon.svelte-htbhvm.svelte-htbhvm{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;width:2rem;height:2rem;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;cursor:pointer}.field-icon.svelte-htbhvm.svelte-htbhvm:hover{background:var(--background-tertiary)}.field-icon.hidden.svelte-htbhvm.svelte-htbhvm{display:none}.field-icon-upload.svelte-htbhvm.svelte-htbhvm{position:relative;cursor:pointer}.field-icon.svelte-htbhvm button.svelte-htbhvm{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:100%}.preview-button.svelte-htbhvm.svelte-htbhvm{position:relative}.preview.svelte-htbhvm.svelte-htbhvm{z-index:1;position:absolute;max-width:300px;max-height:300px;width:auto;height:auto;background-color:var(--background-primary);-webkit-border-radius:0.5rem;-moz-border-radius:0.5rem;border-radius:0.5rem;-webkit-box-shadow:0 3px 12px 3px rgba(0, 0, 0, 0.16);-moz-box-shadow:0 3px 12px 3px rgba(0, 0, 0, 0.16);box-shadow:0 3px 12px 3px rgba(0, 0, 0, 0.16)}.overlay.svelte-htbhvm.svelte-htbhvm{z-index:100;position:fixed;top:0;left:0;width:100vw;height:100vh}`)}function J(s){let t;return{c(){t=g("div"),o(t,"class","label")},m(e,r){k(e,t,r),t.innerHTML=s[15]},p(e,r){r[0]&32768&&(t.innerHTML=e[15])},d(e){e&&F(t)}}}function Le(s){let t,e,r,l,m,u,x,b,M,y,p,v,n,h,d,I,T,Y,w=s[0]&&s[1]=="inside"&&K(s),f=s[5]&&Q(s);return{c(){w&&w.c(),t=q(),e=g("div"),r=g("label"),l=g("input"),u=q(),x=O("svg"),b=O("path"),M=q(),y=g("div"),p=g("button"),p.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="1rem" viewBox="0 0 576 512"><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"></path></svg>',v=q(),f&&f.c(),n=q(),h=g("span"),d=g("input"),o(l,"type","file"),o(l,"id",s[3]),o(l,"class","field-upload svelte-htbhvm"),o(l,"accept",m=s[4]&&s[4].acceptedFiles),o(b,"d","M64 480H448c35.3 0 64-28.7 64-64V160c0-35.3-28.7-64-64-64H288c-10.1 0-19.6-4.7-25.6-12.8L243.2 57.6C231.1 41.5 212.1 32 192 32H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64z"),o(x,"xmlns","http://www.w3.org/2000/svg"),o(x,"height","1rem"),o(x,"viewBox","0 0 512 512"),o(r,"for",s[3]),o(r,"class","field-icon field-icon-upload svelte-htbhvm"),o(p,"type","button"),o(p,"class","svelte-htbhvm"),o(y,"class","field-icon preview-button svelte-htbhvm"),B(y,"hidden",!s[10]),o(e,"class","field-icons svelte-htbhvm"),o(d,"class",I=U(`field-input ${s[1]=="outside"||!s[0]?"":"field-input-padding"}`)+" svelte-htbhvm"),o(d,"type","text"),o(d,"name",s[3]),o(d,"id",s[2]),d.disabled=s[9],o(h,"class","field-upload-container svelte-htbhvm")},m(a,c){w&&w.m(a,c),k(a,t,c),k(a,e,c),z(e,r),z(r,l),s[30](l),z(r,u),z(r,x),z(x,b),z(e,M),z(e,y),z(y,p),z(e,v),f&&f.m(e,null),k(a,n,c),k(a,h,c),z(h,d),G(d,s[14]),T||(Y=[$(l,"change",s[17]),$(l,"focus",s[31]),$(l,"blur",s[32]),$(p,"click",V(s[33])),$(d,"focus",s[35]),$(d,"blur",s[36]),$(d,"change",s[37]),$(d,"input",s[38])],T=!0)},p(a,c){a[0]&&a[1]=="inside"?w?w.p(a,c):(w=K(a),w.c(),w.m(t.parentNode,t)):w&&(w.d(1),w=null),c[0]&8&&o(l,"id",a[3]),c[0]&16&&m!==(m=a[4]&&a[4].acceptedFiles)&&o(l,"accept",m),c[0]&8&&o(r,"for",a[3]),c[0]&1024&&B(y,"hidden",!a[10]),a[5]?f?f.p(a,c):(f=Q(a),f.c(),f.m(e,null)):f&&(f.d(1),f=null),c[0]&3&&I!==(I=U(`field-input ${a[1]=="outside"||!a[0]?"":"field-input-padding"}`)+" svelte-htbhvm")&&o(d,"class",I),c[0]&8&&o(d,"name",a[3]),c[0]&4&&o(d,"id",a[2]),c[0]&512&&(d.disabled=a[9]),c[0]&16384&&d.value!==a[14]&&G(d,a[14])},d(a){a&&(F(t),F(e),F(n),F(h)),w&&w.d(a),s[30](null),f&&f.d(),T=!1,N(Y)}}}function Ce(s){let t,e,r;return{c(){t=g("div"),o(t,"class","drop svelte-htbhvm")},m(l,m){k(l,t,m),e||(r=[$(t,"dragleave",s[27]),$(t,"dragend",s[28]),$(t,"drop",V(s[29]))],e=!0)},p:j,d(l){l&&F(t),e=!1,N(r)}}}function K(s){let t;return{c(){t=g("span"),o(t,"class","field-label svelte-htbhvm"),B(t,"move",s[8]||s[5])},m(e,r){k(e,t,r),t.innerHTML=s[15]},p(e,r){r[0]&32768&&(t.innerHTML=e[15]),r[0]&288&&B(t,"move",e[8]||e[5])},d(e){e&&F(t)}}}function Q(s){let t,e,r,l;return{c(){t=g("div"),e=g("button"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="1rem" viewBox="0 0 512 512"><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z"></path></svg>',o(e,"type","button"),o(e,"class","svelte-htbhvm"),o(t,"class","field-icon svelte-htbhvm")},m(m,u){k(m,t,u),z(t,e),r||(l=$(e,"click",V(s[34])),r=!0)},p:j,d(m){m&&F(t),r=!1,l()}}}function X(s){let t,e,r,l,m;return{c(){t=g("div"),e=g("img"),o(e,"class","preview svelte-htbhvm"),o(e,"style",s[6]),_(e.src,r=s[10])||o(e,"src",r),o(e,"alt","preview"),o(t,"class","overlay svelte-htbhvm")},m(u,x){k(u,t,x),z(t,e),l||(m=[He(Me.call(null,e)),$(e,"click_outside",s[41])],l=!0)},p(u,x){x[0]&64&&o(e,"style",u[6]),x[0]&1024&&!_(e.src,r=u[10])&&o(e,"src",r)},d(u){u&&F(t),l=!1,N(m)}}}function Ve(s){let t,e,r,l,m,u,x,b=s[0]&&s[1]=="outside"&&J(s);function M(n,h){return n[12]?Ce:Le}let y=M(s),p=y(s),v=s[11]&&X(s);return{c(){b&&b.c(),t=q(),e=g("div"),r=g("div"),p.c(),l=q(),v&&v.c(),m=Te(),o(r,"class","field svelte-htbhvm")},m(n,h){b&&b.m(n,h),k(n,t,h),k(n,e,h),z(e,r),p.m(r,null),s[39](r),k(n,l,h),v&&v.m(n,h),k(n,m,h),u||(x=$(r,"dragover",V(s[40])),u=!0)},p(n,h){n[0]&&n[1]=="outside"?b?b.p(n,h):(b=J(n),b.c(),b.m(t.parentNode,t)):b&&(b.d(1),b=null),y===(y=M(n))&&p?p.p(n,h):(p.d(1),p=y(n),p&&(p.c(),p.m(r,null))),n[11]?v?v.p(n,h):(v=X(n),v.c(),v.m(m.parentNode,m)):v&&(v.d(1),v=null)},i:j,o:j,d(n){n&&(F(t),F(e),F(l),F(m)),b&&b.d(n),p.d(),s[39](null),v&&v.d(n),u=!1,x()}}}function je(s){return new Promise((t,e)=>{const r=new FileReader;r.readAsDataURL(s),r.onload=()=>t(r.result),r.onerror=l=>e(l)})}function Be(s,t,e){let r,{label:l=""}=t,{labelType:m="inside"}=t,{attachedInternals:u}=t,{value:x=""}=t,{id:b=""}=t,{name:M=""}=t,{required:y=!1}=t,{displayFormat:p="snake"}=t,{displayFormatFunction:v}=t,n,h,d=!1,I=!1,T="",Y=null,w=!1,f=!1,a,c,C="";const R=Ie();let{service:L}=t;const ee=()=>a;async function te(i){if(I)try{e(5,a=await L.uploadFile(Y,i))}catch(A){console.error(A)}return a}async function E(i){if(L&&L.maxSize&&i.size>L.maxSize){R("rejected",{file:i.name,code:"maxSize"});return}if(e(9,I=!0),Y=i,e(5,a=i.name),e(14,C=Ye(a,p,v)),Y.type.split("/")[0]==="image"){const A=await je(Y);e(10,T=A)}else e(10,T="")}async function P(i){i.dataTransfer.files.length&&E(i.dataTransfer.files[0]),e(12,f=!1)}async function se(i){E(i.target.files[0])}async function S(){I||((await(await fetch(a)).blob()).type.startsWith("image/")?e(10,T=a):e(10,T=""))}function W(){const i=h.getBoundingClientRect();window.innerHeight-i.bottom<300?e(6,n=`
        width: ${i.width}px;
        bottom: ${window.innerHeight-i.top}px;
        left: ${i.width-300}px;
      `):e(6,n=`
        width: ${i.width}px;
        top: ${i.bottom}px;
        left: ${i.width-300}px;
      `),e(11,w=!w)}const ie=()=>e(12,f=!1),re=()=>e(12,f=!1),ae=i=>P(i);function oe(i){D[i?"unshift":"push"](()=>{c=i,e(13,c)})}const le=()=>e(8,d=!0),ne=()=>e(8,d=!1),de=()=>W(),ce=()=>{e(9,I=!1),e(10,T=""),e(5,a=""),e(13,c.value="",c)},me=()=>e(8,d=!0),he=()=>e(8,d=!1),be=()=>S();function pe(){C=this.value,e(14,C)}function ve(i){D[i?"unshift":"push"](()=>{h=i,e(7,h)})}const ue=()=>e(12,f=!0),fe=()=>e(11,w=!1);return s.$$set=i=>{"label"in i&&e(0,l=i.label),"labelType"in i&&e(1,m=i.labelType),"attachedInternals"in i&&e(20,u=i.attachedInternals),"value"in i&&e(21,x=i.value),"id"in i&&e(2,b=i.id),"name"in i&&e(3,M=i.name),"required"in i&&e(22,y=i.required),"displayFormat"in i&&e(23,p=i.displayFormat),"displayFormatFunction"in i&&e(24,v=i.displayFormatFunction),"service"in i&&e(4,L=i.service)},s.$$.update=()=>{s.$$.dirty[0]&2097152&&(e(5,a=x),x?S():e(10,T="")),s.$$.dirty[0]&1048608&&(u.checkValidity(),u.setFormValue(a),R("value",{internalValue:a})),s.$$.dirty[0]&4194305&&e(15,r=y?`${l} *`:l)},[l,m,b,M,L,a,n,h,d,I,T,w,f,c,C,r,P,se,S,W,u,x,y,p,v,ee,te,ie,re,ae,oe,le,ne,de,ce,me,he,be,pe,ve,ue,fe]}class Z extends $e{constructor(t){super(),ke(this,t,Be,Ve,ze,{label:0,labelType:1,attachedInternals:20,value:21,id:2,name:3,required:22,displayFormat:23,displayFormatFunction:24,service:4,getValue:25,save:26},qe,[-1,-1])}get label(){return this.$$.ctx[0]}set label(t){this.$$set({label:t}),H()}get labelType(){return this.$$.ctx[1]}set labelType(t){this.$$set({labelType:t}),H()}get attachedInternals(){return this.$$.ctx[20]}set attachedInternals(t){this.$$set({attachedInternals:t}),H()}get value(){return this.$$.ctx[21]}set value(t){this.$$set({value:t}),H()}get id(){return this.$$.ctx[2]}set id(t){this.$$set({id:t}),H()}get name(){return this.$$.ctx[3]}set name(t){this.$$set({name:t}),H()}get required(){return this.$$.ctx[22]}set required(t){this.$$set({required:t}),H()}get displayFormat(){return this.$$.ctx[23]}set displayFormat(t){this.$$set({displayFormat:t}),H()}get displayFormatFunction(){return this.$$.ctx[24]}set displayFormatFunction(t){this.$$set({displayFormatFunction:t}),H()}get service(){return this.$$.ctx[4]}set service(t){this.$$set({service:t}),H()}get getValue(){return this.$$.ctx[25]}get save(){return this.$$.ctx[26]}}try{customElements.define("jp-file-upload",ye(Z,{label:{},labelType:{},attachedInternals:{},value:{},id:{},name:{},required:{type:"Boolean"},displayFormat:{},displayFormatFunction:{},service:{}},[],["getValue","save"],!1,s=>{var t;return t=class extends s{constructor(){super(),this.attachedInternals=this.attachInternals()}},ge(t,"formAssociated",!0),t}));}catch{};export{Z as default};
