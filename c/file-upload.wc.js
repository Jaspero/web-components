var he=Object.defineProperty,$e=(l,t,e)=>t in l?he(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e,ve=(l,t,e)=>$e(l,typeof t!="symbol"?t+"":t,e);import{c as ye,S as ge,i as be,o as H,s as we,l as L,e as g,y as Fe,d,f as w,p as T,m as j,N as C,w as N,k as F,x as xe,J as O,q as je,r as R,n as P,A as S,X as E,Z as Te}from"./svelte.js";import"./index.js";import{clickOutside as qe}from"./click-outside.js";import{formatDisplayFileName as J}from"./fileNameFormatter.js";import{d as He}from"./delete.js";const Ie=' <svg xmlns="http://www.w3.org/2000/svg" height="1rem" viewBox="0 0 512 512"><path d="M64 480H448c35.3 0 64-28.7 64-64V160c0-35.3-28.7-64-64-64H288c-10.1 0-19.6-4.7-25.6-12.8L243.2 57.6C231.1 41.5 212.1 32 192 32H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64z"/></svg>',ze='<svg xmlns="http://www.w3.org/2000/svg" height="1rem" viewBox="0 0 576 512"><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"/></svg>';function U(l){let t;return{c(){t=g("div"),d(t,"class","label")},m(e,n){w(e,t,n),t.innerHTML=l[16]},p(e,n){n[0]&65536&&(t.innerHTML=e[16])},d(e){e&&F(t)}}}function Le(l){let t,e,n,c,u,f,v,m,x,b,y,p,r,s,z,I,q,h=l[0]&&l[1]=="inside"&&Z(l),$=l[6]&&G(l);return{c(){h&&h.c(),t=L(),e=g("div"),n=g("label"),c=g("input"),f=L(),v=new Te(!1),m=L(),x=g("div"),b=g("button"),y=L(),$&&$.c(),p=L(),r=g("span"),s=g("input"),d(c,"type","file"),d(c,"id",l[3]),d(c,"class","jp-file-upload-field-upload"),d(c,"accept",u=l[5]&&l[5].acceptedFiles),v.a=null,d(n,"for",l[3]),d(n,"class","jp-file-upload-field-icon jp-file-upload-field-icon-upload"),d(b,"type","button"),d(x,"class","jp-file-upload-field-icon jp-file-upload-field-icon-preview-button"),S(x,"jp-file-upload-field-icon-hidden",!l[11]),d(e,"class","jp-file-upload-field-icons"),d(s,"class",z=`jp-file-upload-field-input ${l[1]=="outside"||!l[0]?"":"jp-file-upload-field-input-padding"}`),d(s,"type","text"),d(s,"name",l[3]),d(s,"id",l[2]),s.required=l[4],s.disabled=l[10],d(r,"class","jp-file-upload-field-upload-container")},m(i,o){h&&h.m(i,o),w(i,t,o),w(i,e,o),T(e,n),T(n,c),l[30](c),T(n,f),v.m(Ie,n),T(e,m),T(e,x),T(x,b),b.innerHTML=ze,T(e,y),$&&$.m(e,null),w(i,p,o),w(i,r,o),T(r,s),E(s,l[15]),I||(q=[j(c,"change",l[18]),j(b,"click",C(l[31])),j(s,"focus",l[33]),j(s,"blur",l[34]),j(s,"change",l[35]),j(s,"input",l[36])],I=!0)},p(i,o){i[0]&&i[1]=="inside"?h?h.p(i,o):(h=Z(i),h.c(),h.m(t.parentNode,t)):h&&(h.d(1),h=null),o[0]&8&&d(c,"id",i[3]),o[0]&32&&u!==(u=i[5]&&i[5].acceptedFiles)&&d(c,"accept",u),o[0]&8&&d(n,"for",i[3]),o[0]&2048&&S(x,"jp-file-upload-field-icon-hidden",!i[11]),i[6]?$?$.p(i,o):($=G(i),$.c(),$.m(e,null)):$&&($.d(1),$=null),o[0]&3&&z!==(z=`jp-file-upload-field-input ${i[1]=="outside"||!i[0]?"":"jp-file-upload-field-input-padding"}`)&&d(s,"class",z),o[0]&8&&d(s,"name",i[3]),o[0]&4&&d(s,"id",i[2]),o[0]&16&&(s.required=i[4]),o[0]&1024&&(s.disabled=i[10]),o[0]&32768&&s.value!==i[15]&&E(s,i[15])},d(i){i&&(F(t),F(e),F(p),F(r)),h&&h.d(i),l[30](null),$&&$.d(),I=!1,R(q)}}}function Me(l){let t,e,n;return{c(){t=g("div"),d(t,"class","jp-file-upload-drop")},m(c,u){w(c,t,u),e||(n=[j(t,"dragleave",l[27]),j(t,"dragend",l[28]),j(t,"drop",C(l[29]))],e=!0)},p:N,d(c){c&&F(t),e=!1,R(n)}}}function Z(l){let t;return{c(){t=g("span"),d(t,"class","jp-file-upload-label"),S(t,"jp-file-upload-label-move",l[9]||l[15])},m(e,n){w(e,t,n),t.innerHTML=l[16]},p(e,n){n[0]&65536&&(t.innerHTML=e[16]),n[0]&33280&&S(t,"jp-file-upload-label-move",e[9]||e[15])},d(e){e&&F(t)}}}function G(l){let t,e,n,c;return{c(){t=g("div"),e=g("button"),d(e,"type","button"),d(t,"class","jp-file-upload-field-icon")},m(u,f){w(u,t,f),T(t,e),e.innerHTML=He,n||(c=j(e,"click",C(l[32])),n=!0)},p:N,d(u){u&&F(t),n=!1,c()}}}function K(l){let t,e,n,c,u;return{c(){t=g("div"),e=g("img"),d(e,"class","jp-file-upload-preview"),d(e,"style",l[7]),O(e.src,n=l[11])||d(e,"src",n),d(e,"alt","preview"),d(t,"class","jp-file-upload-overlay")},m(f,v){w(f,t,v),T(t,e),c||(u=[je(qe.call(null,e)),j(e,"click_outside",l[39])],c=!0)},p(f,v){v[0]&128&&d(e,"style",f[7]),v[0]&2048&&!O(e.src,n=f[11])&&d(e,"src",n)},d(f){f&&F(t),c=!1,R(u)}}}function ke(l){let t,e,n,c,u,f,v,m=l[0]&&l[1]=="outside"&&U(l);function x(r,s){return r[13]?Me:Le}let b=x(l),y=b(l),p=l[12]&&K(l);return{c(){m&&m.c(),t=L(),e=g("div"),n=g("div"),y.c(),c=L(),p&&p.c(),u=Fe(),d(n,"class","jp-file-upload-field")},m(r,s){m&&m.m(r,s),w(r,t,s),w(r,e,s),T(e,n),y.m(n,null),l[37](n),w(r,c,s),p&&p.m(r,s),w(r,u,s),f||(v=j(n,"dragover",C(l[38])),f=!0)},p(r,s){r[0]&&r[1]=="outside"?m?m.p(r,s):(m=U(r),m.c(),m.m(t.parentNode,t)):m&&(m.d(1),m=null),b===(b=x(r))&&y?y.p(r,s):(y.d(1),y=b(r),y&&(y.c(),y.m(n,null))),r[12]?p?p.p(r,s):(p=K(r),p.c(),p.m(u.parentNode,u)):p&&(p.d(1),p=null)},i:N,o:N,d(r){r&&(F(t),F(e),F(c),F(u)),m&&m.d(r),y.d(),l[37](null),p&&p.d(r),f=!1,v()}}}function Ve(l){return new Promise((t,e)=>{const n=new FileReader;n.readAsDataURL(l),n.onload=()=>t(n.result),n.onerror=c=>e(c)})}function Ce(l,t,e){let n,{label:c=""}=t,{labelType:u="inside"}=t,{attachedInternals:f}=t,{value:v=""}=t,{id:m=""}=t,{name:x=""}=t,{required:b=!1}=t,{displayFormat:y=""}=t,{displayFormatFunction:p}=t,r,s,z=!1,I=!1,q="",h=null,$=!1,i=!1,o,k,V=v&&J(v,y,p)||"";const W=xe();let{service:M}=t;const X=()=>o;async function ee(a){if(I)try{e(6,o=await M.uploadFile(h,a))}catch(A){console.error(A)}return o}async function Y(a){if(M&&M.maxSize&&a.size>M.maxSize){W("rejected",{file:a.name,code:"maxSize"});return}if(e(10,I=!0),h=a,e(6,o=a.name),e(15,V=J(o,y,p)),h.type.split("/")[0]==="image"){const A=await Ve(h);e(11,q=A)}else e(11,q="")}async function _(a){a.dataTransfer.files.length&&Y(a.dataTransfer.files[0]),e(13,i=!1)}async function te(a){Y(a.target.files[0])}async function B(){I||((await(await fetch(o)).blob()).type.startsWith("image/")?e(11,q=o):e(11,q=""))}function D(){const a=s.getBoundingClientRect();window.innerHeight-a.bottom<300?e(7,r=`
        width: ${a.width}px;
        top: ${window.scrollY+a.top}px;
        transform: translateY(-100%);
        right: ${window.innerWidth-a.right}px;
      `):e(7,r=`
        width: ${a.width}px;
        top: ${window.scrollY+a.bottom}px;
        right: ${window.innerWidth-a.right}px;
      `),e(12,$=!$)}const le=()=>e(13,i=!1),ae=()=>e(13,i=!1),ne=a=>_(a);function se(a){P[a?"unshift":"push"](()=>{k=a,e(14,k)})}const ie=()=>D(),re=()=>{e(10,I=!1),e(11,q=""),e(6,o=""),e(14,k.value="",k),e(15,V="")},de=()=>e(9,z=!0),ce=()=>e(9,z=!1),oe=()=>B();function pe(){V=this.value,e(15,V)}function ue(a){P[a?"unshift":"push"](()=>{s=a,e(8,s)})}const fe=()=>e(13,i=!0),me=()=>e(12,$=!1);return l.$$set=a=>{"label"in a&&e(0,c=a.label),"labelType"in a&&e(1,u=a.labelType),"attachedInternals"in a&&e(21,f=a.attachedInternals),"value"in a&&e(22,v=a.value),"id"in a&&e(2,m=a.id),"name"in a&&e(3,x=a.name),"required"in a&&e(4,b=a.required),"displayFormat"in a&&e(23,y=a.displayFormat),"displayFormatFunction"in a&&e(24,p=a.displayFormatFunction),"service"in a&&e(5,M=a.service)},l.$$.update=()=>{l.$$.dirty[0]&4194304&&(e(6,o=v),v?B():e(11,q="")),l.$$.dirty[0]&2097216&&(f.checkValidity(),f.setFormValue(o),W("value",{internalValue:o})),l.$$.dirty[0]&17&&e(16,n=b?`${c} *`:c)},[c,u,m,x,b,M,o,r,s,z,I,q,$,i,k,V,n,_,te,B,D,f,v,y,p,X,ee,le,ae,ne,se,ie,re,de,ce,oe,pe,ue,fe,me]}class Q extends ge{constructor(t){super(),be(this,t,Ce,ke,we,{label:0,labelType:1,attachedInternals:21,value:22,id:2,name:3,required:4,displayFormat:23,displayFormatFunction:24,service:5,getValue:25,save:26},null,[-1,-1])}get label(){return this.$$.ctx[0]}set label(t){this.$$set({label:t}),H()}get labelType(){return this.$$.ctx[1]}set labelType(t){this.$$set({labelType:t}),H()}get attachedInternals(){return this.$$.ctx[21]}set attachedInternals(t){this.$$set({attachedInternals:t}),H()}get value(){return this.$$.ctx[22]}set value(t){this.$$set({value:t}),H()}get id(){return this.$$.ctx[2]}set id(t){this.$$set({id:t}),H()}get name(){return this.$$.ctx[3]}set name(t){this.$$set({name:t}),H()}get required(){return this.$$.ctx[4]}set required(t){this.$$set({required:t}),H()}get displayFormat(){return this.$$.ctx[23]}set displayFormat(t){this.$$set({displayFormat:t}),H()}get displayFormatFunction(){return this.$$.ctx[24]}set displayFormatFunction(t){this.$$set({displayFormatFunction:t}),H()}get service(){return this.$$.ctx[5]}set service(t){this.$$set({service:t}),H()}get getValue(){return this.$$.ctx[25]}get save(){return this.$$.ctx[26]}}try{customElements.define("jp-file-upload",ye(Q,{label:{},labelType:{},attachedInternals:{},value:{},id:{},name:{},required:{type:"Boolean"},displayFormat:{},displayFormatFunction:{},service:{}},[],["getValue","save"],!1,l=>{var t;return t=class extends l{constructor(){super(),this.attachedInternals=this.attachInternals()}},ve(t,"formAssociated",!0),t}));}catch{};export{Q as default};
//# sourceMappingURL=file-upload.wc.js.map
