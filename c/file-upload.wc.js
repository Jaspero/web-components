var he=Object.defineProperty,we=(s,t,e)=>t in s?he(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,ge=(s,t,e)=>we(s,typeof t!="symbol"?t+"":t,e);import{c as ye,S as ke,i as $e,f as M,s as ze,a as Fe,b as q,e as g,H as Te,g as o,h as $,j as z,l as k,p as V,J as j,o as F,D as He,N as U,z as Me,r as A,y as _,d as E,t as B,U as J,T as W}from"./svelte.js";import"./index.js";import{clickOutside as Ie}from"./clickOutside.js";import{formatDisplayFileName as Ye}from"./fileNameFormatter.js";function qe(s){Fe(s,"svelte-41061x",`.field.svelte-41061x.svelte-41061x{position:relative;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-webkit-flex-direction:row-reverse;-moz-box-orient:horizontal;-moz-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;text-align:left;width:100%;height:3rem;padding-right:0.75rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;gap:0.75rem;background-color:transparent;border:1px solid var(--border-primary);-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem}.drop.svelte-41061x.svelte-41061x{position:absolute;left:0;right:0;top:0;bottom:0;border:2px dashed var(--primary-color)}.field.svelte-41061x.svelte-41061x:focus-within{border-color:var(--primary-color);-webkit-box-shadow:inset 0 0 0 1px var(--primary-color);-moz-box-shadow:inset 0 0 0 1px var(--primary-color);box-shadow:inset 0 0 0 1px var(--primary-color)}.field-label.svelte-41061x.svelte-41061x{position:absolute;top:50%;left:0.75rem;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);-o-transform:translateY(-50%);transform:translateY(-50%);font-size:1rem;-webkit-transition:transform 0.3s,
      top 0.3s,
      font-size 0.3s;-o-transition:transform 0.3s,
      top 0.3s,
      font-size 0.3s;-moz-transition:transform 0.3s,
      top 0.3s,
      font-size 0.3s;-webkit-transition:top 0.3s,
      font-size 0.3s,
      -webkit-transform 0.3s;transition:top 0.3s,
      font-size 0.3s,
      -webkit-transform 0.3s;-o-transition:top 0.3s,
      font-size 0.3s,
      -o-transform 0.3s;-moz-transition:transform 0.3s,
      top 0.3s,
      font-size 0.3s,
      -moz-transform 0.3s;transition:transform 0.3s,
      top 0.3s,
      font-size 0.3s;transition:transform 0.3s,
      top 0.3s,
      font-size 0.3s,
      -webkit-transform 0.3s,
      -moz-transform 0.3s,
      -o-transform 0.3s}.field-label.move.svelte-41061x.svelte-41061x{top:0.25rem;-webkit-transform:translateY(0);-moz-transform:translateY(0);-ms-transform:translateY(0);-o-transform:translateY(0);transform:translateY(0);font-size:0.75rem}.field-input.svelte-41061x.svelte-41061x{-webkit-box-flex:1;-webkit-flex:auto;-moz-box-flex:1;-ms-flex:auto;flex:auto;width:10rem;height:100%;font-size:1rem;white-space:nowrap;background:transparent;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;border:none;outline:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.field-input-padding.svelte-41061x.svelte-41061x{padding:1rem 0 0 0}.field-upload.svelte-41061x.svelte-41061x{z-index:1;position:absolute;top:0;left:0;width:100%;height:100%;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;opacity:0;cursor:pointer}.field-upload-container.svelte-41061x.svelte-41061x{position:relative;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;padding:0 0.75rem;height:100%;overflow:hidden;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1}.field-icons.svelte-41061x.svelte-41061x{z-index:1;position:relative;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:0.375rem}.field-icon.svelte-41061x.svelte-41061x{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;width:2rem;height:2rem;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;cursor:pointer}.field-icon.svelte-41061x.svelte-41061x:hover{background:var(--background-tertiary)}.field-icon.hidden.svelte-41061x.svelte-41061x{display:none}.field-icon-upload.svelte-41061x.svelte-41061x{position:relative;cursor:pointer}.field-icon.svelte-41061x button.svelte-41061x{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:100%}.preview-button.svelte-41061x.svelte-41061x{position:relative}.preview.svelte-41061x.svelte-41061x{z-index:1;position:absolute;max-width:300px;max-height:300px;width:auto;height:auto;background-color:var(--background-primary);-webkit-border-radius:0.5rem;-moz-border-radius:0.5rem;border-radius:0.5rem;-webkit-box-shadow:0 3px 12px 3px rgba(0, 0, 0, 0.16);-moz-box-shadow:0 3px 12px 3px rgba(0, 0, 0, 0.16);box-shadow:0 3px 12px 3px rgba(0, 0, 0, 0.16)}.overlay.svelte-41061x.svelte-41061x{z-index:100;position:fixed;top:0;left:0;width:100vw;height:100vh}`)}function G(s){let t;return{c(){t=g("div"),o(t,"class","label")},m(e,r){$(e,t,r),t.innerHTML=s[15]},p(e,r){r[0]&32768&&(t.innerHTML=e[15])},d(e){e&&F(t)}}}function Ce(s){let t,e,r,l,p,f,h,x,I,y,u,b,n,m,d,H,T,Y,w=s[0]&&s[1]=="inside"&&K(s),v=s[5]&&Q(s);return{c(){w&&w.c(),t=q(),e=g("div"),r=g("label"),l=g("input"),f=q(),h=E("svg"),x=E("path"),I=q(),y=g("div"),u=g("button"),u.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="1rem" viewBox="0 0 576 512"><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"></path></svg>',b=q(),v&&v.c(),n=q(),m=g("span"),d=g("input"),o(l,"type","file"),o(l,"id",s[3]),o(l,"class","field-upload svelte-41061x"),o(l,"accept",p=s[4]&&s[4].acceptedFiles),o(x,"d","M64 480H448c35.3 0 64-28.7 64-64V160c0-35.3-28.7-64-64-64H288c-10.1 0-19.6-4.7-25.6-12.8L243.2 57.6C231.1 41.5 212.1 32 192 32H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64z"),o(h,"xmlns","http://www.w3.org/2000/svg"),o(h,"height","1rem"),o(h,"viewBox","0 0 512 512"),o(r,"for",s[3]),o(r,"class","field-icon field-icon-upload svelte-41061x"),o(u,"type","button"),o(u,"class","svelte-41061x"),o(y,"class","field-icon preview-button svelte-41061x"),B(y,"hidden",!s[10]),o(e,"class","field-icons svelte-41061x"),o(d,"class",H=J(`field-input ${s[1]=="outside"||!s[0]?"":"field-input-padding"}`)+" svelte-41061x"),o(d,"type","text"),o(d,"name",s[3]),o(d,"id",s[2]),d.disabled=s[9],o(m,"class","field-upload-container svelte-41061x")},m(a,c){w&&w.m(a,c),$(a,t,c),$(a,e,c),z(e,r),z(r,l),s[30](l),z(r,f),z(r,h),z(h,x),z(e,I),z(e,y),z(y,u),z(e,b),v&&v.m(e,null),$(a,n,c),$(a,m,c),z(m,d),W(d,s[14]),T||(Y=[k(l,"change",s[17]),k(l,"focus",s[31]),k(l,"blur",s[32]),k(u,"click",V(s[33])),k(d,"focus",s[35]),k(d,"blur",s[36]),k(d,"change",s[37]),k(d,"input",s[38])],T=!0)},p(a,c){a[0]&&a[1]=="inside"?w?w.p(a,c):(w=K(a),w.c(),w.m(t.parentNode,t)):w&&(w.d(1),w=null),c[0]&8&&o(l,"id",a[3]),c[0]&16&&p!==(p=a[4]&&a[4].acceptedFiles)&&o(l,"accept",p),c[0]&8&&o(r,"for",a[3]),c[0]&1024&&B(y,"hidden",!a[10]),a[5]?v?v.p(a,c):(v=Q(a),v.c(),v.m(e,null)):v&&(v.d(1),v=null),c[0]&3&&H!==(H=J(`field-input ${a[1]=="outside"||!a[0]?"":"field-input-padding"}`)+" svelte-41061x")&&o(d,"class",H),c[0]&8&&o(d,"name",a[3]),c[0]&4&&o(d,"id",a[2]),c[0]&512&&(d.disabled=a[9]),c[0]&16384&&d.value!==a[14]&&W(d,a[14])},d(a){a&&(F(t),F(e),F(n),F(m)),w&&w.d(a),s[30](null),v&&v.d(),T=!1,A(Y)}}}function Le(s){let t,e,r;return{c(){t=g("div"),o(t,"class","drop svelte-41061x")},m(l,p){$(l,t,p),e||(r=[k(t,"dragleave",s[27]),k(t,"dragend",s[28]),k(t,"drop",V(s[29]))],e=!0)},p:j,d(l){l&&F(t),e=!1,A(r)}}}function K(s){let t;return{c(){t=g("span"),o(t,"class","field-label svelte-41061x"),B(t,"move",s[8]||s[5])},m(e,r){$(e,t,r),t.innerHTML=s[15]},p(e,r){r[0]&32768&&(t.innerHTML=e[15]),r[0]&288&&B(t,"move",e[8]||e[5])},d(e){e&&F(t)}}}function Q(s){let t,e,r,l;return{c(){t=g("div"),e=g("button"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="1rem" viewBox="0 0 512 512"><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z"></path></svg>',o(e,"type","button"),o(e,"class","svelte-41061x"),o(t,"class","field-icon svelte-41061x")},m(p,f){$(p,t,f),z(t,e),r||(l=k(e,"click",V(s[34])),r=!0)},p:j,d(p){p&&F(t),r=!1,l()}}}function X(s){let t,e,r,l,p;return{c(){t=g("div"),e=g("img"),o(e,"class","preview svelte-41061x"),o(e,"style",s[6]),U(e.src,r=s[10])||o(e,"src",r),o(e,"alt","preview"),o(t,"class","overlay svelte-41061x")},m(f,h){$(f,t,h),z(t,e),l||(p=[Me(Ie.call(null,e)),k(e,"click_outside",s[41])],l=!0)},p(f,h){h[0]&64&&o(e,"style",f[6]),h[0]&1024&&!U(e.src,r=f[10])&&o(e,"src",r)},d(f){f&&F(t),l=!1,A(p)}}}function Ve(s){let t,e,r,l,p,f,h,x=s[0]&&s[1]=="outside"&&G(s);function I(n,m){return n[12]?Le:Ce}let y=I(s),u=y(s),b=s[11]&&X(s);return{c(){x&&x.c(),t=q(),e=g("div"),r=g("div"),u.c(),l=q(),b&&b.c(),p=Te(),o(r,"class","field svelte-41061x")},m(n,m){x&&x.m(n,m),$(n,t,m),$(n,e,m),z(e,r),u.m(r,null),s[39](r),$(n,l,m),b&&b.m(n,m),$(n,p,m),f||(h=k(r,"dragover",V(s[40])),f=!0)},p(n,m){n[0]&&n[1]=="outside"?x?x.p(n,m):(x=G(n),x.c(),x.m(t.parentNode,t)):x&&(x.d(1),x=null),y===(y=I(n))&&u?u.p(n,m):(u.d(1),u=y(n),u&&(u.c(),u.m(r,null))),n[11]?b?b.p(n,m):(b=X(n),b.c(),b.m(p.parentNode,p)):b&&(b.d(1),b=null)},i:j,o:j,d(n){n&&(F(t),F(e),F(l),F(p)),x&&x.d(n),u.d(),s[39](null),b&&b.d(n),f=!1,h()}}}function je(s){return new Promise((t,e)=>{const r=new FileReader;r.readAsDataURL(s),r.onload=()=>t(r.result),r.onerror=l=>e(l)})}function Be(s,t,e){let r,{label:l=""}=t,{labelType:p="inside"}=t,{attachedInternals:f}=t,{value:h=""}=t,{id:x=""}=t,{name:I=""}=t,{required:y=!1}=t,{displayFormat:u="snake"}=t,{displayFormatFunction:b}=t,n,m,d=!1,H=!1,T="",Y=null,w=!1,v=!1,a,c,L="";const D=He();let{service:C}=t;const ee=()=>a;async function te(i){if(H)try{e(5,a=await C.uploadFile(Y,i))}catch(S){console.error(S)}return a}async function R(i){if(C&&C.maxSize&&i.size>C.maxSize){D("rejected",{file:i.name,code:"maxSize"});return}if(e(9,H=!0),Y=i,e(5,a=i.name),e(14,L=Ye(a,u,b)),Y.type.split("/")[0]==="image"){const S=await je(Y);e(10,T=S)}else e(10,T="")}async function O(i){i.dataTransfer.files.length&&R(i.dataTransfer.files[0]),e(12,v=!1)}async function se(i){R(i.target.files[0])}async function N(){H||((await(await fetch(a)).blob()).type.startsWith("image/")?e(10,T=a):e(10,T=""))}function P(){const i=m.getBoundingClientRect();window.innerHeight-i.bottom<300?e(6,n=`
        width: ${i.width}px;
        bottom: ${window.innerHeight-i.top}px;
        left: ${i.width-300}px;
      `):e(6,n=`
        width: ${i.width}px;
        top: ${i.bottom}px;
        left: ${i.width-300}px;
      `),e(11,w=!w)}const ie=()=>e(12,v=!1),re=()=>e(12,v=!1),ae=i=>O(i);function oe(i){_[i?"unshift":"push"](()=>{c=i,e(13,c)})}const le=()=>e(8,d=!0),ne=()=>e(8,d=!1),de=()=>P(),ce=()=>{e(9,H=!1),e(10,T=""),e(5,a=""),e(13,c.value="",c)},pe=()=>e(8,d=!0),me=()=>e(8,d=!1),xe=()=>N();function ue(){L=this.value,e(14,L)}function be(i){_[i?"unshift":"push"](()=>{m=i,e(7,m)})}const fe=()=>e(12,v=!0),ve=()=>e(11,w=!1);return s.$$set=i=>{"label"in i&&e(0,l=i.label),"labelType"in i&&e(1,p=i.labelType),"attachedInternals"in i&&e(20,f=i.attachedInternals),"value"in i&&e(21,h=i.value),"id"in i&&e(2,x=i.id),"name"in i&&e(3,I=i.name),"required"in i&&e(22,y=i.required),"displayFormat"in i&&e(23,u=i.displayFormat),"displayFormatFunction"in i&&e(24,b=i.displayFormatFunction),"service"in i&&e(4,C=i.service)},s.$$.update=()=>{s.$$.dirty[0]&2097152&&(e(5,a=h),h?N():e(10,T="")),s.$$.dirty[0]&1048608&&(f.checkValidity(),f.setFormValue(a),D("value",{internalValue:a})),s.$$.dirty[0]&4194305&&e(15,r=y?`${l} *`:l)},[l,p,x,I,C,a,n,m,d,H,T,w,v,c,L,r,O,se,N,P,f,h,y,u,b,ee,te,ie,re,ae,oe,le,ne,de,ce,pe,me,xe,ue,be,fe,ve]}class Z extends ke{constructor(t){super(),$e(this,t,Be,Ve,ze,{label:0,labelType:1,attachedInternals:20,value:21,id:2,name:3,required:22,displayFormat:23,displayFormatFunction:24,service:4,getValue:25,save:26},qe,[-1,-1])}get label(){return this.$$.ctx[0]}set label(t){this.$$set({label:t}),M()}get labelType(){return this.$$.ctx[1]}set labelType(t){this.$$set({labelType:t}),M()}get attachedInternals(){return this.$$.ctx[20]}set attachedInternals(t){this.$$set({attachedInternals:t}),M()}get value(){return this.$$.ctx[21]}set value(t){this.$$set({value:t}),M()}get id(){return this.$$.ctx[2]}set id(t){this.$$set({id:t}),M()}get name(){return this.$$.ctx[3]}set name(t){this.$$set({name:t}),M()}get required(){return this.$$.ctx[22]}set required(t){this.$$set({required:t}),M()}get displayFormat(){return this.$$.ctx[23]}set displayFormat(t){this.$$set({displayFormat:t}),M()}get displayFormatFunction(){return this.$$.ctx[24]}set displayFormatFunction(t){this.$$set({displayFormatFunction:t}),M()}get service(){return this.$$.ctx[4]}set service(t){this.$$set({service:t}),M()}get getValue(){return this.$$.ctx[25]}get save(){return this.$$.ctx[26]}}try{customElements.define("jp-file-upload",ye(Z,{label:{},labelType:{},attachedInternals:{},value:{},id:{},name:{},required:{type:"Boolean"},displayFormat:{},displayFormatFunction:{},service:{}},[],["getValue","save"],!1,s=>{var t;return t=class extends s{constructor(){super(),this.attachedInternals=this.attachInternals()}},ge(t,"formAssociated",!0),t}));}catch{};export{Z as default};
//# sourceMappingURL=file-upload.wc.js.map
