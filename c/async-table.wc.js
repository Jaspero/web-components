import{c as fe,S as he,i as ke,f as E,s as we,a as ve,e as x,b as O,d as f,m as P,g as $,h as j,o as T,n as L,j as S,k as xe,x as ze,t as U,p as N,q as F,r as ye,l as $e,y as _,u as Se,v as Q,w as Ce}from"./svelte.js";import"./index2.js";import{g as je}from"./json-pointer.js";function Me(s){ve(s,"svelte-iiknzs",".table-card.svelte-iiknzs{background-color:var(--background-primary);-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem;-webkit-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16);-moz-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16);box-shadow:0 3px 12px rgba(0, 0, 0, 0.16)}.table-container.svelte-iiknzs{overflow-x:auto;width:100%}table.svelte-iiknzs{width:100%}th.svelte-iiknzs,td.svelte-iiknzs{text-align:left;white-space:nowrap;font-size:0.75rem;font-weight:normal;padding:0.5rem;border-bottom:1px solid rgba(0, 0, 0, 0.16)}th.svelte-iiknzs{opacity:0.75}.sortable.svelte-iiknzs{cursor:pointer}.draggable-column.svelte-iiknzs{cursor:grab}.cell.svelte-iiknzs{display:block;max-width:64ch;overflow:hidden;text-overflow:ellipsis}.table-actions.svelte-iiknzs{padding:1rem;display:flex;justify-content:space-between}.table-header.svelte-iiknzs{padding:1rem;min-height:68px;display:flex;justify-content:flex-end}.table-button.svelte-iiknzs{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem;min-width:4rem;height:2.25rem;padding:0 1rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.settings-button.svelte-iiknzs{background-color:var(--background-secondary);color:var(--text-on-secondary)}.load-button.svelte-iiknzs{background-color:var(--primary-color);color:var(--text-on-primary)}.load-button.svelte-iiknzs:disabled{opacity:0.5}.load-button.loading.svelte-iiknzs{pointer-events:none}.highlight.svelte-iiknzs{cursor:pointer;transition:0.3s}.highlight.svelte-iiknzs:hover{background-color:#ddd}.spinner.svelte-iiknzs{display:block;border-top:2px solid var(--text-on-primary);border-bottom:2px solid var(--text-on-primary);border-left:2px solid transparent;border-right:2px solid transparent;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;width:1rem;height:1rem;margin-right:0.5rem;-webkit-animation:svelte-iiknzs-spin 1s linear infinite;-moz-animation:svelte-iiknzs-spin 1s linear infinite;-o-animation:svelte-iiknzs-spin 1s linear infinite;animation:svelte-iiknzs-spin 1s linear infinite}@-webkit-keyframes svelte-iiknzs-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes svelte-iiknzs-spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes svelte-iiknzs-spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes svelte-iiknzs-spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}")}function V(s,t,e){const r=s.slice();return r[31]=t[e],r[33]=e,r}function W(s,t,e){const r=s.slice();return r[34]=t[e],r}function X(s,t,e){const r=s.slice();return r[34]=t[e],r[33]=e,r}function Y(s){let t,e=s[4]&&Z(s);return{c(){t=x("div"),e&&e.c(),f(t,"class","table-header svelte-iiknzs")},m(r,n){$(r,t,n),e&&e.m(t,null)},p(r,n){r[4]?e?e.p(r,n):(e=Z(r),e.c(),e.m(t,null)):e&&(e.d(1),e=null)},d(r){r&&S(t),e&&e.d()}}}function Z(s){let t,e,r,n;return{c(){t=U(`\xA0
        `),e=x("button"),e.textContent="Export",f(e,"type","button"),f(e,"class","table-button settings-button svelte-iiknzs"),P(e,"loading",s[9])},m(a,o){$(a,t,o),$(a,e,o),r||(n=T(e,"click",s[17]),r=!0)},p(a,o){o[0]&512&&P(e,"loading",a[9])},d(a){a&&(S(t),S(e)),r=!1,n()}}}function ee(s){let t,e=N(s[10]),r=[];for(let n=0;n<e.length;n+=1)r[n]=re(X(s,e,n));return{c(){t=x("tr");for(let n=0;n<r.length;n+=1)r[n].c()},m(n,a){$(n,t,a);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(t,null)},p(n,a){if(a[0]&271370){e=N(n[10]);let o;for(o=0;o<e.length;o+=1){const l=X(n,e,o);r[o]?r[o].p(l,a):(r[o]=re(l),r[o].c(),r[o].m(t,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=e.length}},d(n){n&&S(t),F(r,n)}}}function te(s){let t,e=s[1].direction==="asc"?"\u2191":"\u2193",r;return{c(){t=x("span"),r=U(e)},m(n,a){$(n,t,a),j(t,r)},p(n,a){a[0]&2&&e!==(e=n[1].direction==="asc"?"\u2191":"\u2193")&&Se(r,e)},d(n){n&&S(t)}}}function re(s){var t;let e,r,n=s[34].label+"",a,o,l,c;function k(...p){return s[25](s[34],...p)}let u=((t=s[1])==null?void 0:t.key)===s[34].key&&te(s);function D(){return s[26](s[34])}function w(...p){return s[27](s[33],...p)}return{c(){e=x("th"),r=x("span"),a=O(),u&&u.c(),o=O(),f(r,"class","draggable-column svelte-iiknzs"),f(r,"draggable",s[3]),f(r,"tabindex","-1"),f(r,"role","button"),f(r,"aria-label","Drag handle"),f(e,"class","svelte-iiknzs"),P(e,"sortable",s[3]&&s[34].sortable)},m(p,d){$(p,e,d),j(e,r),r.innerHTML=n,j(e,a),u&&u.m(e,null),j(e,o),l||(c=[T(r,"dragstart",k),T(e,"click",D),T(e,"drop",w),T(e,"dragover",Oe)],l=!0)},p(p,d){var m;s=p,d[0]&1024&&n!==(n=s[34].label+"")&&(r.innerHTML=n),d[0]&8&&f(r,"draggable",s[3]),((m=s[1])==null?void 0:m.key)===s[34].key?u?u.p(s,d):(u=te(s),u.c(),u.m(e,o)):u&&(u.d(1),u=null),d[0]&1032&&P(e,"sortable",s[3]&&s[34].sortable)},d(p){p&&S(e),u&&u.d(),l=!1,ye(c)}}}function se(s){let t,e=N(s[2]),r=[];for(let n=0;n<e.length;n+=1)r[n]=ae(V(s,e,n));return{c(){for(let n=0;n<r.length;n+=1)r[n].c();t=$e()},m(n,a){for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(n,a);$(n,t,a)},p(n,a){if(a[0]&37924){e=N(n[2]);let o;for(o=0;o<e.length;o+=1){const l=V(n,e,o);r[o]?r[o].p(l,a):(r[o]=ae(l),r[o].c(),r[o].m(t.parentNode,t))}for(;o<r.length;o+=1)r[o].d(1);r.length=e.length}},d(n){n&&S(t),F(r,n)}}}function Re(s){return{c:L,m:L,p:L,d:L}}function Ae(s){let t,e=s[37]+"";return{c(){t=x("span"),f(t,"class","cell svelte-iiknzs")},m(r,n){$(r,t,n),t.innerHTML=e},p(r,n){n[0]&1028&&e!==(e=r[37]+"")&&(t.innerHTML=e)},d(r){r&&S(t)}}}function De(s){return{c:L,m:L,p:L,d:L}}function ne(s){let t,e,r,n,a={ctx:s,current:null,token:null,hasCatch:!1,pending:De,then:Ae,catch:Re,value:37};Q(e=s[12](s[34],s[31],s[33]),a);function o(...l){return s[28](s[31],s[33],s[34],...l)}return{c(){t=x("td"),a.block.c(),f(t,"class","svelte-iiknzs")},m(l,c){$(l,t,c),a.block.m(t,a.anchor=null),a.mount=()=>t,a.anchor=null,r||(n=T(t,"click",o),r=!0)},p(l,c){s=l,a.ctx=s,c[0]&1028&&e!==(e=s[12](s[34],s[31],s[33]))&&Q(e,a)||Ce(a,s,c)},d(l){l&&S(t),a.block.d(),a.token=null,a=null,r=!1,n()}}}function ae(s){let t,e,r=N(s[10]),n=[];for(let a=0;a<r.length;a+=1)n[a]=ne(W(s,r,a));return{c(){t=x("tr");for(let a=0;a<n.length;a+=1)n[a].c();e=O(),f(t,"class","svelte-iiknzs"),P(t,"highlight",s[5])},m(a,o){$(a,t,o);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(t,null);j(t,e)},p(a,o){if(o[0]&37892){r=N(a[10]);let l;for(l=0;l<r.length;l+=1){const c=W(a,r,l);n[l]?n[l].p(c,o):(n[l]=ne(c),n[l].c(),n[l].m(t,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=r.length}o[0]&32&&P(t,"highlight",a[5])},d(a){a&&S(t),F(n,a)}}}function Ee(s){let t;return{c(){t=U("Load More")},m(e,r){$(e,t,r)},d(e){e&&S(t)}}}function Le(s){let t,e;return{c(){t=x("span"),e=U(`
        Loading`),f(t,"class","spinner svelte-iiknzs")},m(r,n){$(r,t,n),$(r,e,n)},d(r){r&&(S(t),S(e))}}}function ie(s){let t,e,r;return{c(){t=x("jp-select"),_(t,"label","Page Size"),_(t,"options",s[11]),_(t,"value",s[0])},m(n,a){$(n,t,a),e||(r=T(t,"value",s[16]),e=!0)},p(n,a){a[0]&1&&_(t,"value",n[0])},d(n){n&&S(t),e=!1,r()}}}function Pe(s){let t,e,r,n,a,o,l,c,k,u,D,w,p=s[4]&&Y(s),d=s[10]&&ee(s),m=s[2]&&se(s);function B(g,R){return g[7]?Le:Ee}let M=B(s),z=M(s),v=s[6].length>1&&ie(s);return{c(){t=x("div"),p&&p.c(),e=O(),r=x("div"),n=x("table"),d&&d.c(),a=O(),m&&m.c(),o=O(),l=x("div"),c=x("button"),z.c(),u=O(),v&&v.c(),f(n,"class","svelte-iiknzs"),f(r,"class","table-container svelte-iiknzs"),f(c,"type","button"),f(c,"class","table-button load-button svelte-iiknzs"),c.disabled=k=!s[8],P(c,"loading",s[7]),f(l,"class","table-actions svelte-iiknzs"),f(t,"class","table-card svelte-iiknzs")},m(g,R){$(g,t,R),p&&p.m(t,null),j(t,e),j(t,r),j(r,n),d&&d.m(n,null),j(n,a),m&&m.m(n,null),j(t,o),j(t,l),j(l,c),z.m(c,null),j(l,u),v&&v.m(l,null),D||(w=T(c,"click",s[14]),D=!0)},p(g,R){g[4]?p?p.p(g,R):(p=Y(g),p.c(),p.m(t,e)):p&&(p.d(1),p=null),g[10]?d?d.p(g,R):(d=ee(g),d.c(),d.m(n,a)):d&&(d.d(1),d=null),g[2]?m?m.p(g,R):(m=se(g),m.c(),m.m(n,null)):m&&(m.d(1),m=null),M!==(M=B(g))&&(z.d(1),z=M(g),z&&(z.c(),z.m(c,null))),R[0]&256&&k!==(k=!g[8])&&(c.disabled=k),R[0]&128&&P(c,"loading",g[7]),g[6].length>1?v?v.p(g,R):(v=ie(g),v.c(),v.m(l,null)):v&&(v.d(1),v=null)},i:L,o:L,d(g){g&&S(t),p&&p.d(),d&&d.d(),m&&m.d(),z.d(),v&&v.d(),D=!1,w()}}}function Te(s,t){s.dataTransfer.setData("text/plain",t.key)}function Oe(s){s.preventDefault()}function Be(s,t,e){let{allowArrangeColumns:r=!0}=t,{showExport:n=!0}=t,{rowClickable:a=!1}=t,{headers:o=[]}=t,{pageSizes:l=[10,25,50,100]}=t,{pageSize:c=l[0]}=t,{sort:k}=t,{service:u}=t,{getData:D=async()=>{const i=await u.get(k,c);e(2,w=i.rows),e(8,m=i.hasMore),e(7,d=!1)}}=t,{rows:w=[]}=t,p=JSON.stringify(l.map(i=>({label:i,value:i}))),d=!0,m=!1,B=!1,M,z=[];const v=xe();async function g(i,b="id"){e(2,w=w.filter(h=>h[b]!==i))}async function R(i){e(2,w=[...w,i])}async function le(i,b){e(2,w=w.map((h,C)=>C===b?{...h,...i}:h))}async function I(i,b,h){const{key:C,fallback:A,pipes:H}=i;let y;try{y=je(b,C)}catch{return A||""}if(!H)return y;for(const q of H)y=await q(y,b,h);return y}async function J(i){const{sortable:b}=i;if(!b)return;e(7,d=!0),e(1,k={key:i.key,direction:k?.key===i.key&&k.direction==="asc"?"desc":"asc"});const[h]=await Promise.all([u.get(k,c),u.adjustSort(k)]);e(2,w=h.rows),e(8,m=h.hasMore),e(7,d=!1)}async function ce(){e(7,d=!0);const i=await u.loadMore(k,c);e(2,w=[...w,...i.rows]),e(8,m=i.hasMore),e(7,d=!1)}function G(i,b,h,C){v("rowClick",{row:i,index:b,header:h,originalEvent:C})}async function de(i){e(0,c=i.detail),await Promise.all([D(),u.adjustPageSize(c)])}async function ue(){e(9,B=!0);const i=await u.export(),b=await Promise.all(i.map(async(A,H)=>(await Promise.all(M.map(y=>I({key:y.key,fallback:y.exportFallback||y.fallback,pipes:y.exportPipes||y.pipes||[]},A,H)))).map(y=>`"${y||""}"`).join(","))),h=new Blob([[M.map(A=>A.label).map(A=>`"${A}"`).join(","),...b].join(`
`)],{type:"text/csv"}),C=document.createElement("a");C.href=URL.createObjectURL(h),C.download="export.csv",C.click(),e(9,B=!1)}function K(i,b){i.preventDefault();const h=i.dataTransfer.getData("text/plain"),C=z.indexOf(h);C!==-1&&Number.isInteger(b)&&(z.splice(C,1),z.splice(Number(b),0,h),e(10,M=o.filter(A=>!A.disabled).sort((A,H)=>{const y=z.indexOf(A.key),q=z.indexOf(H.key);return y-q})))}ze(async()=>{z=M.map(i=>i.key),await D()});const pe=(i,b)=>Te(b,i),ge=i=>J(i),me=(i,b)=>K(b,i),be=(i,b,h,C)=>G(i,b,h,C);return s.$$set=i=>{"allowArrangeColumns"in i&&e(3,r=i.allowArrangeColumns),"showExport"in i&&e(4,n=i.showExport),"rowClickable"in i&&e(5,a=i.rowClickable),"headers"in i&&e(19,o=i.headers),"pageSizes"in i&&e(6,l=i.pageSizes),"pageSize"in i&&e(0,c=i.pageSize),"sort"in i&&e(1,k=i.sort),"service"in i&&e(20,u=i.service),"getData"in i&&e(21,D=i.getData),"rows"in i&&e(2,w=i.rows)},s.$$.update=()=>{s.$$.dirty[0]&524288&&e(10,M=o.filter(i=>!i.disabled))},[c,k,w,r,n,a,l,d,m,B,M,p,I,J,ce,G,de,ue,K,o,u,D,g,R,le,pe,ge,me,be]}class oe extends he{constructor(t){super(),ke(this,t,Be,Pe,we,{allowArrangeColumns:3,showExport:4,rowClickable:5,headers:19,pageSizes:6,pageSize:0,sort:1,service:20,getData:21,rows:2,removeRow:22,addRow:23,updateRow:24},Me,[-1,-1])}get allowArrangeColumns(){return this.$$.ctx[3]}set allowArrangeColumns(t){this.$$set({allowArrangeColumns:t}),E()}get showExport(){return this.$$.ctx[4]}set showExport(t){this.$$set({showExport:t}),E()}get rowClickable(){return this.$$.ctx[5]}set rowClickable(t){this.$$set({rowClickable:t}),E()}get headers(){return this.$$.ctx[19]}set headers(t){this.$$set({headers:t}),E()}get pageSizes(){return this.$$.ctx[6]}set pageSizes(t){this.$$set({pageSizes:t}),E()}get pageSize(){return this.$$.ctx[0]}set pageSize(t){this.$$set({pageSize:t}),E()}get sort(){return this.$$.ctx[1]}set sort(t){this.$$set({sort:t}),E()}get service(){return this.$$.ctx[20]}set service(t){this.$$set({service:t}),E()}get getData(){return this.$$.ctx[21]}set getData(t){this.$$set({getData:t}),E()}get rows(){return this.$$.ctx[2]}set rows(t){this.$$set({rows:t}),E()}get removeRow(){return this.$$.ctx[22]}get addRow(){return this.$$.ctx[23]}get updateRow(){return this.$$.ctx[24]}}try{customElements.define("jp-async-table",fe(oe,{allowArrangeColumns:{type:"Boolean"},showExport:{type:"Boolean"},rowClickable:{type:"Boolean"},headers:{},pageSizes:{},pageSize:{},sort:{},service:{},getData:{},rows:{}},[],["removeRow","addRow","updateRow"],!1));}catch{};export{oe as default};
