import{c as be,S as fe,i as he,f as P,s as ke,a as ve,e as v,b as O,d as b,m as M,g as w,h as S,o as H,n as L,j as y,k as xe,x as ze,t as U,p as R,q as F,r as we,l as ye,y as _,u as $e,v as K,w as Se}from"./svelte.js";import"./index2.js";import{g as je}from"./json-pointer.js";function Ce(i){ve(i,"svelte-iiknzs",".table-card.svelte-iiknzs{background-color:var(--background-primary);-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem;-webkit-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16);-moz-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16);box-shadow:0 3px 12px rgba(0, 0, 0, 0.16)}.table-container.svelte-iiknzs{overflow-x:auto;width:100%}table.svelte-iiknzs{width:100%}th.svelte-iiknzs,td.svelte-iiknzs{text-align:left;white-space:nowrap;font-size:0.75rem;font-weight:normal;padding:0.5rem;border-bottom:1px solid rgba(0, 0, 0, 0.16)}th.svelte-iiknzs{opacity:0.75}.sortable.svelte-iiknzs{cursor:pointer}.draggable-column.svelte-iiknzs{cursor:grab}.cell.svelte-iiknzs{display:block;max-width:64ch;overflow:hidden;text-overflow:ellipsis}.table-actions.svelte-iiknzs{padding:1rem;display:flex;justify-content:space-between}.table-header.svelte-iiknzs{padding:1rem;min-height:68px;display:flex;justify-content:flex-end}.table-button.svelte-iiknzs{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem;min-width:4rem;height:2.25rem;padding:0 1rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.settings-button.svelte-iiknzs{background-color:var(--background-secondary);color:var(--text-on-secondary)}.load-button.svelte-iiknzs{background-color:var(--primary-color);color:var(--text-on-primary)}.load-button.svelte-iiknzs:disabled{opacity:0.5}.load-button.loading.svelte-iiknzs{pointer-events:none}.highlight.svelte-iiknzs{cursor:pointer;transition:0.3s}.highlight.svelte-iiknzs:hover{background-color:#ddd}.spinner.svelte-iiknzs{display:block;border-top:2px solid var(--text-on-primary);border-bottom:2px solid var(--text-on-primary);border-left:2px solid transparent;border-right:2px solid transparent;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;width:1rem;height:1rem;margin-right:0.5rem;-webkit-animation:svelte-iiknzs-spin 1s linear infinite;-moz-animation:svelte-iiknzs-spin 1s linear infinite;-o-animation:svelte-iiknzs-spin 1s linear infinite;animation:svelte-iiknzs-spin 1s linear infinite}@-webkit-keyframes svelte-iiknzs-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes svelte-iiknzs-spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes svelte-iiknzs-spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes svelte-iiknzs-spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}")}function Q(i,t,e){const r=i.slice();return r[31]=t[e],r[33]=e,r}function V(i,t,e){const r=i.slice();return r[34]=t[e],r}function W(i,t,e){const r=i.slice();return r[34]=t[e],r[33]=e,r}function X(i){let t,e=i[3]&&Y(i);return{c(){t=v("div"),e&&e.c(),b(t,"class","table-header svelte-iiknzs")},m(r,s){w(r,t,s),e&&e.m(t,null)},p(r,s){r[3]?e?e.p(r,s):(e=Y(r),e.c(),e.m(t,null)):e&&(e.d(1),e=null)},d(r){r&&y(t),e&&e.d()}}}function Y(i){let t,e,r,s;return{c(){t=U(`\xA0
        `),e=v("button"),e.textContent="Export",b(e,"type","button"),b(e,"class","table-button settings-button svelte-iiknzs"),M(e,"loading",i[9])},m(n,o){w(n,t,o),w(n,e,o),r||(s=H(e,"click",i[17]),r=!0)},p(n,o){o[0]&512&&M(e,"loading",n[9])},d(n){n&&(y(t),y(e)),r=!1,s()}}}function Z(i){let t,e=R(i[10]),r=[];for(let s=0;s<e.length;s+=1)r[s]=te(W(i,e,s));return{c(){t=v("tr");for(let s=0;s<r.length;s+=1)r[s].c()},m(s,n){w(s,t,n);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(t,null)},p(s,n){if(n[0]&1844230){e=R(s[10]);let o;for(o=0;o<e.length;o+=1){const l=W(s,e,o);r[o]?r[o].p(l,n):(r[o]=te(l),r[o].c(),r[o].m(t,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=e.length}},d(s){s&&y(t),F(r,s)}}}function ee(i){let t,e=i[1].direction==="asc"?"\u2191":"\u2193",r;return{c(){t=v("span"),r=U(e)},m(s,n){w(s,t,n),S(t,r)},p(s,n){n[0]&2&&e!==(e=s[1].direction==="asc"?"\u2191":"\u2193")&&$e(r,e)},d(s){s&&y(t)}}}function te(i){var t;let e,r,s=i[34].label+"",n,o,l,d;function h(...c){return i[24](i[34],...c)}let u=((t=i[1])==null?void 0:t.key)===i[34].key&&ee(i);function A(){return i[25](i[34])}function T(...c){return i[26](i[33],...c)}return{c(){e=v("th"),r=v("span"),n=O(),u&&u.c(),o=O(),b(r,"class","draggable-column svelte-iiknzs"),b(r,"draggable",i[2]),b(r,"tabindex","-1"),b(r,"role","button"),b(r,"aria-label","Drag handle"),b(e,"class","svelte-iiknzs"),M(e,"sortable",i[2]&&i[34].sortable)},m(c,g){w(c,e,g),S(e,r),r.innerHTML=s,S(e,n),u&&u.m(e,null),S(e,o),l||(d=[H(r,"dragstart",h),H(e,"click",A),H(e,"drop",T),H(e,"dragover",i[19])],l=!0)},p(c,g){var m;i=c,g[0]&1024&&s!==(s=i[34].label+"")&&(r.innerHTML=s),g[0]&4&&b(r,"draggable",i[2]),((m=i[1])==null?void 0:m.key)===i[34].key?u?u.p(i,g):(u=ee(i),u.c(),u.m(e,o)):u&&(u.d(1),u=null),g[0]&1028&&M(e,"sortable",i[2]&&i[34].sortable)},d(c){c&&y(e),u&&u.d(),l=!1,we(d)}}}function re(i){let t,e=R(i[8]),r=[];for(let s=0;s<e.length;s+=1)r[s]=ie(Q(i,e,s));return{c(){for(let s=0;s<r.length;s+=1)r[s].c();t=ye()},m(s,n){for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(s,n);w(s,t,n)},p(s,n){if(n[0]&38160){e=R(s[8]);let o;for(o=0;o<e.length;o+=1){const l=Q(s,e,o);r[o]?r[o].p(l,n):(r[o]=ie(l),r[o].c(),r[o].m(t.parentNode,t))}for(;o<r.length;o+=1)r[o].d(1);r.length=e.length}},d(s){s&&y(t),F(r,s)}}}function De(i){return{c:L,m:L,p:L,d:L}}function Ee(i){let t,e=i[37]+"";return{c(){t=v("span"),b(t,"class","cell svelte-iiknzs")},m(r,s){w(r,t,s),t.innerHTML=e},p(r,s){s[0]&1280&&e!==(e=r[37]+"")&&(t.innerHTML=e)},d(r){r&&y(t)}}}function Ae(i){return{c:L,m:L,p:L,d:L}}function se(i){let t,e,r,s,n={ctx:i,current:null,token:null,hasCatch:!1,pending:Ae,then:Ee,catch:De,value:37};K(e=i[12](i[34],i[31],i[33]),n);function o(...l){return i[27](i[31],i[33],i[34],...l)}return{c(){t=v("td"),n.block.c(),b(t,"class","svelte-iiknzs")},m(l,d){w(l,t,d),n.block.m(t,n.anchor=null),n.mount=()=>t,n.anchor=null,r||(s=H(t,"click",o),r=!0)},p(l,d){i=l,n.ctx=i,d[0]&1280&&e!==(e=i[12](i[34],i[31],i[33]))&&K(e,n)||Se(n,i,d)},d(l){l&&y(t),n.block.d(),n.token=null,n=null,r=!1,s()}}}function ie(i){let t,e,r=R(i[10]),s=[];for(let n=0;n<r.length;n+=1)s[n]=se(V(i,r,n));return{c(){t=v("tr");for(let n=0;n<s.length;n+=1)s[n].c();e=O(),b(t,"class","svelte-iiknzs"),M(t,"highlight",i[4])},m(n,o){w(n,t,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(t,null);S(t,e)},p(n,o){if(o[0]&38144){r=R(n[10]);let l;for(l=0;l<r.length;l+=1){const d=V(n,r,l);s[l]?s[l].p(d,o):(s[l]=se(d),s[l].c(),s[l].m(t,e))}for(;l<s.length;l+=1)s[l].d(1);s.length=r.length}o[0]&16&&M(t,"highlight",n[4])},d(n){n&&y(t),F(s,n)}}}function Le(i){let t;return{c(){t=U("Load More")},m(e,r){w(e,t,r)},d(e){e&&y(t)}}}function Pe(i){let t,e;return{c(){t=v("span"),e=U(`
        Loading`),b(t,"class","spinner svelte-iiknzs")},m(r,s){w(r,t,s),w(r,e,s)},d(r){r&&(y(t),y(e))}}}function ne(i){let t,e,r;return{c(){t=v("jp-select"),_(t,"label","Page Size"),_(t,"options",i[11]),_(t,"value",i[0])},m(s,n){w(s,t,n),e||(r=H(t,"value",i[16]),e=!0)},p(s,n){n[0]&1&&_(t,"value",s[0])},d(s){s&&y(t),e=!1,r()}}}function Me(i){let t,e,r,s,n,o,l,d,h,u,A,T,c=i[3]&&X(i),g=i[10]&&Z(i),m=i[8]&&re(i);function N(p,j){return p[6]?Pe:Le}let D=N(i),x=D(i),k=i[5].length>1&&ne(i);return{c(){t=v("div"),c&&c.c(),e=O(),r=v("div"),s=v("table"),g&&g.c(),n=O(),m&&m.c(),o=O(),l=v("div"),d=v("button"),x.c(),u=O(),k&&k.c(),b(s,"class","svelte-iiknzs"),b(r,"class","table-container svelte-iiknzs"),b(d,"type","button"),b(d,"class","table-button load-button svelte-iiknzs"),d.disabled=h=!i[7],M(d,"loading",i[6]),b(l,"class","table-actions svelte-iiknzs"),b(t,"class","table-card svelte-iiknzs")},m(p,j){w(p,t,j),c&&c.m(t,null),S(t,e),S(t,r),S(r,s),g&&g.m(s,null),S(s,n),m&&m.m(s,null),S(t,o),S(t,l),S(l,d),x.m(d,null),S(l,u),k&&k.m(l,null),A||(T=H(d,"click",i[14]),A=!0)},p(p,j){p[3]?c?c.p(p,j):(c=X(p),c.c(),c.m(t,e)):c&&(c.d(1),c=null),p[10]?g?g.p(p,j):(g=Z(p),g.c(),g.m(s,n)):g&&(g.d(1),g=null),p[8]?m?m.p(p,j):(m=re(p),m.c(),m.m(s,null)):m&&(m.d(1),m=null),D!==(D=N(p))&&(x.d(1),x=D(p),x&&(x.c(),x.m(d,null))),j[0]&128&&h!==(h=!p[7])&&(d.disabled=h),j[0]&64&&M(d,"loading",p[6]),p[5].length>1?k?k.p(p,j):(k=ne(p),k.c(),k.m(l,null)):k&&(k.d(1),k=null)},i:L,o:L,d(p){p&&y(t),c&&c.d(),g&&g.d(),m&&m.d(),x.d(),k&&k.d(),A=!1,T()}}}function He(i,t,e){let{allowArrangeColumns:r=!0}=t,{showExport:s=!0}=t,{rowClickable:n=!1}=t,{headers:o=[]}=t,{pageSizes:l=[10,25,50,100]}=t,{pageSize:d=l[0]}=t,{sort:h}=t,{service:u}=t,{getData:A=async()=>{const a=await u.get(h,d);e(8,m=a.rows),e(7,g=a.hasMore),e(6,c=!1)}}=t,T=JSON.stringify(l.map(a=>({label:a,value:a}))),c=!0,g=!1,m=[],N=!1,D,x=[];const k=xe();async function p(a,f,$){const{key:C,fallback:E,pipes:B}=a;let z;try{z=je(f,C)}catch{return E||""}if(!B)return z;for(const q of B)z=await q(z,f,$);return z}async function j(a){const{sortable:f}=a;if(!f)return;e(6,c=!0),e(1,h={key:a.key,direction:h?.key===a.key&&h.direction==="asc"?"desc":"asc"});const[$]=await Promise.all([u.get(h,d),u.adjustSort(h)]);e(8,m=$.rows),e(7,g=$.hasMore),e(6,c=!1)}async function ae(){e(6,c=!0);const a=await u.loadMore(h,d);e(8,m=[...m,...a.rows]),e(7,g=a.hasMore),e(6,c=!1)}function I(a,f,$,C){k("rowClick",{row:a,index:f,header:$,originalEvent:C})}async function le(a){e(0,d=a.detail),await Promise.all([A(),u.adjustPageSize(d)])}async function ce(){e(9,N=!0);const a=await u.export(),f=await Promise.all(a.map(async(E,B)=>(await Promise.all(D.map(z=>p({key:z.key,fallback:z.exportFallback||z.fallback,pipes:z.exportPipes||z.pipes||[]},E,B)))).map(z=>`"${z||""}"`).join(","))),$=new Blob([[D.map(E=>E.label).map(E=>`"${E}"`).join(","),...f].join(`
`)],{type:"text/csv"}),C=document.createElement("a");C.href=URL.createObjectURL($),C.download="export.csv",C.click(),e(9,N=!1)}function J(a,f){a.dataTransfer.setData("text/plain",f.key)}function de(a){a.preventDefault()}function G(a,f){a.preventDefault();const $=a.dataTransfer.getData("text/plain"),C=x.indexOf($);C!==-1&&Number.isInteger(f)&&(x.splice(C,1),x.splice(Number(f),0,$),e(10,D=o.filter(E=>!E.disabled).sort((E,B)=>{const z=x.indexOf(E.key),q=x.indexOf(B.key);return z-q})))}ze(async()=>{x=D.map(a=>a.key),await A()});const ue=(a,f)=>J(f,a),ge=a=>j(a),pe=(a,f)=>G(f,a),me=(a,f,$,C)=>I(a,f,$,C);return i.$$set=a=>{"allowArrangeColumns"in a&&e(2,r=a.allowArrangeColumns),"showExport"in a&&e(3,s=a.showExport),"rowClickable"in a&&e(4,n=a.rowClickable),"headers"in a&&e(21,o=a.headers),"pageSizes"in a&&e(5,l=a.pageSizes),"pageSize"in a&&e(0,d=a.pageSize),"sort"in a&&e(1,h=a.sort),"service"in a&&e(22,u=a.service),"getData"in a&&e(23,A=a.getData)},i.$$.update=()=>{i.$$.dirty[0]&2097152&&e(10,D=o.filter(a=>!a.disabled))},[d,h,r,s,n,l,c,g,m,N,D,T,p,j,ae,I,le,ce,J,de,G,o,u,A,ue,ge,pe,me]}class oe extends fe{constructor(t){super(),he(this,t,He,Me,ke,{allowArrangeColumns:2,showExport:3,rowClickable:4,headers:21,pageSizes:5,pageSize:0,sort:1,service:22,getData:23},Ce,[-1,-1])}get allowArrangeColumns(){return this.$$.ctx[2]}set allowArrangeColumns(t){this.$$set({allowArrangeColumns:t}),P()}get showExport(){return this.$$.ctx[3]}set showExport(t){this.$$set({showExport:t}),P()}get rowClickable(){return this.$$.ctx[4]}set rowClickable(t){this.$$set({rowClickable:t}),P()}get headers(){return this.$$.ctx[21]}set headers(t){this.$$set({headers:t}),P()}get pageSizes(){return this.$$.ctx[5]}set pageSizes(t){this.$$set({pageSizes:t}),P()}get pageSize(){return this.$$.ctx[0]}set pageSize(t){this.$$set({pageSize:t}),P()}get sort(){return this.$$.ctx[1]}set sort(t){this.$$set({sort:t}),P()}get service(){return this.$$.ctx[22]}set service(t){this.$$set({service:t}),P()}get getData(){return this.$$.ctx[23]}set getData(t){this.$$set({getData:t}),P()}}try{customElements.define("jp-async-table",be(oe,{allowArrangeColumns:{type:"Boolean"},showExport:{type:"Boolean"},rowClickable:{type:"Boolean"},headers:{},pageSizes:{},pageSize:{},sort:{},service:{},getData:{}},[],[],!1));}catch{};export{oe as default};
