import{c as pe,S as me,i as be,f as L,s as fe,a as he,e as v,b as O,d as b,m as P,g as w,h as S,o as H,n as E,j as y,k as ke,x as ve,t as U,p as R,q as F,r as xe,l as ze,y as _,u as we,v as G,w as ye}from"./svelte.js";import"./index2.js";import{g as $e}from"./json-pointer.js";function Se(r){he(r,"svelte-iiknzs",".table-card.svelte-iiknzs{background-color:var(--background-primary);-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem;-webkit-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16);-moz-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16);box-shadow:0 3px 12px rgba(0, 0, 0, 0.16)}.table-container.svelte-iiknzs{overflow-x:auto;width:100%}table.svelte-iiknzs{width:100%}th.svelte-iiknzs,td.svelte-iiknzs{text-align:left;white-space:nowrap;font-size:0.75rem;font-weight:normal;padding:0.5rem;border-bottom:1px solid rgba(0, 0, 0, 0.16)}th.svelte-iiknzs{opacity:0.75}.sortable.svelte-iiknzs{cursor:pointer}.draggable-column.svelte-iiknzs{cursor:grab}.cell.svelte-iiknzs{display:block;max-width:64ch;overflow:hidden;text-overflow:ellipsis}.table-actions.svelte-iiknzs{padding:1rem;display:flex;justify-content:space-between}.table-header.svelte-iiknzs{padding:1rem;min-height:68px;display:flex;justify-content:flex-end}.table-button.svelte-iiknzs{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem;min-width:4rem;height:2.25rem;padding:0 1rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.settings-button.svelte-iiknzs{background-color:var(--background-secondary);color:var(--text-on-secondary)}.load-button.svelte-iiknzs{background-color:var(--primary-color);color:var(--text-on-primary)}.load-button.svelte-iiknzs:disabled{opacity:0.5}.load-button.loading.svelte-iiknzs{pointer-events:none}.highlight.svelte-iiknzs{cursor:pointer;transition:0.3s}.highlight.svelte-iiknzs:hover{background-color:#ddd}.spinner.svelte-iiknzs{display:block;border-top:2px solid var(--text-on-primary);border-bottom:2px solid var(--text-on-primary);border-left:2px solid transparent;border-right:2px solid transparent;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;width:1rem;height:1rem;margin-right:0.5rem;-webkit-animation:svelte-iiknzs-spin 1s linear infinite;-moz-animation:svelte-iiknzs-spin 1s linear infinite;-o-animation:svelte-iiknzs-spin 1s linear infinite;animation:svelte-iiknzs-spin 1s linear infinite}@-webkit-keyframes svelte-iiknzs-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes svelte-iiknzs-spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes svelte-iiknzs-spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes svelte-iiknzs-spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}")}function K(r,t,e){const n=r.slice();return n[28]=t[e],n[30]=e,n}function Q(r,t,e){const n=r.slice();return n[31]=t[e],n}function V(r,t,e){const n=r.slice();return n[31]=t[e],n[30]=e,n}function W(r){let t,e=r[3]&&X(r);return{c(){t=v("div"),e&&e.c(),b(t,"class","table-header svelte-iiknzs")},m(n,s){w(n,t,s),e&&e.m(t,null)},p(n,s){n[3]?e?e.p(n,s):(e=X(n),e.c(),e.m(t,null)):e&&(e.d(1),e=null)},d(n){n&&y(t),e&&e.d()}}}function X(r){let t,e,n,s;return{c(){t=U(`\xA0
        `),e=v("button"),e.textContent="Export",b(e,"type","button"),b(e,"class","table-button settings-button svelte-iiknzs"),P(e,"loading",r[9])},m(i,o){w(i,t,o),w(i,e,o),n||(s=H(e,"click",r[17]),n=!0)},p(i,o){o[0]&512&&P(e,"loading",i[9])},d(i){i&&(y(t),y(e)),n=!1,s()}}}function Y(r){let t,e=R(r[10]),n=[];for(let s=0;s<e.length;s+=1)n[s]=ee(V(r,e,s));return{c(){t=v("tr");for(let s=0;s<n.length;s+=1)n[s].c()},m(s,i){w(s,t,i);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(t,null)},p(s,i){if(i[0]&271366){e=R(s[10]);let o;for(o=0;o<e.length;o+=1){const l=V(s,e,o);n[o]?n[o].p(l,i):(n[o]=ee(l),n[o].c(),n[o].m(t,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=e.length}},d(s){s&&y(t),F(n,s)}}}function Z(r){let t,e=r[1].direction==="asc"?"\u2191":"\u2193",n;return{c(){t=v("span"),n=U(e)},m(s,i){w(s,t,i),S(t,n)},p(s,i){i[0]&2&&e!==(e=s[1].direction==="asc"?"\u2191":"\u2193")&&we(n,e)},d(s){s&&y(t)}}}function ee(r){var t;let e,n,s=r[31].label+"",i,o,l,d;function f(...c){return r[22](r[31],...c)}let u=((t=r[1])==null?void 0:t.key)===r[31].key&&Z(r);function A(){return r[23](r[31])}function T(...c){return r[24](r[30],...c)}return{c(){e=v("th"),n=v("span"),i=O(),u&&u.c(),o=O(),b(n,"class","draggable-column svelte-iiknzs"),b(n,"draggable",r[2]),b(n,"tabindex","-1"),b(n,"role","button"),b(n,"aria-label","Drag handle"),b(e,"class","svelte-iiknzs"),P(e,"sortable",r[2]&&r[31].sortable)},m(c,g){w(c,e,g),S(e,n),n.innerHTML=s,S(e,i),u&&u.m(e,null),S(e,o),l||(d=[H(n,"dragstart",f),H(e,"click",A),H(e,"drop",T),H(e,"dragover",Pe)],l=!0)},p(c,g){var m;r=c,g[0]&1024&&s!==(s=r[31].label+"")&&(n.innerHTML=s),g[0]&4&&b(n,"draggable",r[2]),((m=r[1])==null?void 0:m.key)===r[31].key?u?u.p(r,g):(u=Z(r),u.c(),u.m(e,o)):u&&(u.d(1),u=null),g[0]&1028&&P(e,"sortable",r[2]&&r[31].sortable)},d(c){c&&y(e),u&&u.d(),l=!1,xe(d)}}}function te(r){let t,e=R(r[8]),n=[];for(let s=0;s<e.length;s+=1)n[s]=re(K(r,e,s));return{c(){for(let s=0;s<n.length;s+=1)n[s].c();t=ze()},m(s,i){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(s,i);w(s,t,i)},p(s,i){if(i[0]&38160){e=R(s[8]);let o;for(o=0;o<e.length;o+=1){const l=K(s,e,o);n[o]?n[o].p(l,i):(n[o]=re(l),n[o].c(),n[o].m(t.parentNode,t))}for(;o<n.length;o+=1)n[o].d(1);n.length=e.length}},d(s){s&&y(t),F(n,s)}}}function je(r){return{c:E,m:E,p:E,d:E}}function Ce(r){let t,e=r[34]+"";return{c(){t=v("span"),b(t,"class","cell svelte-iiknzs")},m(n,s){w(n,t,s),t.innerHTML=e},p(n,s){s[0]&1280&&e!==(e=n[34]+"")&&(t.innerHTML=e)},d(n){n&&y(t)}}}function De(r){return{c:E,m:E,p:E,d:E}}function ne(r){let t,e,n,s,i={ctx:r,current:null,token:null,hasCatch:!1,pending:De,then:Ce,catch:je,value:34};G(e=r[12](r[31],r[28],r[30]),i);function o(...l){return r[25](r[28],r[30],r[31],...l)}return{c(){t=v("td"),i.block.c(),b(t,"class","svelte-iiknzs")},m(l,d){w(l,t,d),i.block.m(t,i.anchor=null),i.mount=()=>t,i.anchor=null,n||(s=H(t,"click",o),n=!0)},p(l,d){r=l,i.ctx=r,d[0]&1280&&e!==(e=r[12](r[31],r[28],r[30]))&&G(e,i)||ye(i,r,d)},d(l){l&&y(t),i.block.d(),i.token=null,i=null,n=!1,s()}}}function re(r){let t,e,n=R(r[10]),s=[];for(let i=0;i<n.length;i+=1)s[i]=ne(Q(r,n,i));return{c(){t=v("tr");for(let i=0;i<s.length;i+=1)s[i].c();e=O(),b(t,"class","svelte-iiknzs"),P(t,"highlight",r[4])},m(i,o){w(i,t,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(t,null);S(t,e)},p(i,o){if(o[0]&38144){n=R(i[10]);let l;for(l=0;l<n.length;l+=1){const d=Q(i,n,l);s[l]?s[l].p(d,o):(s[l]=ne(d),s[l].c(),s[l].m(t,e))}for(;l<s.length;l+=1)s[l].d(1);s.length=n.length}o[0]&16&&P(t,"highlight",i[4])},d(i){i&&y(t),F(s,i)}}}function Me(r){let t;return{c(){t=U("Load More")},m(e,n){w(e,t,n)},d(e){e&&y(t)}}}function Ae(r){let t,e;return{c(){t=v("span"),e=U(`
        Loading`),b(t,"class","spinner svelte-iiknzs")},m(n,s){w(n,t,s),w(n,e,s)},d(n){n&&(y(t),y(e))}}}function se(r){let t,e,n;return{c(){t=v("jp-select"),_(t,"label","Page Size"),_(t,"options",r[11]),_(t,"value",r[0])},m(s,i){w(s,t,i),e||(n=H(t,"value",r[16]),e=!0)},p(s,i){i[0]&1&&_(t,"value",s[0])},d(s){s&&y(t),e=!1,n()}}}function Ee(r){let t,e,n,s,i,o,l,d,f,u,A,T,c=r[3]&&W(r),g=r[10]&&Y(r),m=r[8]&&te(r);function N(p,j){return p[6]?Ae:Me}let D=N(r),x=D(r),k=r[5].length>1&&se(r);return{c(){t=v("div"),c&&c.c(),e=O(),n=v("div"),s=v("table"),g&&g.c(),i=O(),m&&m.c(),o=O(),l=v("div"),d=v("button"),x.c(),u=O(),k&&k.c(),b(s,"class","svelte-iiknzs"),b(n,"class","table-container svelte-iiknzs"),b(d,"type","button"),b(d,"class","table-button load-button svelte-iiknzs"),d.disabled=f=!r[7],P(d,"loading",r[6]),b(l,"class","table-actions svelte-iiknzs"),b(t,"class","table-card svelte-iiknzs")},m(p,j){w(p,t,j),c&&c.m(t,null),S(t,e),S(t,n),S(n,s),g&&g.m(s,null),S(s,i),m&&m.m(s,null),S(t,o),S(t,l),S(l,d),x.m(d,null),S(l,u),k&&k.m(l,null),A||(T=H(d,"click",r[14]),A=!0)},p(p,j){p[3]?c?c.p(p,j):(c=W(p),c.c(),c.m(t,e)):c&&(c.d(1),c=null),p[10]?g?g.p(p,j):(g=Y(p),g.c(),g.m(s,i)):g&&(g.d(1),g=null),p[8]?m?m.p(p,j):(m=te(p),m.c(),m.m(s,null)):m&&(m.d(1),m=null),D!==(D=N(p))&&(x.d(1),x=D(p),x&&(x.c(),x.m(d,null))),j[0]&128&&f!==(f=!p[7])&&(d.disabled=f),j[0]&64&&P(d,"loading",p[6]),p[5].length>1?k?k.p(p,j):(k=se(p),k.c(),k.m(l,null)):k&&(k.d(1),k=null)},i:E,o:E,d(p){p&&y(t),c&&c.d(),g&&g.d(),m&&m.d(),x.d(),k&&k.d(),A=!1,T()}}}function Le(r,t){r.dataTransfer.setData("text/plain",t.key)}function Pe(r){r.preventDefault()}function He(r,t,e){let{allowArrangeColumns:n=!0}=t,{showExport:s=!0}=t,{rowClickable:i=!1}=t,{headers:o=[]}=t,{pageSizes:l=[10,25,50,100]}=t,{pageSize:d=l[0]}=t,{sort:f}=t,{service:u}=t,{getData:A=async()=>{const a=await u.get(f,d);e(8,m=a.rows),e(7,g=a.hasMore),e(6,c=!1)}}=t,T=JSON.stringify(l.map(a=>({label:a,value:a}))),c=!0,g=!1,m=[],N=!1,D,x=[];const k=ke();async function p(a,h,$){const{key:C,fallback:M,pipes:B}=a;let z;try{z=$e(h,C)}catch{return M||""}if(!B)return z;for(const q of B)z=await q(z,h,$);return z}async function j(a){const{sortable:h}=a;if(!h)return;e(6,c=!0),e(1,f={key:a.key,direction:f?.key===a.key&&f.direction==="asc"?"desc":"asc"});const[$]=await Promise.all([u.get(f,d),u.adjustSort(f)]);e(8,m=$.rows),e(7,g=$.hasMore),e(6,c=!1)}async function oe(){e(6,c=!0);const a=await u.loadMore(f,d);e(8,m=[...m,...a.rows]),e(7,g=a.hasMore),e(6,c=!1)}function I(a,h,$,C){k("rowClick",{row:a,index:h,header:$,originalEvent:C})}async function ae(a){e(0,d=a.detail),await Promise.all([A(),u.adjustPageSize(d)])}async function le(){e(9,N=!0);const a=await u.export(),h=await Promise.all(a.map(async(M,B)=>(await Promise.all(D.map(z=>p({key:z.key,fallback:z.exportFallback||z.fallback,pipes:z.exportPipes||z.pipes||[]},M,B)))).map(z=>`"${z||""}"`).join(","))),$=new Blob([[D.map(M=>M.label).map(M=>`"${M}"`).join(","),...h].join(`
`)],{type:"text/csv"}),C=document.createElement("a");C.href=URL.createObjectURL($),C.download="export.csv",C.click(),e(9,N=!1)}function J(a,h){a.preventDefault();const $=a.dataTransfer.getData("text/plain"),C=x.indexOf($);C!==-1&&Number.isInteger(h)&&(x.splice(C,1),x.splice(Number(h),0,$),e(10,D=o.filter(M=>!M.disabled).sort((M,B)=>{const z=x.indexOf(M.key),q=x.indexOf(B.key);return z-q})))}ve(async()=>{x=D.map(a=>a.key),await A()});const ce=(a,h)=>Le(h,a),de=a=>j(a),ue=(a,h)=>J(h,a),ge=(a,h,$,C)=>I(a,h,$,C);return r.$$set=a=>{"allowArrangeColumns"in a&&e(2,n=a.allowArrangeColumns),"showExport"in a&&e(3,s=a.showExport),"rowClickable"in a&&e(4,i=a.rowClickable),"headers"in a&&e(19,o=a.headers),"pageSizes"in a&&e(5,l=a.pageSizes),"pageSize"in a&&e(0,d=a.pageSize),"sort"in a&&e(1,f=a.sort),"service"in a&&e(20,u=a.service),"getData"in a&&e(21,A=a.getData)},r.$$.update=()=>{r.$$.dirty[0]&524288&&e(10,D=o.filter(a=>!a.disabled))},[d,f,n,s,i,l,c,g,m,N,D,T,p,j,oe,I,ae,le,J,o,u,A,ce,de,ue,ge]}class ie extends me{constructor(t){super(),be(this,t,He,Ee,fe,{allowArrangeColumns:2,showExport:3,rowClickable:4,headers:19,pageSizes:5,pageSize:0,sort:1,service:20,getData:21},Se,[-1,-1])}get allowArrangeColumns(){return this.$$.ctx[2]}set allowArrangeColumns(t){this.$$set({allowArrangeColumns:t}),L()}get showExport(){return this.$$.ctx[3]}set showExport(t){this.$$set({showExport:t}),L()}get rowClickable(){return this.$$.ctx[4]}set rowClickable(t){this.$$set({rowClickable:t}),L()}get headers(){return this.$$.ctx[19]}set headers(t){this.$$set({headers:t}),L()}get pageSizes(){return this.$$.ctx[5]}set pageSizes(t){this.$$set({pageSizes:t}),L()}get pageSize(){return this.$$.ctx[0]}set pageSize(t){this.$$set({pageSize:t}),L()}get sort(){return this.$$.ctx[1]}set sort(t){this.$$set({sort:t}),L()}get service(){return this.$$.ctx[20]}set service(t){this.$$set({service:t}),L()}get getData(){return this.$$.ctx[21]}set getData(t){this.$$set({getData:t}),L()}}try{customElements.define("jp-async-table",pe(ie,{allowArrangeColumns:{type:"Boolean"},showExport:{type:"Boolean"},rowClickable:{type:"Boolean"},headers:{},pageSizes:{},pageSize:{},sort:{},service:{},getData:{}},[],[],!1));}catch{};export{ie as default};
