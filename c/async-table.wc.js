import{c as me,S as be,i as fe,f as P,s as he,a as ke,e as w,b as T,d as b,m as O,g as y,h as C,o as R,n as M,j as $,k as we,x as ve,t as U,p as N,q as F,r as xe,l as ze,y as _,u as ye,v as K,w as $e}from"./svelte.js";import"./index2.js";import{g as Se}from"./json-pointer.js";function Ce(r){ke(r,"svelte-iiknzs",".table-card.svelte-iiknzs{background-color:var(--background-primary);-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem;-webkit-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16);-moz-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16);box-shadow:0 3px 12px rgba(0, 0, 0, 0.16)}.table-container.svelte-iiknzs{overflow-x:auto;width:100%}table.svelte-iiknzs{width:100%}th.svelte-iiknzs,td.svelte-iiknzs{text-align:left;white-space:nowrap;font-size:0.75rem;font-weight:normal;padding:0.5rem;border-bottom:1px solid rgba(0, 0, 0, 0.16)}th.svelte-iiknzs{opacity:0.75}.sortable.svelte-iiknzs{cursor:pointer}.draggable-column.svelte-iiknzs{cursor:grab}.cell.svelte-iiknzs{display:block;max-width:64ch;overflow:hidden;text-overflow:ellipsis}.table-actions.svelte-iiknzs{padding:1rem;display:flex;justify-content:space-between}.table-header.svelte-iiknzs{padding:1rem;min-height:68px;display:flex;justify-content:flex-end}.table-button.svelte-iiknzs{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem;min-width:4rem;height:2.25rem;padding:0 1rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.settings-button.svelte-iiknzs{background-color:var(--background-secondary);color:var(--text-on-secondary)}.load-button.svelte-iiknzs{background-color:var(--primary-color);color:var(--text-on-primary)}.load-button.svelte-iiknzs:disabled{opacity:0.5}.load-button.loading.svelte-iiknzs{pointer-events:none}.highlight.svelte-iiknzs{cursor:pointer;transition:0.3s}.highlight.svelte-iiknzs:hover{background-color:#ddd}.spinner.svelte-iiknzs{display:block;border-top:2px solid var(--text-on-primary);border-bottom:2px solid var(--text-on-primary);border-left:2px solid transparent;border-right:2px solid transparent;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;width:1rem;height:1rem;margin-right:0.5rem;-webkit-animation:svelte-iiknzs-spin 1s linear infinite;-moz-animation:svelte-iiknzs-spin 1s linear infinite;-o-animation:svelte-iiknzs-spin 1s linear infinite;animation:svelte-iiknzs-spin 1s linear infinite}@-webkit-keyframes svelte-iiknzs-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes svelte-iiknzs-spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes svelte-iiknzs-spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes svelte-iiknzs-spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}")}function Q(r,e,t){const n=r.slice();return n[29]=e[t],n[31]=t,n}function V(r,e,t){const n=r.slice();return n[32]=e[t],n}function W(r,e,t){const n=r.slice();return n[32]=e[t],n[31]=t,n}function X(r){let e,t=r[4]&&Y(r);return{c(){e=w("div"),t&&t.c(),b(e,"class","table-header svelte-iiknzs")},m(n,s){y(n,e,s),t&&t.m(e,null)},p(n,s){n[4]?t?t.p(n,s):(t=Y(n),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},d(n){n&&$(e),t&&t.d()}}}function Y(r){let e,t,n,s;return{c(){e=U(`\xA0
        `),t=w("button"),t.textContent="Export",b(t,"type","button"),b(t,"class","table-button settings-button svelte-iiknzs"),O(t,"loading",r[9])},m(i,o){y(i,e,o),y(i,t,o),n||(s=R(t,"click",r[17]),n=!0)},p(i,o){o[0]&512&&O(t,"loading",i[9])},d(i){i&&($(e),$(t)),n=!1,s()}}}function Z(r){let e,t=N(r[10]),n=[];for(let s=0;s<t.length;s+=1)n[s]=te(W(r,t,s));return{c(){e=w("tr");for(let s=0;s<n.length;s+=1)n[s].c()},m(s,i){y(s,e,i);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(s,i){if(i[0]&271370){t=N(s[10]);let o;for(o=0;o<t.length;o+=1){const l=W(s,t,o);n[o]?n[o].p(l,i):(n[o]=te(l),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(s){s&&$(e),F(n,s)}}}function ee(r){let e,t=r[1].direction==="asc"?"\u2191":"\u2193",n;return{c(){e=w("span"),n=U(t)},m(s,i){y(s,e,i),C(e,n)},p(s,i){i[0]&2&&t!==(t=s[1].direction==="asc"?"\u2191":"\u2193")&&ye(n,t)},d(s){s&&$(e)}}}function te(r){var e;let t,n,s=r[32].label+"",i,o,l,c;function h(...g){return r[23](r[32],...g)}let u=((e=r[1])==null?void 0:e.key)===r[32].key&&ee(r);function A(){return r[24](r[32])}function S(...g){return r[25](r[31],...g)}return{c(){t=w("th"),n=w("span"),i=T(),u&&u.c(),o=T(),b(n,"class","draggable-column svelte-iiknzs"),b(n,"draggable",r[3]),b(n,"tabindex","-1"),b(n,"role","button"),b(n,"aria-label","Drag handle"),b(t,"class","svelte-iiknzs"),O(t,"sortable",r[3]&&r[32].sortable)},m(g,d){y(g,t,d),C(t,n),n.innerHTML=s,C(t,i),u&&u.m(t,null),C(t,o),l||(c=[R(n,"dragstart",h),R(t,"click",A),R(t,"drop",S),R(t,"dragover",Oe)],l=!0)},p(g,d){var m;r=g,d[0]&1024&&s!==(s=r[32].label+"")&&(n.innerHTML=s),d[0]&8&&b(n,"draggable",r[3]),((m=r[1])==null?void 0:m.key)===r[32].key?u?u.p(r,d):(u=ee(r),u.c(),u.m(t,o)):u&&(u.d(1),u=null),d[0]&1032&&O(t,"sortable",r[3]&&r[32].sortable)},d(g){g&&$(t),u&&u.d(),l=!1,xe(c)}}}function ne(r){let e,t=N(r[2]),n=[];for(let s=0;s<t.length;s+=1)n[s]=se(Q(r,t,s));return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=ze()},m(s,i){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(s,i);y(s,e,i)},p(s,i){if(i[0]&37924){t=N(s[2]);let o;for(o=0;o<t.length;o+=1){const l=Q(s,t,o);n[o]?n[o].p(l,i):(n[o]=se(l),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(s){s&&$(e),F(n,s)}}}function De(r){return{c:M,m:M,p:M,d:M}}function Ee(r){let e,t=r[35]+"";return{c(){e=w("span"),b(e,"class","cell svelte-iiknzs")},m(n,s){y(n,e,s),e.innerHTML=t},p(n,s){s[0]&1028&&t!==(t=n[35]+"")&&(e.innerHTML=t)},d(n){n&&$(e)}}}function Le(r){return{c:M,m:M,p:M,d:M}}function re(r){let e,t,n,s,i={ctx:r,current:null,token:null,hasCatch:!1,pending:Le,then:Ee,catch:De,value:35};K(t=r[12](r[32],r[29],r[31]),i);function o(...l){return r[26](r[29],r[31],r[32],...l)}return{c(){e=w("td"),i.block.c(),b(e,"class","svelte-iiknzs")},m(l,c){y(l,e,c),i.block.m(e,i.anchor=null),i.mount=()=>e,i.anchor=null,n||(s=R(e,"click",o),n=!0)},p(l,c){r=l,i.ctx=r,c[0]&1028&&t!==(t=r[12](r[32],r[29],r[31]))&&K(t,i)||$e(i,r,c)},d(l){l&&$(e),i.block.d(),i.token=null,i=null,n=!1,s()}}}function se(r){let e,t,n=N(r[10]),s=[];for(let i=0;i<n.length;i+=1)s[i]=re(V(r,n,i));return{c(){e=w("tr");for(let i=0;i<s.length;i+=1)s[i].c();t=T(),b(e,"class","svelte-iiknzs"),O(e,"highlight",r[5])},m(i,o){y(i,e,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);C(e,t)},p(i,o){if(o[0]&37892){n=N(i[10]);let l;for(l=0;l<n.length;l+=1){const c=V(i,n,l);s[l]?s[l].p(c,o):(s[l]=re(c),s[l].c(),s[l].m(e,t))}for(;l<s.length;l+=1)s[l].d(1);s.length=n.length}o[0]&32&&O(e,"highlight",i[5])},d(i){i&&$(e),F(s,i)}}}function je(r){let e;return{c(){e=U("Load More")},m(t,n){y(t,e,n)},d(t){t&&$(e)}}}function Ae(r){let e,t;return{c(){e=w("span"),t=U(`
        Loading`),b(e,"class","spinner svelte-iiknzs")},m(n,s){y(n,e,s),y(n,t,s)},d(n){n&&($(e),$(t))}}}function ie(r){let e,t,n;return{c(){e=w("jp-select"),_(e,"label","Page Size"),_(e,"options",r[11]),_(e,"value",r[0])},m(s,i){y(s,e,i),t||(n=R(e,"value",r[16]),t=!0)},p(s,i){i[0]&1&&_(e,"value",s[0])},d(s){s&&$(e),t=!1,n()}}}function Pe(r){let e,t,n,s,i,o,l,c,h,u,A,S,g=r[4]&&X(r),d=r[10]&&Z(r),m=r[2]&&ne(r);function B(p,D){return p[7]?Ae:je}let L=B(r),v=L(r),k=r[6].length>1&&ie(r);return{c(){e=w("div"),g&&g.c(),t=T(),n=w("div"),s=w("table"),d&&d.c(),i=T(),m&&m.c(),o=T(),l=w("div"),c=w("button"),v.c(),u=T(),k&&k.c(),b(s,"class","svelte-iiknzs"),b(n,"class","table-container svelte-iiknzs"),b(c,"type","button"),b(c,"class","table-button load-button svelte-iiknzs"),c.disabled=h=!r[8],O(c,"loading",r[7]),b(l,"class","table-actions svelte-iiknzs"),b(e,"class","table-card svelte-iiknzs")},m(p,D){y(p,e,D),g&&g.m(e,null),C(e,t),C(e,n),C(n,s),d&&d.m(s,null),C(s,i),m&&m.m(s,null),C(e,o),C(e,l),C(l,c),v.m(c,null),C(l,u),k&&k.m(l,null),A||(S=R(c,"click",r[14]),A=!0)},p(p,D){p[4]?g?g.p(p,D):(g=X(p),g.c(),g.m(e,t)):g&&(g.d(1),g=null),p[10]?d?d.p(p,D):(d=Z(p),d.c(),d.m(s,i)):d&&(d.d(1),d=null),p[2]?m?m.p(p,D):(m=ne(p),m.c(),m.m(s,null)):m&&(m.d(1),m=null),L!==(L=B(p))&&(v.d(1),v=L(p),v&&(v.c(),v.m(c,null))),D[0]&256&&h!==(h=!p[8])&&(c.disabled=h),D[0]&128&&O(c,"loading",p[7]),p[6].length>1?k?k.p(p,D):(k=ie(p),k.c(),k.m(l,null)):k&&(k.d(1),k=null)},i:M,o:M,d(p){p&&$(e),g&&g.d(),d&&d.d(),m&&m.d(),v.d(),k&&k.d(),A=!1,S()}}}function Me(r,e){r.dataTransfer.setData("text/plain",e.key)}function Oe(r){r.preventDefault()}function Re(r,e,t){let{allowArrangeColumns:n=!0}=e,{showExport:s=!0}=e,{rowClickable:i=!1}=e,{headers:o=[]}=e,{pageSizes:l=[10,25,50,100]}=e,{pageSize:c=l[0]}=e,{sort:h}=e,{service:u}=e,{getData:A=async()=>{const a=await u.get(h,c);t(2,S=a.rows),t(8,m=a.hasMore),t(7,d=!1)}}=e,{rows:S=[]}=e,g=JSON.stringify(l.map(a=>({label:a,value:a}))),d=!0,m=!1,B=!1,L,v=[];const k=we();async function p(a,f="id"){t(2,S=S.filter(x=>x[f]!==a))}async function D(a,f,x){const{key:E,fallback:j,pipes:H}=a;let z;try{z=Se(f,E)}catch{return j||""}if(!H)return z;for(const q of H)z=await q(z,f,x);return z}async function I(a){const{sortable:f}=a;if(!f)return;t(7,d=!0),t(1,h={key:a.key,direction:h?.key===a.key&&h.direction==="asc"?"desc":"asc"});const[x]=await Promise.all([u.get(h,c),u.adjustSort(h)]);t(2,S=x.rows),t(8,m=x.hasMore),t(7,d=!1)}async function ae(){t(7,d=!0);const a=await u.loadMore(h,c);t(2,S=[...S,...a.rows]),t(8,m=a.hasMore),t(7,d=!1)}function J(a,f,x,E){k("rowClick",{row:a,index:f,header:x,originalEvent:E})}async function le(a){t(0,c=a.detail),await Promise.all([A(),u.adjustPageSize(c)])}async function ce(){t(9,B=!0);const a=await u.export(),f=await Promise.all(a.map(async(j,H)=>(await Promise.all(L.map(z=>D({key:z.key,fallback:z.exportFallback||z.fallback,pipes:z.exportPipes||z.pipes||[]},j,H)))).map(z=>`"${z||""}"`).join(","))),x=new Blob([[L.map(j=>j.label).map(j=>`"${j}"`).join(","),...f].join(`
`)],{type:"text/csv"}),E=document.createElement("a");E.href=URL.createObjectURL(x),E.download="export.csv",E.click(),t(9,B=!1)}function G(a,f){a.preventDefault();const x=a.dataTransfer.getData("text/plain"),E=v.indexOf(x);E!==-1&&Number.isInteger(f)&&(v.splice(E,1),v.splice(Number(f),0,x),t(10,L=o.filter(j=>!j.disabled).sort((j,H)=>{const z=v.indexOf(j.key),q=v.indexOf(H.key);return z-q})))}ve(async()=>{v=L.map(a=>a.key),await A()});const de=(a,f)=>Me(f,a),ue=a=>I(a),ge=(a,f)=>G(f,a),pe=(a,f,x,E)=>J(a,f,x,E);return r.$$set=a=>{"allowArrangeColumns"in a&&t(3,n=a.allowArrangeColumns),"showExport"in a&&t(4,s=a.showExport),"rowClickable"in a&&t(5,i=a.rowClickable),"headers"in a&&t(19,o=a.headers),"pageSizes"in a&&t(6,l=a.pageSizes),"pageSize"in a&&t(0,c=a.pageSize),"sort"in a&&t(1,h=a.sort),"service"in a&&t(20,u=a.service),"getData"in a&&t(21,A=a.getData),"rows"in a&&t(2,S=a.rows)},r.$$.update=()=>{r.$$.dirty[0]&524288&&t(10,L=o.filter(a=>!a.disabled))},[c,h,S,n,s,i,l,d,m,B,L,g,D,I,ae,J,le,ce,G,o,u,A,p,de,ue,ge,pe]}class oe extends be{constructor(e){super(),fe(this,e,Re,Pe,he,{allowArrangeColumns:3,showExport:4,rowClickable:5,headers:19,pageSizes:6,pageSize:0,sort:1,service:20,getData:21,rows:2,removeRow:22},Ce,[-1,-1])}get allowArrangeColumns(){return this.$$.ctx[3]}set allowArrangeColumns(e){this.$$set({allowArrangeColumns:e}),P()}get showExport(){return this.$$.ctx[4]}set showExport(e){this.$$set({showExport:e}),P()}get rowClickable(){return this.$$.ctx[5]}set rowClickable(e){this.$$set({rowClickable:e}),P()}get headers(){return this.$$.ctx[19]}set headers(e){this.$$set({headers:e}),P()}get pageSizes(){return this.$$.ctx[6]}set pageSizes(e){this.$$set({pageSizes:e}),P()}get pageSize(){return this.$$.ctx[0]}set pageSize(e){this.$$set({pageSize:e}),P()}get sort(){return this.$$.ctx[1]}set sort(e){this.$$set({sort:e}),P()}get service(){return this.$$.ctx[20]}set service(e){this.$$set({service:e}),P()}get getData(){return this.$$.ctx[21]}set getData(e){this.$$set({getData:e}),P()}get rows(){return this.$$.ctx[2]}set rows(e){this.$$set({rows:e}),P()}get removeRow(){return this.$$.ctx[22]}}try{customElements.define("jp-async-table",me(oe,{allowArrangeColumns:{type:"Boolean"},showExport:{type:"Boolean"},rowClickable:{type:"Boolean"},headers:{},pageSizes:{},pageSize:{},sort:{},service:{},getData:{},rows:{}},[],["removeRow"],!1));}catch{};export{oe as default};
