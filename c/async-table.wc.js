import{c as ke,S as we,i as ve,f as j,s as xe,a as ye,e as v,b as M,d as f,m as x,g as $,h as S,o as R,n as A,j as z,k as $e,x as ze,t as H,p as O,q as U,r as qe,l as Ce,y as N,u as Se,v as Q,w as Le}from"./svelte.js";import"./index2.js";import{g as je}from"./json-pointer.js";function De(n){ye(n,"svelte-1qb8ntr",".table-card.svelte-1qb8ntr{background-color:var(--background-primary);-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem;-webkit-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16);-moz-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16);box-shadow:0 3px 12px rgba(0, 0, 0, 0.16)}.table-container.svelte-1qb8ntr{overflow-x:auto;width:100%}table.svelte-1qb8ntr{width:100%}th.svelte-1qb8ntr,td.svelte-1qb8ntr{text-align:left;white-space:nowrap;font-size:0.75rem;font-weight:normal;padding:0.5rem;border-bottom:1px solid rgba(0, 0, 0, 0.16)}th.svelte-1qb8ntr{opacity:0.75}.sortable.svelte-1qb8ntr{cursor:pointer}.draggable-column.svelte-1qb8ntr{cursor:grab}.cell.svelte-1qb8ntr{display:block;max-width:64ch;overflow:hidden;text-overflow:ellipsis}.table-actions.svelte-1qb8ntr{padding:1rem;display:flex;justify-content:space-between}.table-header.svelte-1qb8ntr{padding:1rem;min-height:68px;display:flex;justify-content:flex-end}.table-button.svelte-1qb8ntr{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem;min-width:4rem;height:2.25rem;padding:0 1rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.settings-button.svelte-1qb8ntr{background-color:var(--background-secondary);color:var(--text-on-secondary)}.load-button.svelte-1qb8ntr{background-color:var(--primary-color);color:var(--text-on-primary)}.load-button.svelte-1qb8ntr:disabled{opacity:0.5}.load-button.loading.svelte-1qb8ntr{pointer-events:none}.highlight.svelte-1qb8ntr{cursor:pointer;transition:0.3s}.highlight.svelte-1qb8ntr:hover{background-color:#ddd}.spinner.svelte-1qb8ntr{display:block;border-top:2px solid var(--text-on-primary);border-bottom:2px solid var(--text-on-primary);border-left:2px solid transparent;border-right:2px solid transparent;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;width:1rem;height:1rem;margin-right:0.5rem;-webkit-animation:svelte-1qb8ntr-spin 1s linear infinite;-moz-animation:svelte-1qb8ntr-spin 1s linear infinite;-o-animation:svelte-1qb8ntr-spin 1s linear infinite;animation:svelte-1qb8ntr-spin 1s linear infinite}@-webkit-keyframes svelte-1qb8ntr-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes svelte-1qb8ntr-spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes svelte-1qb8ntr-spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes svelte-1qb8ntr-spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}.sticky-first.svelte-1qb8ntr{position:sticky;left:0;opacity:1;background-color:var(--background-primary);z-index:1}.sticky-first.svelte-1qb8ntr:after{content:'';position:absolute;top:0;right:0;bottom:0;width:.5px;height:100%;background-color:rgba(0, 0, 0, 0.16)}.sticky-last.svelte-1qb8ntr{position:sticky;right:0;opacity:1;background-color:var(--background-primary);z-index:1}.sticky-last.svelte-1qb8ntr:before{content:'';position:absolute;top:0;left:0;bottom:0;width:.5px;height:100%;background-color:rgba(0, 0, 0, 0.16)}")}function V(n,e,t){const r=n.slice();return r[33]=e[t],r[35]=t,r}function W(n,e,t){const r=n.slice();return r[36]=e[t],r[35]=t,r}function X(n,e,t){const r=n.slice();return r[36]=e[t],r[35]=t,r}function Y(n){let e,t=n[6]&&Z(n);return{c(){e=v("div"),t&&t.c(),f(e,"class","table-header svelte-1qb8ntr")},m(r,o){$(r,e,o),t&&t.m(e,null)},p(r,o){r[6]?t?t.p(r,o):(t=Z(r),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},d(r){r&&z(e),t&&t.d()}}}function Z(n){let e,t,r,o;return{c(){e=H(`\xA0
        `),t=v("button"),t.textContent="Export",f(t,"type","button"),f(t,"class","table-button settings-button svelte-1qb8ntr"),x(t,"loading",n[11])},m(a,l){$(a,e,l),$(a,t,l),r||(o=R(t,"click",n[19]),r=!0)},p(a,l){l[0]&2048&&x(t,"loading",a[11])},d(a){a&&(z(e),z(t)),r=!1,o()}}}function ee(n){let e,t=O(n[12]),r=[];for(let o=0;o<t.length;o+=1)r[o]=ne(X(n,t,o));return{c(){e=v("tr");for(let o=0;o<r.length;o+=1)r[o].c()},m(o,a){$(o,e,a);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null)},p(o,a){if(a[0]&1085498){t=O(o[12]);let l;for(l=0;l<t.length;l+=1){const i=X(o,t,l);r[l]?r[l].p(i,a):(r[l]=ne(i),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=t.length}},d(o){o&&z(e),U(r,o)}}}function te(n){let e,t=n[1].direction==="asc"?"\u2191":"\u2193",r;return{c(){e=v("span"),r=H(t)},m(o,a){$(o,e,a),S(e,r)},p(o,a){a[0]&2&&t!==(t=o[1].direction==="asc"?"\u2191":"\u2193")&&Se(r,t)},d(o){o&&z(e)}}}function ne(n){var e;let t,r,o=n[36].label+"",a,l,i,d;function D(...u){return n[27](n[36],...u)}let g=((e=n[1])==null?void 0:e.key)===n[36].key&&te(n);function w(){return n[28](n[36])}function C(...u){return n[29](n[35],...u)}return{c(){t=v("th"),r=v("span"),a=M(),g&&g.c(),l=M(),f(r,"class","draggable-column svelte-1qb8ntr"),f(r,"draggable",n[3]),f(r,"tabindex","-1"),f(r,"role","button"),f(r,"aria-label","Drag handle"),f(t,"class","svelte-1qb8ntr"),x(t,"sortable",n[3]&&n[36].sortable),x(t,"sticky-first",n[4]&&n[35]===0),x(t,"sticky-last",n[35]===n[12].length-1&&n[5])},m(u,c){$(u,t,c),S(t,r),r.innerHTML=o,S(t,a),g&&g.m(t,null),S(t,l),i||(d=[R(r,"dragstart",D),R(t,"click",w),R(t,"drop",C),R(t,"dragover",Te)],i=!0)},p(u,c){var h;n=u,c[0]&4096&&o!==(o=n[36].label+"")&&(r.innerHTML=o),c[0]&8&&f(r,"draggable",n[3]),((h=n[1])==null?void 0:h.key)===n[36].key?g?g.p(n,c):(g=te(n),g.c(),g.m(t,l)):g&&(g.d(1),g=null),c[0]&4104&&x(t,"sortable",n[3]&&n[36].sortable),c[0]&16&&x(t,"sticky-first",n[4]&&n[35]===0),c[0]&4128&&x(t,"sticky-last",n[35]===n[12].length-1&&n[5])},d(u){u&&z(t),g&&g.d(),i=!1,qe(d)}}}function re(n){let e,t=O(n[2]),r=[];for(let o=0;o<t.length;o+=1)r[o]=ae(V(n,t,o));return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=Ce()},m(o,a){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(o,a);$(o,e,a)},p(o,a){if(a[0]&151732){t=O(o[2]);let l;for(l=0;l<t.length;l+=1){const i=V(o,t,l);r[l]?r[l].p(i,a):(r[l]=ae(i),r[l].c(),r[l].m(e.parentNode,e))}for(;l<r.length;l+=1)r[l].d(1);r.length=t.length}},d(o){o&&z(e),U(r,o)}}}function Ee(n){return{c:A,m:A,p:A,d:A}}function Fe(n){let e,t=n[38]+"";return{c(){e=v("span"),f(e,"class","cell svelte-1qb8ntr")},m(r,o){$(r,e,o),e.innerHTML=t},p(r,o){o[0]&4100&&t!==(t=r[38]+"")&&(e.innerHTML=t)},d(r){r&&z(e)}}}function Ae(n){return{c:A,m:A,p:A,d:A}}function oe(n){let e,t,r,o,a={ctx:n,current:null,token:null,hasCatch:!1,pending:Ae,then:Fe,catch:Ee,value:38};Q(t=n[14](n[36],n[33],n[35]),a);function l(...i){return n[30](n[33],n[35],n[36],...i)}return{c(){e=v("td"),a.block.c(),f(e,"class","svelte-1qb8ntr"),x(e,"sticky-first",n[4]&&n[35]===0),x(e,"sticky-last",n[35]===n[12].length-1&&n[5])},m(i,d){$(i,e,d),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=null,r||(o=R(e,"click",l),r=!0)},p(i,d){n=i,a.ctx=n,d[0]&4100&&t!==(t=n[14](n[36],n[33],n[35]))&&Q(t,a)||Le(a,n,d),d[0]&16&&x(e,"sticky-first",n[4]&&n[35]===0),d[0]&4128&&x(e,"sticky-last",n[35]===n[12].length-1&&n[5])},d(i){i&&z(e),a.block.d(),a.token=null,a=null,r=!1,o()}}}function ae(n){let e,t,r=O(n[12]),o=[];for(let a=0;a<r.length;a+=1)o[a]=oe(W(n,r,a));return{c(){e=v("tr");for(let a=0;a<o.length;a+=1)o[a].c();t=M(),f(e,"class","svelte-1qb8ntr"),x(e,"highlight",n[7])},m(a,l){$(a,e,l);for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(e,null);S(e,t)},p(a,l){if(l[0]&151604){r=O(a[12]);let i;for(i=0;i<r.length;i+=1){const d=W(a,r,i);o[i]?o[i].p(d,l):(o[i]=oe(d),o[i].c(),o[i].m(e,t))}for(;i<o.length;i+=1)o[i].d(1);o.length=r.length}l[0]&128&&x(e,"highlight",a[7])},d(a){a&&z(e),U(o,a)}}}function Be(n){let e;return{c(){e=H("Load More")},m(t,r){$(t,e,r)},d(t){t&&z(e)}}}function Pe(n){let e,t;return{c(){e=v("span"),t=H(`
        Loading`),f(e,"class","spinner svelte-1qb8ntr")},m(r,o){$(r,e,o),$(r,t,o)},d(r){r&&(z(e),z(t))}}}function se(n){let e,t,r;return{c(){e=v("jp-select"),N(e,"label","Page Size"),N(e,"options",n[13]),N(e,"value",n[0])},m(o,a){$(o,e,a),t||(r=R(e,"value",n[18]),t=!0)},p(o,a){a[0]&1&&N(e,"value",o[0])},d(o){o&&z(e),t=!1,r()}}}function Re(n){let e,t,r,o,a,l,i,d,D,g,w,C,u=n[6]&&Y(n),c=n[12]&&ee(n),h=n[2]&&re(n);function B(b,E){return b[9]?Pe:Be}let P=B(n),L=P(n),m=n[8].length>1&&se(n);return{c(){e=v("div"),u&&u.c(),t=M(),r=v("div"),o=v("table"),c&&c.c(),a=M(),h&&h.c(),l=M(),i=v("div"),d=v("button"),L.c(),g=M(),m&&m.c(),f(o,"class","svelte-1qb8ntr"),f(r,"class","table-container svelte-1qb8ntr"),f(d,"type","button"),f(d,"class","table-button load-button svelte-1qb8ntr"),d.disabled=D=!n[10],x(d,"loading",n[9]),f(i,"class","table-actions svelte-1qb8ntr"),f(e,"class","table-card svelte-1qb8ntr")},m(b,E){$(b,e,E),u&&u.m(e,null),S(e,t),S(e,r),S(r,o),c&&c.m(o,null),S(o,a),h&&h.m(o,null),S(e,l),S(e,i),S(i,d),L.m(d,null),S(i,g),m&&m.m(i,null),w||(C=R(d,"click",n[16]),w=!0)},p(b,E){b[6]?u?u.p(b,E):(u=Y(b),u.c(),u.m(e,t)):u&&(u.d(1),u=null),b[12]?c?c.p(b,E):(c=ee(b),c.c(),c.m(o,a)):c&&(c.d(1),c=null),b[2]?h?h.p(b,E):(h=re(b),h.c(),h.m(o,null)):h&&(h.d(1),h=null),P!==(P=B(b))&&(L.d(1),L=P(b),L&&(L.c(),L.m(d,null))),E[0]&1024&&D!==(D=!b[10])&&(d.disabled=D),E[0]&512&&x(d,"loading",b[9]),b[8].length>1?m?m.p(b,E):(m=se(b),m.c(),m.m(i,null)):m&&(m.d(1),m=null)},i:A,o:A,d(b){b&&z(e),u&&u.d(),c&&c.d(),h&&h.d(),L.d(),m&&m.d(),w=!1,C()}}}function Me(n,e){n.dataTransfer.setData("text/plain",e.key)}function Te(n){n.preventDefault()}function Oe(n,e,t){let{allowArrangeColumns:r=!0}=e,{freezeFirstColumn:o=!1}=e,{freezeLastColumn:a=!1}=e,{showExport:l=!0}=e,{rowClickable:i=!1}=e,{headers:d=[]}=e,{pageSizes:D=[10,25,50,100]}=e,{pageSize:g=D[0]}=e,{sort:w}=e,{service:C}=e,{getData:u=async()=>{const s=await C.get(w,g);t(2,c=s.rows),t(10,P=s.hasMore),t(9,B=!1)}}=e,{rows:c=[]}=e,h=JSON.stringify(D.map(s=>({label:s,value:s}))),B=!0,P=!1,L=!1,m,b=[];const E=$e();async function ie(s,p="id"){t(2,c=c.filter(k=>k[p]!==s))}async function ce(s){t(2,c=[...c,s])}async function de(s,p){t(2,c=c.map((k,q)=>q===p?{...k,...s}:k))}async function I(s,p,k){const{key:q,fallback:F,pipes:T}=s;let y;try{y=je(p,q)}catch{return F||""}if(!T)return y;for(const _ of T)y=await _(y,p,k);return y}async function J(s){const{sortable:p}=s;if(!p)return;t(9,B=!0),t(1,w={key:s.key,direction:w?.key===s.key&&w.direction==="asc"?"desc":"asc"});const[k]=await Promise.all([C.get(w,g),C.adjustSort(w)]);t(2,c=k.rows),t(10,P=k.hasMore),t(9,B=!1)}async function ue(){t(9,B=!0);const s=await C.loadMore(w,g);t(2,c=[...c,...s.rows]),t(10,P=s.hasMore),t(9,B=!1)}function G(s,p,k,q){E("rowClick",{row:s,index:p,header:k,originalEvent:q})}async function be(s){t(0,g=s.detail),await Promise.all([u(),C.adjustPageSize(g)])}async function ge(){t(11,L=!0);const s=await C.export(),p=await Promise.all(s.map(async(F,T)=>(await Promise.all(m.map(y=>I({key:y.key,fallback:y.exportFallback||y.fallback,pipes:y.exportPipes||y.pipes||[]},F,T)))).map(y=>`"${y||""}"`).join(","))),k=new Blob([[m.map(F=>F.label).map(F=>`"${F}"`).join(","),...p].join(`
`)],{type:"text/csv"}),q=document.createElement("a");q.href=URL.createObjectURL(k),q.download="export.csv",q.click(),t(11,L=!1)}function K(s,p){s.preventDefault();const k=s.dataTransfer.getData("text/plain"),q=b.indexOf(k);q!==-1&&Number.isInteger(p)&&(b.splice(q,1),b.splice(Number(p),0,k),t(12,m=d.filter(F=>!F.disabled).sort((F,T)=>{const y=b.indexOf(F.key),_=b.indexOf(T.key);return y-_})))}ze(async()=>{b=m.map(s=>s.key),await u()});const me=(s,p)=>Me(p,s),pe=s=>J(s),fe=(s,p)=>K(p,s),he=(s,p,k,q)=>G(s,p,k,q);return n.$$set=s=>{"allowArrangeColumns"in s&&t(3,r=s.allowArrangeColumns),"freezeFirstColumn"in s&&t(4,o=s.freezeFirstColumn),"freezeLastColumn"in s&&t(5,a=s.freezeLastColumn),"showExport"in s&&t(6,l=s.showExport),"rowClickable"in s&&t(7,i=s.rowClickable),"headers"in s&&t(21,d=s.headers),"pageSizes"in s&&t(8,D=s.pageSizes),"pageSize"in s&&t(0,g=s.pageSize),"sort"in s&&t(1,w=s.sort),"service"in s&&t(22,C=s.service),"getData"in s&&t(23,u=s.getData),"rows"in s&&t(2,c=s.rows)},n.$$.update=()=>{n.$$.dirty[0]&2097152&&t(12,m=d.filter(s=>!s.disabled))},[g,w,c,r,o,a,l,i,D,B,P,L,m,h,I,J,ue,G,be,ge,K,d,C,u,ie,ce,de,me,pe,fe,he]}class le extends we{constructor(e){super(),ve(this,e,Oe,Re,xe,{allowArrangeColumns:3,freezeFirstColumn:4,freezeLastColumn:5,showExport:6,rowClickable:7,headers:21,pageSizes:8,pageSize:0,sort:1,service:22,getData:23,rows:2,removeRow:24,addRow:25,updateRow:26},De,[-1,-1])}get allowArrangeColumns(){return this.$$.ctx[3]}set allowArrangeColumns(e){this.$$set({allowArrangeColumns:e}),j()}get freezeFirstColumn(){return this.$$.ctx[4]}set freezeFirstColumn(e){this.$$set({freezeFirstColumn:e}),j()}get freezeLastColumn(){return this.$$.ctx[5]}set freezeLastColumn(e){this.$$set({freezeLastColumn:e}),j()}get showExport(){return this.$$.ctx[6]}set showExport(e){this.$$set({showExport:e}),j()}get rowClickable(){return this.$$.ctx[7]}set rowClickable(e){this.$$set({rowClickable:e}),j()}get headers(){return this.$$.ctx[21]}set headers(e){this.$$set({headers:e}),j()}get pageSizes(){return this.$$.ctx[8]}set pageSizes(e){this.$$set({pageSizes:e}),j()}get pageSize(){return this.$$.ctx[0]}set pageSize(e){this.$$set({pageSize:e}),j()}get sort(){return this.$$.ctx[1]}set sort(e){this.$$set({sort:e}),j()}get service(){return this.$$.ctx[22]}set service(e){this.$$set({service:e}),j()}get getData(){return this.$$.ctx[23]}set getData(e){this.$$set({getData:e}),j()}get rows(){return this.$$.ctx[2]}set rows(e){this.$$set({rows:e}),j()}get removeRow(){return this.$$.ctx[24]}get addRow(){return this.$$.ctx[25]}get updateRow(){return this.$$.ctx[26]}}try{customElements.define("jp-async-table",ke(le,{allowArrangeColumns:{type:"Boolean"},freezeFirstColumn:{type:"Boolean"},freezeLastColumn:{type:"Boolean"},showExport:{type:"Boolean"},rowClickable:{type:"Boolean"},headers:{},pageSizes:{},pageSize:{},sort:{},service:{},getData:{},rows:{}},[],["removeRow","addRow","updateRow"],!1));}catch{};export{le as default};
