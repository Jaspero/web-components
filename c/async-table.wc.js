import{c as ge,S as pe,i as fe,f as B,s as be,a as he,e as h,b as H,d as f,m as N,g as z,h as k,o as L,n as $,j as v,k as ze,x as ve,l as S,t as R,p as P,q,r as xe,u as we,v as _,w as ke}from"./svelte.js";import"./index2.js";import{g as ye}from"./json-pointer.js";function $e(o){he(o,"svelte-4zgzc5",".table-card.svelte-4zgzc5{background-color:var(--background-primary);-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem;-webkit-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16);-moz-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16);box-shadow:0 3px 12px rgba(0, 0, 0, 0.16)}.table-container.svelte-4zgzc5{overflow-x:auto;width:100%}table.svelte-4zgzc5{width:100%}th.svelte-4zgzc5,td.svelte-4zgzc5{text-align:left;white-space:nowrap;font-size:0.75rem;font-weight:normal;padding:0.5rem;border-bottom:1px solid rgba(0, 0, 0, 0.16)}th.svelte-4zgzc5{opacity:0.75}.cell.svelte-4zgzc5{display:block;max-width:64ch;overflow:hidden;text-overflow:ellipsis}.table-actions.svelte-4zgzc5{padding:1rem}.table-header.svelte-4zgzc5{padding:1rem;min-height:68px;display:flex;justify-content:flex-end}.table-button.svelte-4zgzc5{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-border-radius:0.25rem;-moz-border-radius:0.25rem;border-radius:0.25rem;min-width:4rem;height:2.25rem;padding:0 1rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.settings-button.svelte-4zgzc5{background-color:var(--background-secondary);color:var(--text-on-secondary)}.load-button.svelte-4zgzc5{background-color:var(--primary-color);color:var(--text-on-primary)}.load-button.svelte-4zgzc5:disabled{opacity:0.5}.load-button.loading.svelte-4zgzc5{pointer-events:none}.spinner.svelte-4zgzc5{display:block;border-top:2px solid var(--text-on-primary);border-bottom:2px solid var(--text-on-primary);border-left:2px solid transparent;border-right:2px solid transparent;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;width:1rem;height:1rem;margin-right:0.5rem;-webkit-animation:svelte-4zgzc5-spin 1s linear infinite;-moz-animation:svelte-4zgzc5-spin 1s linear infinite;-o-animation:svelte-4zgzc5-spin 1s linear infinite;animation:svelte-4zgzc5-spin 1s linear infinite}@-webkit-keyframes svelte-4zgzc5-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes svelte-4zgzc5-spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes svelte-4zgzc5-spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes svelte-4zgzc5-spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}")}function G(o,e,n){const r=o.slice();return r[28]=e[n],r[30]=n,r}function J(o,e,n){const r=o.slice();return r[31]=e[n],r}function K(o,e,n){const r=o.slice();return r[31]=e[n],r[30]=n,r}function Q(o){let e,n,r=o[1]&&V(o),t=o[2]&&W(o);return{c(){e=h("div"),r&&r.c(),n=H(),t&&t.c(),f(e,"class","table-header svelte-4zgzc5")},m(a,s){z(a,e,s),r&&r.m(e,null),k(e,n),t&&t.m(e,null)},p(a,s){a[1]?r?r.p(a,s):(r=V(a),r.c(),r.m(e,n)):r&&(r.d(1),r=null),a[2]?t?t.p(a,s):(t=W(a),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},d(a){a&&v(e),r&&r.d(),t&&t.d()}}}function V(o){let e;function n(a,s){return a[8]?Ce:De}let r=n(o),t=r(o);return{c(){t.c(),e=S()},m(a,s){t.m(a,s),z(a,e,s)},p(a,s){r===(r=n(a))&&t?t.p(a,s):(t.d(1),t=r(a),t&&(t.c(),t.m(e.parentNode,e)))},d(a){a&&v(e),t.d(a)}}}function Ce(o){let e,n,r;return{c(){e=h("button"),e.textContent="Finish Arranging",f(e,"type","button"),f(e,"class","table-button settings-button svelte-4zgzc5")},m(t,a){z(t,e,a),n||(r=L(e,"click",o[15]),n=!0)},p:$,d(t){t&&v(e),n=!1,r()}}}function De(o){let e,n,r;return{c(){e=h("button"),e.textContent="Arrange Columns",f(e,"type","button"),f(e,"class","table-button settings-button svelte-4zgzc5")},m(t,a){z(t,e,a),n||(r=L(e,"click",o[14]),n=!0)},p:$,d(t){t&&v(e),n=!1,r()}}}function W(o){let e,n,r,t;return{c(){e=R(`\xA0
        `),n=h("button"),n.textContent="Export",f(n,"type","button"),f(n,"class","table-button settings-button svelte-4zgzc5"),N(n,"loading",o[6])},m(a,s){z(a,e,s),z(a,n,s),r||(t=L(n,"click",o[13]),r=!0)},p(a,s){s[0]&64&&N(n,"loading",a[6])},d(a){a&&(v(e),v(n)),r=!1,t()}}}function X(o){let e,n=P(o[7]),r=[];for(let t=0;t<n.length;t+=1)r[t]=Z(K(o,n,t));return{c(){e=h("tr");for(let t=0;t<r.length;t+=1)r[t].c()},m(t,a){z(t,e,a);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(e,null)},p(t,a){if(a[0]&459905){n=P(t[7]);let s;for(s=0;s<n.length;s+=1){const l=K(t,n,s);r[s]?r[s].p(l,a):(r[s]=Z(l),r[s].c(),r[s].m(e,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=n.length}},d(t){t&&v(e),q(r,t)}}}function Y(o){let e,n=o[0].direction==="asc"?"\u2191":"\u2193",r;return{c(){e=h("span"),r=R(n)},m(t,a){z(t,e,a),k(e,r)},p(t,a){a[0]&1&&n!==(n=t[0].direction==="asc"?"\u2191":"\u2193")&&we(r,n)},d(t){t&&v(e)}}}function Z(o){var e;let n,r,t=o[31].label+"",a,s,l,u;function x(...d){return o[22](o[31],...d)}let m=((e=o[0])==null?void 0:e.key)===o[31].key&&Y(o);function A(){return o[23](o[31])}return{c(){n=h("th"),r=h("span"),a=H(),m&&m.c(),s=H(),f(r,"draggable","true"),f(n,"data-index",o[30]),f(n,"class","svelte-4zgzc5"),N(n,"sortable",o[31].sortable)},m(d,c){z(d,n,c),k(n,r),r.innerHTML=t,k(n,a),m&&m.m(n,null),k(n,s),l||(u=[L(r,"dragstart",x),L(n,"click",A),L(n,"drop",o[18]),L(n,"dragover",o[17])],l=!0)},p(d,c){var p;o=d,c[0]&128&&t!==(t=o[31].label+"")&&(r.innerHTML=t),((p=o[0])==null?void 0:p.key)===o[31].key?m?m.p(o,c):(m=Y(o),m.c(),m.m(n,s)):m&&(m.d(1),m=null),c[0]&128&&N(n,"sortable",o[31].sortable)},d(d){d&&v(n),m&&m.d(),l=!1,xe(u)}}}function ee(o){let e,n=P(o[5]),r=[];for(let t=0;t<n.length;t+=1)r[t]=ne(G(o,n,t));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=S()},m(t,a){for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(t,a);z(t,e,a)},p(t,a){if(a[0]&4768){n=P(t[5]);let s;for(s=0;s<n.length;s+=1){const l=G(t,n,s);r[s]?r[s].p(l,a):(r[s]=ne(l),r[s].c(),r[s].m(e.parentNode,e))}for(;s<r.length;s+=1)r[s].d(1);r.length=n.length}},d(t){t&&v(e),q(r,t)}}}function Ae(o){return{c:$,m:$,p:$,d:$}}function Me(o){let e,n=o[34]+"";return{c(){e=h("span"),f(e,"class","cell svelte-4zgzc5")},m(r,t){z(r,e,t),e.innerHTML=n},p(r,t){t[0]&160&&n!==(n=r[34]+"")&&(e.innerHTML=n)},d(r){r&&v(e)}}}function je(o){return{c:$,m:$,p:$,d:$}}function te(o){let e,n,r,t,a={ctx:o,current:null,token:null,hasCatch:!1,pending:je,then:Me,catch:Ae,value:34};_(n=o[9](o[31],o[28],o[30]),a);function s(...l){return o[24](o[28],o[30],o[31],...l)}return{c(){e=h("td"),a.block.c(),f(e,"class","svelte-4zgzc5")},m(l,u){z(l,e,u),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=null,r||(t=L(e,"click",s),r=!0)},p(l,u){o=l,a.ctx=o,u[0]&160&&n!==(n=o[9](o[31],o[28],o[30]))&&_(n,a)||ke(a,o,u)},d(l){l&&v(e),a.block.d(),a.token=null,a=null,r=!1,t()}}}function ne(o){let e,n,r=P(o[7]),t=[];for(let a=0;a<r.length;a+=1)t[a]=te(J(o,r,a));return{c(){e=h("tr");for(let a=0;a<t.length;a+=1)t[a].c();n=H()},m(a,s){z(a,e,s);for(let l=0;l<t.length;l+=1)t[l]&&t[l].m(e,null);k(e,n)},p(a,s){if(s[0]&4768){r=P(a[7]);let l;for(l=0;l<r.length;l+=1){const u=J(a,r,l);t[l]?t[l].p(u,s):(t[l]=te(u),t[l].c(),t[l].m(e,n))}for(;l<t.length;l+=1)t[l].d(1);t.length=r.length}},d(a){a&&v(e),q(t,a)}}}function Ee(o){let e;return{c(){e=R("Load More")},m(n,r){z(n,e,r)},d(n){n&&v(e)}}}function Le(o){let e,n;return{c(){e=h("span"),n=R(`
        Loading`),f(e,"class","spinner svelte-4zgzc5")},m(r,t){z(r,e,t),z(r,n,t)},d(r){r&&(v(e),v(n))}}}function Te(o){let e,n,r,t,a,s,l,u,x,m,A,d=(o[1]||o[2])&&Q(o),c=o[7]&&X(o),p=o[5]&&ee(o);function E(g,M){return g[3]?Le:Ee}let O=E(o),C=O(o);return{c(){e=h("div"),d&&d.c(),n=H(),r=h("div"),t=h("table"),c&&c.c(),a=H(),p&&p.c(),s=H(),l=h("div"),u=h("button"),C.c(),f(t,"class","svelte-4zgzc5"),f(r,"class","table-container svelte-4zgzc5"),f(u,"class","table-button load-button svelte-4zgzc5"),u.disabled=x=!o[4],N(u,"loading",o[3]),f(l,"class","table-actions svelte-4zgzc5"),f(e,"class","table-card svelte-4zgzc5")},m(g,M){z(g,e,M),d&&d.m(e,null),k(e,n),k(e,r),k(r,t),c&&c.m(t,null),k(t,a),p&&p.m(t,null),k(e,s),k(e,l),k(l,u),C.m(u,null),m||(A=L(u,"click",o[11]),m=!0)},p(g,M){g[1]||g[2]?d?d.p(g,M):(d=Q(g),d.c(),d.m(e,n)):d&&(d.d(1),d=null),g[7]?c?c.p(g,M):(c=X(g),c.c(),c.m(t,a)):c&&(c.d(1),c=null),g[5]?p?p.p(g,M):(p=ee(g),p.c(),p.m(t,null)):p&&(p.d(1),p=null),O!==(O=E(g))&&(C.d(1),C=O(g),C&&(C.c(),C.m(u,null))),M[0]&16&&x!==(x=!g[4])&&(u.disabled=x),M[0]&8&&N(u,"loading",g[3])},i:$,o:$,d(g){g&&v(e),d&&d.d(),c&&c.d(),p&&p.d(),C.d(),m=!1,A()}}}function He(o,e,n){let{showArrangingColumns:r=!0}=e,{showExport:t=!0}=e,{headers:a=[]}=e,{sort:s}=e,{service:l}=e,{getData:u=async()=>{const i=await l.get(s);n(5,A=i.rows),n(4,m=i.hasMore),n(3,x=!1)}}=e,x=!0,m=!1,A=[],d=!1,c,p=!1,E=[];const O=ze();async function C(i,b,w){const{key:y,fallback:j,pipes:T}=i;let D;try{D=ye(b,y)}catch{return j||""}if(!T)return D;for(const U of T)D=await U(D,b,w);return D}async function g(i){const{sortable:b}=i;if(!b)return;n(3,x=!0),n(0,s={key:i.key,direction:s?.key===i.key&&s.direction==="asc"?"desc":"asc"});const w=await l.get(s);n(5,A=w.rows),n(4,m=w.hasMore),n(3,x=!1)}async function M(){n(3,x=!0);const i=await l.loadMore(s);n(5,A=[...A,...i.rows]),n(4,m=i.hasMore),n(3,x=!1)}function F(i,b,w,y){O("rowClick",{row:i,index:b,header:w,originalEvent:y})}async function oe(){n(6,d=!0);const i=await l.export(),b=await Promise.all(i.map(async(j,T)=>(await Promise.all(c.map(D=>C(D,j,T)))).map(D=>`"${D||""}"`).join(","))),w=new Blob([[c.map(j=>j.label).map(j=>`"${j}"`).join(","),...b].join(`
`)],{type:"text/csv"}),y=document.createElement("a");y.href=URL.createObjectURL(w),y.download="export.csv",y.click(),n(6,d=!1)}function ae(){n(8,p=!0),E=c.map(i=>i.key)}function se(){n(8,p=!1)}function I(i,b){i.dataTransfer.setData("text/plain",b.key)}function le(i){i.preventDefault()}function ie(i){var b;i.preventDefault();const w=i.dataTransfer.getData("text/plain"),y=E.indexOf(w),j=(b=i.target)==null?void 0:b.dataset.index;y!==-1&&j&&(E.splice(y,1),E.splice(Number(j),0,w),n(7,c=a.filter(T=>!T.disabled).sort((T,D)=>{const U=E.indexOf(T.key),me=E.indexOf(D.key);return U-me})))}ve(async()=>{await u()});const ce=(i,b)=>I(b,i),de=i=>g(i),ue=(i,b,w,y)=>F(i,b,w,y);return o.$$set=i=>{"showArrangingColumns"in i&&n(1,r=i.showArrangingColumns),"showExport"in i&&n(2,t=i.showExport),"headers"in i&&n(19,a=i.headers),"sort"in i&&n(0,s=i.sort),"service"in i&&n(20,l=i.service),"getData"in i&&n(21,u=i.getData)},o.$$.update=()=>{o.$$.dirty[0]&524288&&n(7,c=a.filter(i=>!i.disabled))},[s,r,t,x,m,A,d,c,p,C,g,M,F,oe,ae,se,I,le,ie,a,l,u,ce,de,ue]}class re extends pe{constructor(e){super(),fe(this,e,He,Te,be,{showArrangingColumns:1,showExport:2,headers:19,sort:0,service:20,getData:21},$e,[-1,-1])}get showArrangingColumns(){return this.$$.ctx[1]}set showArrangingColumns(e){this.$$set({showArrangingColumns:e}),B()}get showExport(){return this.$$.ctx[2]}set showExport(e){this.$$set({showExport:e}),B()}get headers(){return this.$$.ctx[19]}set headers(e){this.$$set({headers:e}),B()}get sort(){return this.$$.ctx[0]}set sort(e){this.$$set({sort:e}),B()}get service(){return this.$$.ctx[20]}set service(e){this.$$set({service:e}),B()}get getData(){return this.$$.ctx[21]}set getData(e){this.$$set({getData:e}),B()}}try{customElements.define("jp-async-table",ge(re,{showArrangingColumns:{type:"Boolean"},showExport:{type:"Boolean"},headers:{},sort:{},service:{},getData:{}},[],[],!1));}catch{};export{re as default};
